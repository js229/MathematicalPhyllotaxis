(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 14.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    204080,       3064]
NotebookOptionsPosition[    200638,       2997]
NotebookOutlinePosition[    201049,       3013]
CellTagsIndexPosition[    201006,       3010]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"repo", " ", "=", " ", 
   RowBox[{
   "PersistentSymbol", 
    "[", "\"\<persistentGitHubMathematicalPhyllotaxisRepo\>\"", "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"AppendTo", "[", 
    RowBox[{"$Path", ",", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{"repo", ",", "\"\<Mathematica\>\"", ",", "\"\<Packages\>\""}], 
       "}"}], "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "PacletManager`PacletInstall", 
    "[", "\"\<C:\\\\Users\\\\jonat\\\\Downloads\\\\GitLink-2018.07.20.01.\
paclet\>\"", "]"}], "\n", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"figureDirectory", " ", "=", " ", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{"repo", ",", "\"\<LaTeX\>\"", ",", "\"\<Figures\>\""}], "}"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"teXDirectory", " ", "=", "  ", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{"repo", ",", "\"\<LaTeX\>\""}], "}"}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9309128009761524`*^9, 3.9309128620030937`*^9}, 
   3.930913019235405*^9, 3.930913120870573*^9, {3.930913241475622*^9, 
   3.9309132424766693`*^9}, {3.9309186611628284`*^9, 3.9309187199815083`*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"a7dfdb43-ede7-0442-8bc0-f49d2e6f0815"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.9309132186271477`*^9, 3.9309132566180515`*^9}, {
   3.9309133505964375`*^9, 3.930913583753212*^9}, {3.9309136226347485`*^9, 
   3.9309137050060863`*^9}, {3.9309186438162823`*^9, 3.930918650060461*^9}, {
   3.9309190645885086`*^9, 3.9309192059639816`*^9}, {3.930919245508196*^9, 
   3.9309192512564697`*^9}, {3.930919359262308*^9, 3.930919361552887*^9}, 
   3.9384877656237526`*^9, {3.938488339015007*^9, 3.9384884120624733`*^9}, {
   3.9384884446901627`*^9, 3.93848851857041*^9}, {3.938488563454237*^9, 
   3.9384885763787384`*^9}, {3.938488622870865*^9, 3.9384886234678345`*^9}, {
   3.938488805657854*^9, 3.9384889606181774`*^9}, {3.9434347966381416`*^9, 
   3.943434802605152*^9}},
 CellLabel->"In[12]:=",ExpressionUUID->"5410ce48-bafc-4c4a-8d21-6a889068bb50"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Needs", "[", "\"\<GitLink`\>\"", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"gitProperties", "[", "repo_", "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"r", ",", "main", ",", "c", ",", "res"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"r", "=", 
       RowBox[{"GitOpen", "[", "repo", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"res", "=", " ", 
       RowBox[{"KeyTake", "[", 
        RowBox[{
         RowBox[{"GitProperties", "[", "r", "]"}], ",", 
         RowBox[{"{", "\"\<HeadBranch\>\"", "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"res", " ", "=", " ", 
       RowBox[{"Append", "[", 
        RowBox[{"res", ",", 
         RowBox[{"KeyTake", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"GitProperties", "[", "r", "]"}], "[", "\"\<Remotes\>\"",
              "]"}], "[", "\"\<origin\>\"", "]"}], ",", "\"\<FetchURL\>\""}], 
          "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"main", " ", "=", " ", 
       RowBox[{"GitProperties", "[", 
        RowBox[{"r", ",", "\"\<HeadBranch\>\""}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"ToGitObject", "[", 
        RowBox[{"r", ",", "main"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"res", "=", " ", 
       RowBox[{"Append", "[", 
        RowBox[{"res", ",", 
         RowBox[{"KeyTake", "[", 
          RowBox[{
           RowBox[{"GitProperties", "[", "c", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"\"\<Author\>\"", ",", "\"\<SHA\>\""}], "}"}]}], "]"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", "res"}]}], "\[IndentingNewLine]",
     "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9309132186271477`*^9, 3.9309132566180515`*^9}, {
   3.9309133505964375`*^9, 3.930913583753212*^9}, {3.9309136226347485`*^9, 
   3.9309137050060863`*^9}, {3.9309186438162823`*^9, 3.930918650060461*^9}, {
   3.9309190645885086`*^9, 3.9309192059639816`*^9}, {3.930919245508196*^9, 
   3.9309192512564697`*^9}, {3.930919359262308*^9, 3.930919361552887*^9}, 
   3.9384877656237526`*^9, {3.938488339015007*^9, 3.9384884120624733`*^9}, {
   3.9384884446901627`*^9, 3.93848851857041*^9}, {3.938488563454237*^9, 
   3.9384885763787384`*^9}, {3.938488622870865*^9, 3.9384886234678345`*^9}, {
   3.938488805657854*^9, 3.9384889606181774`*^9}, {3.9434347966381416`*^9, 
   3.943434805526352*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"ea6b1b0e-09ce-9440-b08f-6c66a5cd9a09"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"writeGitProperties", "[", 
    RowBox[{"repo_", ",", "file_"}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"repoProperties", " ", "=", " ", 
       RowBox[{"gitProperties", "[", "repo", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"repoTeXString", "=", " ", 
       RowBox[{
        RowBox[{
        "StringTemplate", 
         "[", "\"\<\n% Generated from `ThisFile`\n\
\\\\newcommand{\\\\jGithubMathematicalPhyllotaxisRepoSHA}{`SHA`}\n\
\\\\newcommand{\\\\jGithubMathematicalPhyllotaxisRepoTimeStamp}{`TimeStamp`}\n\
\\\\newcommand{\\\\jGithubMathematicalPhyllotaxisRepoBranch}{`HeadBranch`}\>\"\
", "]"}], "[", "\[IndentingNewLine]", 
        RowBox[{"Append", "[", 
         RowBox[{"repoProperties", ",", 
          RowBox[{"Append", "[", 
           RowBox[{
            RowBox[{"repoProperties", "[", "\"\<Author\>\"", "]"}], ",", 
            RowBox[{"\"\<ThisFile\>\"", "->", 
             RowBox[{"NotebookFileName", "[", "]"}]}]}], "]"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"SetDirectory", "[", "teXDirectory", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{"file", ",", "repoTeXString", ",", "\"\<Text\>\""}], "]"}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{
       "repoTeXString", ",", " ", "\"\<\\n\\n written to \>\"", ",", "file"}],
        "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"ResetDirectory", "[", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9309132186271477`*^9, 3.9309132566180515`*^9}, {
   3.9309133505964375`*^9, 3.930913583753212*^9}, {3.9309136226347485`*^9, 
   3.9309137050060863`*^9}, {3.9309186438162823`*^9, 3.930918650060461*^9}, {
   3.9309190645885086`*^9, 3.9309192059639816`*^9}, {3.930919245508196*^9, 
   3.9309192512564697`*^9}, {3.930919359262308*^9, 3.930919361552887*^9}, 
   3.9384877656237526`*^9, {3.9434336343780746`*^9, 3.943433772198984*^9}, {
   3.943433812840372*^9, 3.9434338853129845`*^9}, {3.9434340587513657`*^9, 
   3.94343410720084*^9}, {3.943434523206253*^9, 3.943434666031477*^9}, {
   3.9434346975992146`*^9, 3.9434346981019*^9}, 3.9434347539911747`*^9, 
   3.943434812121172*^9, {3.943434990504793*^9, 3.943434995454714*^9}},
 CellLabel->"In[15]:=",ExpressionUUID->"15d23f4c-0e35-d44a-8b0e-305e897a350d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"writeGitProperties", "[", 
   RowBox[{
   "repo", ",", "\"\<GithubMathematicalPhyllotaxisRepoProperties.tex\>\""}], 
   "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.9309132186271477`*^9, 3.9309132566180515`*^9}, {
   3.9309133505964375`*^9, 3.930913583753212*^9}, {3.9309136226347485`*^9, 
   3.9309137050060863`*^9}, {3.9309186438162823`*^9, 3.930918650060461*^9}, {
   3.9309190645885086`*^9, 3.9309192059639816`*^9}, {3.930919245508196*^9, 
   3.9309192512564697`*^9}, {3.930919359262308*^9, 3.930919361552887*^9}, 
   3.9384877656237526`*^9, {3.9434336343780746`*^9, 3.943433772198984*^9}, {
   3.943433812840372*^9, 3.9434338853129845`*^9}, {3.9434340587513657`*^9, 
   3.94343410720084*^9}, {3.943434523206253*^9, 3.943434666031477*^9}, {
   3.9434346975992146`*^9, 3.9434346981019*^9}, 3.9434347539911747`*^9, 
   3.943434812121172*^9},
 CellLabel->"In[16]:=",ExpressionUUID->"b75608cc-9ea6-a144-86b7-9998912bf55c"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\n% Generated from \
C:\\\\Users\\\\jonat\\\\Documents\\\\GitHub\\\\MathematicalPhyllotaxis\\\\\
Mathematica\\\\Packages\\\\runScripts.nb\\n\\\\newcommand{\\\\\
jGithubMathematicalPhyllotaxisRepoSHA}{\
c9e530331c2d40fc25ac03d1a07fd38c8965a532}\\n\\\\newcommand{\\\\\
jGithubMathematicalPhyllotaxisRepoTimeStamp}{Tue 11 Feb 2025 \
16:33:30}\\n\\\\newcommand{\\\\jGithubMathematicalPhyllotaxisRepoBranch}{main}\
\"\>", "\[InvisibleSpace]", "\<\"\\n\\n written to \"\>", 
   "\[InvisibleSpace]", \
"\<\"GithubMathematicalPhyllotaxisRepoProperties.tex\"\>"}],
  SequenceForm[
  "\n% Generated from \
C:\\Users\\jonat\\Documents\\GitHub\\MathematicalPhyllotaxis\\Mathematica\\\
Packages\\runScripts.nb\n\
\\newcommand{\\jGithubMathematicalPhyllotaxisRepoSHA}{\
c9e530331c2d40fc25ac03d1a07fd38c8965a532}\n\
\\newcommand{\\jGithubMathematicalPhyllotaxisRepoTimeStamp}{Tue 11 Feb 2025 \
16:33:30}\n\\newcommand{\\jGithubMathematicalPhyllotaxisRepoBranch}{main}", 
   "\n\n written to ", "GithubMathematicalPhyllotaxisRepoProperties.tex"],
  Editable->False]], "Print",
 CellLabel->
  "During evaluation of \
In[16]:=",ExpressionUUID->"ef973a9c-1f3b-4a4b-9daf-aff1087992ab"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["repo"], "Input",
 CellLabel->"In[19]:=",ExpressionUUID->"137aa27c-e0dd-3340-87e0-c09fdd2ce500"],

Cell[BoxData["\<\"C:\\\\Users\\\\jonat\\\\Documents\\\\GitHub\\\\\
MathematicalPhyllotaxis\"\>"], "Output",
 CellLabel->"Out[19]=",ExpressionUUID->"c19fa74a-3cbb-414f-903f-f54809d769f4"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"questionFiles", " ", "=", " ", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{"repo", ",", "\"\<LaTeX\>\"", ",", "#"}], "}"}], "]"}], 
       "&"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{"\"\<Motivation.tex\>\"", ",", 
        "\[IndentingNewLine]", "\"\<Background.tex\>\"", ",", 
        "\[IndentingNewLine]", "\"\<Coprimality.tex\>\"", ",", 
        "\[IndentingNewLine]", "\"\<Geometry.tex\>\"", ",", 
        "\[IndentingNewLine]", "\"\<Classifying.tex\>\"", ",", 
        "\[IndentingNewLine]", "\"\<Transformed.tex\>\"", ",", 
        "\[IndentingNewLine]", "\"\<Developmental.tex\>\"", ",", 
        "\[IndentingNewLine]", "\"\<Empirical.tex\>\"", ",", 
        "\[IndentingNewLine]", "\"\<Placement.tex\>\"", ",", 
        "\[IndentingNewLine]", "\"\<StackedDisksChapter.tex\>\""}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellLabel->
  "In[125]:=",ExpressionUUID->"9c117197-2bc4-3048-a8be-0f66a2cf3cb0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"start", "=", "\"\<\\\\begin{jAnswer}\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"end", " ", "=", " ", "\"\<\\\\end{jAnswer}\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"doFile", "[", "file_", "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"string", " ", "=", " ", 
       RowBox[{"Import", "[", 
        RowBox[{"file", ",", "\"\<String\>\""}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"string", "=", 
       RowBox[{"StringReplace", "[", 
        RowBox[{"string", ",", 
         RowBox[{"\"\<\\r\>\"", "->", "\"\<\>\""}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"startPositions", " ", "=", " ", 
       RowBox[{"StringPosition", "[", 
        RowBox[{"string", ",", 
         RowBox[{"Shortest", "[", 
          RowBox[{"start", " ", "~~", " ", "__", " ", "~~", " ", "end"}], 
          "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"answers", " ", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"StringTake", "[", 
           RowBox[{"string", ",", "#"}], "]"}], "&"}], ",", 
         "startPositions"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"answers", " ", "=", " ", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"StringReplace", "[", 
           RowBox[{"#", ",", 
            RowBox[{"{", 
             RowBox[{
              
              RowBox[{"\"\<\\\\begin{jAnswer}\>\"", 
               "->", "\"\<\\\\begin{sol}\>\""}], ",", 
              
              RowBox[{"\"\<\\\\end{jAnswer}\>\"", 
               "->", "\"\<\\\\end{sol}\>\""}]}], "}"}]}], "]"}], "&"}], ",", 
         "answers"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"answers", "=", 
       RowBox[{"StringRiffle", "[", 
        RowBox[{"answers", ",", "\"\<\\n\\n\>\""}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"answers", "=", " ", 
       RowBox[{"\"\<\\n%%%% \>\"", " ", "<>", " ", 
        RowBox[{"Last", "@", 
         RowBox[{"FileNameSplit", "[", "file", "]"}]}], " ", "<>", 
        " ", "\"\<\\n\\n\>\"", " ", "<>", " ", "answers"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->
  True,ExpressionUUID->"acac33ec-85cd-6044-b5d5-ee6ce418cc9b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"answersPreamble", "=", 
  " ", "\"\<\\\\chapter{Answers to exercises}\\n\\n\>\""}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"42c6e748-0de8-0446-9fbc-c984096b48ea"],

Cell[BoxData["\<\"\\\\Chapter{Answers to exercises}\"\>"], "Output",
 CellLabel->
  "Out[130]=",ExpressionUUID->"7b7c46bd-ed7b-b942-a4c0-a48640c5af75"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"generateAnswers", "[", "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"answerString", "=", " ", 
        RowBox[{"StringJoin", "@", 
         RowBox[{"Map", "[", 
          RowBox[{"doFile", ",", "questionFiles"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"answerString", " ", "=", " ", 
        RowBox[{"answersPreamble", " ", "<>", " ", "answerString"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"fileName", "=", 
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"teXDirectory", ",", "\"\<Answers.tex\>\""}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Export", "[", 
        RowBox[{"fileName", ",", "answerString", ",", "\"\<Text\>\""}], "]"}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", " ", 
        RowBox[{"\"\<answers written to \>\"", ",", "fileName"}], "]"}], 
       ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}]], "Input",
 InitializationCell->True,
 CellLabel->
  "In[131]:=",ExpressionUUID->"68f8f740-baa8-2c46-8d4b-2433493e1e21"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"generateAnswers", "[", "]"}]], "Input",
 CellLabel->
  "In[132]:=",ExpressionUUID->"d9e32fa4-4847-d346-aed7-b9345534aafe"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"answers written to \"\>", 
   "\[InvisibleSpace]", \
"\<\"C:\\\\Users\\\\jonat\\\\Documents\\\\GitHub\\\\MathematicalPhyllotaxis\\\
\\LaTeX\\\\Answers.tex\"\>"}],
  SequenceForm[
  "answers written to ", 
   "C:\\Users\\jonat\\Documents\\GitHub\\MathematicalPhyllotaxis\\LaTeX\\\
Answers.tex"],
  Editable->False]], "Print",
 CellLabel->
  "During evaluation of \
In[132]:=",ExpressionUUID->"94c3d89f-11c9-7c44-8d72-84dec75261d0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ToCharacterCode", "[", "\"\<\\r\>\"", "]"}]], "Input",
 CellLabel->
  "In[107]:=",ExpressionUUID->"14ec110f-cc59-454c-87ba-72ceb998df67"],

Cell[BoxData[
 RowBox[{"{", "13", "}"}]], "Output",
 CellLabel->
  "Out[107]=",ExpressionUUID->"95fcba41-7459-0045-8f19-acc2da22c86d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FromCharacterCode", "[", "13", "]"}]], "Input",
 CellLabel->
  "In[106]:=",ExpressionUUID->"c36aa74d-d80b-4e4b-9b15-0c01ec13e031"],

Cell[BoxData["\<\"\\r\"\>"], "Output",
 CellLabel->
  "Out[106]=",ExpressionUUID->"75daf077-863b-6b46-945d-6c5a3a2986d2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ToCharacterCode", "[", 
  RowBox[{"StringReplace", "[", 
   RowBox[{
    RowBox[{"StringTake", "[", 
     RowBox[{"string", ",", 
      RowBox[{"startPositions", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], "]"}], " ", ",", 
    RowBox[{"\"\<\\n\>\"", "->", "\"\<XX\>\""}]}], "]"}], "]"}]], "Input",
 CellLabel->
  "In[104]:=",ExpressionUUID->"4014a559-765a-624c-b5ef-c33d8f50b955"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "92", ",", "98", ",", "101", ",", "103", ",", "105", ",", "110", ",", "123",
    ",", "106", ",", "65", ",", "110", ",", "115", ",", "119", ",", "101", ",",
    "114", ",", "125", ",", "123", ",", "101", ",", "120", ",", "58", ",", 
   "112", ",", "104", ",", "111", ",", "114", ",", "105", ",", "122", ",", 
   "125", ",", "13", ",", "88", ",", "88", ",", "9", ",", "73", ",", "102", ",",
    "32", ",", "36", ",", "92", ",", "112", ",", "118", ",", "101", ",", "99",
    ",", "123", ",", "107", ",", "125", ",", "61", ",", "40", ",", "120", ",",
    "44", ",", "122", ",", "41", ",", "36", ",", "44", ",", "32", ",", "116", 
   ",", "104", ",", "101", ",", "110", ",", "32", ",", "36", ",", "124", ",", 
   "120", ",", "124", ",", "92", ",", "108", ",", "101", ",", "113", ",", 
   "92", ",", "106", ",", "104", ",", "97", ",", "108", ",", "102", ",", "36",
    ",", "32", ",", "100", ",", "105", ",", "114", ",", "101", ",", "99", ",",
    "116", ",", "32", ",", "102", ",", "114", ",", "111", ",", "109", ",", 
   "32", ",", "116", ",", "104", ",", "101", ",", "32", ",", "100", ",", 
   "101", ",", "102", ",", "105", ",", "110", ",", "105", ",", "116", ",", 
   "105", ",", "111", ",", "110", ",", "32", ",", "111", ",", "102", ",", 
   "32", ",", "97", ",", "32", ",", "112", ",", "97", ",", "114", ",", "97", ",",
    "115", ",", "116", ",", "105", ",", "99", ",", "104", ",", "121", ",", 
   "32", ",", "118", ",", "101", ",", "99", ",", "116", ",", "111", ",", 
   "114", ",", "46", ",", "13", ",", "88", ",", "88", ",", "9", ",", "73", ",",
    "102", ",", "32", ",", "36", ",", "120", ",", "62", ",", "48", ",", "36", 
   ",", "44", ",", "32", ",", "116", ",", "104", ",", "101", ",", "110", ",", 
   "32", ",", "36", ",", "92", ",", "112", ",", "104", ",", "97", ",", "116", 
   ",", "118", ",", "101", ",", "99", ",", "123", ",", "107", ",", "125", ",",
    "61", ",", "92", ",", "112", ",", "118", ",", "101", ",", "99", ",", 
   "123", ",", "107", ",", "125", ",", "45", ",", "32", ",", "92", ",", "112",
    ",", "118", ",", "101", ",", "99", ",", "123", ",", "48", ",", "125", ",",
    "36", ",", "32", ",", "119", ",", "105", ",", "116", ",", "104", ",", 
   "32", ",", "13", ",", "88", ",", "88", ",", "9", ",", "104", ",", "111", ",",
    "114", ",", "105", ",", "122", ",", "111", ",", "110", ",", "116", ",", 
   "97", ",", "108", ",", "32", ",", "99", ",", "111", ",", "109", ",", "112",
    ",", "111", ",", "110", ",", "101", ",", "110", ",", "116", ",", "32", ",",
    "36", ",", "120", ",", "45", ",", "49", ",", "36", ",", "32", ",", "119", 
   ",", "104", ",", "105", ",", "99", ",", "104", ",", "32", ",", "105", ",", 
   "115", ",", "32", ",", "98", ",", "101", ",", "116", ",", "119", ",", 
   "101", ",", "101", ",", "110", ",", "32", ",", "36", ",", "45", ",", "49", 
   ",", "36", ",", "32", ",", "97", ",", "110", ",", "100", ",", "32", ",", 
   "36", ",", "45", ",", "92", ",", "106", ",", "104", ",", "97", ",", "108", 
   ",", "102", ",", "36", ",", "44", ",", "32", ",", "97", ",", "110", ",", 
   "100", ",", "32", ",", "115", ",", "105", ",", "109", ",", "105", ",", 
   "108", ",", "97", ",", "114", ",", "108", ",", "121", ",", "32", ",", 
   "102", ",", "111", ",", "114", ",", "32", ",", "36", ",", "120", ",", "60",
    ",", "48", ",", "36", ",", "46", ",", "32", ",", "13", ",", "88", ",", 
   "88", ",", "9", ",", "65", ",", "100", ",", "100", ",", "105", ",", "110", 
   ",", "103", ",", "32", ",", "36", ",", "120", ",", "36", ",", "32", ",", 
   "99", ",", "111", ",", "109", ",", "112", ",", "111", ",", "110", ",", 
   "101", ",", "110", ",", "116", ",", "115", ",", "32", ",", "103", ",", 
   "105", ",", "118", ",", "101", ",", "115", ",", "32", ",", "116", ",", 
   "104", ",", "101", ",", "32", ",", "102", ",", "105", ",", "110", ",", 
   "97", ",", "108", ",", "32", ",", "115", ",", "101", ",", "110", ",", 
   "116", ",", "101", ",", "110", ",", "99", ",", "101", ",", "46", ",", "32",
    ",", "13", ",", "88", ",", "88", ",", "92", ",", "101", ",", "110", ",", 
   "100", ",", "123", ",", "106", ",", "65", ",", "110", ",", "115", ",", 
   "119", ",", "101", ",", "114", ",", "125"}], "}"}]], "Output",
 CellLabel->
  "Out[104]=",ExpressionUUID->"52da23db-de25-ed4b-a1e0-aa3bd4242203"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ToCharacterCode", "[", "\"\<\\n\>\"", "]"}]], "Input",
 CellLabel->
  "In[103]:=",ExpressionUUID->"21d06605-d2d0-8346-a198-01f18e508201"],

Cell[BoxData[
 RowBox[{"{", "10", "}"}]], "Output",
 CellLabel->
  "Out[103]=",ExpressionUUID->"d4df949f-55b2-8040-8744-40631a2bce76"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"StringReplace", "[", 
  RowBox[{"string", ",", 
   RowBox[{"\"\<\\n\>\"", "->", "\"\<XX\>\""}]}], "]"}]], "Input",
 CellLabel->"In[93]:=",ExpressionUUID->"2d9f3ce1-0e86-0441-bd2a-127c57e48d65"],

Cell[BoxData["\<\"\\rXX\\rXX\\\\chapter{The geometry of cylindrical lattices}\
\\rXX\\\\label{ch:cylinder}\\rXX\\\\abstract{\\rXXThe goal of this chapter is \
to characterise the shortest vectors in a cylindrical lattice. This will \
allow us, in the next Chapter, to classify lattices by their shortest vectors \
in a way that has biological relevance. Cylindrical lattices have a natural \
representation as `unrolled' plane lattices in which the cylinder \
circumference corresponds to a  vector of the plane lattice encoding the \
periodicity; the height of a point in the cylindrical lattice is the \
component perpendicular to the periodicity vector. Any vector in the lattice \
has a parastichy number corresponding to the size of this component in units \
of node height. \\rXXThe principal parastichy\\\\index{parastichy}{} vectors \
are the two shortest vectors in the plane lattice. We show how the the \
cylindrical spirals formed by these vectors -- and the two corresponding \
parastichy\\\\index{parastichy}{} numbers --  provide a natural model for  \
biological observations of spiral counts. In order to compute these \
parastichy numbers in a given lattice we will consider generating pairs of \
vectors as the building blocks of the lattice, and carry out the main \
analysis of this chapter: how to deduce from the generating pairs what the \
lattice parameters are and, especially, what the shortest vectors in the \
lattice are. The central and suggestive result of this Chapter is Turing's \
theorem: that the third-shortest vector in a lattice has a parastichy number \
which is the sum or difference of th\\rXX}\\rXX\\rXX\\\\section{Botanical \
lattices}\\rXXBefore we study lattices, it is worth exploring their \
biological relevance for phyllotaxis. Leaf arrangements have long been the \
subject of botanical study. Figure~\\\\ref{fig:Txb0401LeafTypes} shows a \
typical, and typically idealised, classification. We will call the number of \
leaves $J$ at each stem height where they occur the \\\\textit{jugacy}. The \
first and second patterns are our primary interest in this chapter: they are \
\\\\textit{monojugate} with a fixed angle between each leaf; in the special \
case of the alternate distichous arrangement the angle is \
180\\\\degree.\\rXXBy contrast the last three patterns in \
Figure~\\\\ref{fig:Txb0401LeafTypes} are multijugate; the case when $J>2$ is \
botanically called a \\\\textit{whorled} phyllotaxis.\\rXX  \
\\rXX\\\\mmafig{Txb0401LeafTypes}{Five different types of leaf arrangements \
on stems, with  jugacy $J$, a classification by principal parastichy numbers \
which will be developed in this chapter, and a reprsentation as a lattice on \
a cylinder, with a point at one height joined to the two nearest points at \
the next height.}{1}\\rXX\\rXXThese patterns can be idealised into a family \
of points on a cylinder, each rotated by a fixed fraction of the circle or \\\
\\emph{divergence} $d$ from the next and shifted vertically by the \
\\\\emph{rise}. \\rXXIn the spiral example, the third leaf is roughly \
vertically above the first one, and the fifth leaf even more so. \\rXXIf \
there was always a $p$-th leaf directly above the first, after having gone \
round the stem $q$ times, then all divergences would be rational fractions \
$p/q$  and this would provide a system of classification of leaf patterns. At \
its simplest this would come from identifying which is the leaf `directly' \
above the first (defining a vertical line called the \\\\emph{orthostichy}), \
but this is in many cases impractical or \\rXXprone to disagreement. An \
alternative would be to estimate the divergence, which has the attraction \
that it can be estimated locally from nearby leaf positions and can be \
averaged over many observations, and \\rXXthen approximating it by a rational \
fraction. Of course one divergence can be approximated by many different \
rational fractions so the choice of approximation is another potential source \
of dispute.\\rXXNevertheless, this classification method is a natural one \
which works well for small denominators,  when the orthostichy leaf is not \
too far away, and was in successful and widespread throughout the nineteenth \
century and beyond. But as well as its conceptual shortcomings, it becomes \
practically inadequate for more complex patterns. Accordingly we will turn to \
a more modern idea of characterising lattice patterns by their \
parastichies.\\rXX\\\\jpgfig{F0402BravaisFig2}{Bravais and Bravais's 1837 \
idealisation of the pine cone as a lattice on a \
cylinder~\\\\cite[p79]{bravaisEssaiDispositionFeuilles1837}. \
\\rXX\\t}{1}\\rXX\\\\todo{Expand bravais section}\\rXX\\rXXThese leaf-on-stem \
examples are naturally modelled in cylindrical coordinates on a vertical \
cylinder of fixed radius, but other examples, notably the arrangement of \
seeds on the sunflower head, suggest models which take place in polar \
coordinates on a disk. There are simple mathematical maps between the two \
geometries, and we will see later that these maps do correspond to an \
underlying biological similarity.% Chapter~\\\\ref{ch:transformations} gives \
more details of these mathematical mappings.  \
\\rXX\\rXX\\rXX\\rXX\\\\section{Cylindrical and plane \
lattices}\\\\label{sec:latticedef}\\rXXCylindrical lattices can be thought of \
as lattices in the plane with a particular distinguished vector corresponding \
to the cylindrical periodicity,  and in this plane all the normal rules of \
vector arithmetic hold. \\rXXTable~\\\\ref{tab:notation} summarises the \
notation used in this \
Chapter.\\rXX%\\rXX\\\\begin{table}\\rXX\\t\\t\\\\caption{Notation used in \
this Chapter.}\\rXX\\t\\t\\t\\\\label{tab:notation}\\\\begin{tabularx}{\\\\\
textwidth}{l|X}\\rXX\\t\\t\\t\\\\hline\\rXX\\t\\t$[x]$ & The nearest integer \
to $x$. \\rXX\\t\\t\\\\\\\\\\rXX\\t\\t\\t$l_k$ & The $k$-th lattice point, \
with coordinates $(dk - [dk],kh)$. \
\\rXX\\t\\t\\t\\t\\\\\\\\\\rXX\\t\\t\\t\\t$(x,z)$ & Real coordinates in a \
vertical cylinder $[0,1]\\\\times\\\\jR$ or the plane $\\\\jR^2$, or more \
often a vector in $\\\\jR^2$ relative to an origin $(0,0)$. (Warning: at the \
end of Chapter~\\\\ref{ch:classifying} we use a different $z=d+ih$ with \
$z\\\\in\\\\jC$.)\\rXX\\t\\t\\t\\t\\\\\\\\\\rXX\\t\\t\\t\\t$\\\\pvec{}$, \
$\\\\fvec$, $\\\\svec$ \\\\ldots & Vectors with form \
$(x,z)$..\\rXX\\t\\t\\t\\t\\\\\\\\\\rXX\\t\\t\\t\\t$\\\\pvec{0}$ & The vector \
$(1,0)$. We call this the \\\\textit{periodicity} \
vector.\\\\index{periodicity \
vector}\\rXX\\t\\t\\t\\t\\\\\\\\\\rXX\\t\\t\\t\\t$\\\\pvec{1}$ & The vector \
$(d,h)$, usually with $0< d\\\\leq \\\\jhalf$ and $h>0$. This is the \
\\\\textit{generating} vector.\\\\index{generating vector} \
\\rXX\\t\\t\\\\\\\\\\rXX\\t\\t\\t\\t$\\\\mathcal{L}(d,h)$ & The lattice on \
the cylinder generated by the vectors $\\\\pvec{0}$ and $\\\\pvec{1}$:\\tthe \
set $a\\\\pvec{0}+b\\\\pvec{1}$ for $a,b\\\\in \\\\jZ$, after identifying \
points differing by an integer in $x$. \
\\rXX\\t\\t\\t\\t\\\\\\\\\\rXX\\t\\t\\t\\t$\\\\pvec{k}$ & The $k$-th \
parastichy\\\\index{parastichy vector} vector: the vector from $(0,0)$ to \
$(dk-[dk],kh)$.\\rXX\\t\\t\\t\\t\\\\\\\\\\rXX\\t\\t\\t\\t$\\\\phatvec{k}$ & \
The $k$-th complementary vector: the shorter of \
$\\\\pvec{k}\\\\pm\\\\pvec{0}$.\\\\index{complementary \
vector}\\rXX\\t\\t\\t\\t\\\\\\\\\\rXX\\t\\t\\t\\t$\\\\gp{m,n}$ pair & The \
principal vectors\\\\index{principal vector pair} of the lattice: the \
linearly independent pair $\\t\\\\pvec{m}$ and $\\\\pvec{n}$ (or \
$\\\\phatvec{n}$)  which are shortest in the lattice). More \
generally:\\rXX\\t\\t\\t\\t\\\\\\\\\\rXX\\t\\t\\t\\t$\\\\gp{r,s}$ pair & A \
generating pair: any pair of vectors that also generate \
$\\\\mathcal{L}(d,h)$.\\\\index{generating \
pair}\\rXX\\t\\t\\t\\t\\\\\\\\\\rXX\\t\\t\\t\\t$\\\\pp{m,n}$ lattice & A \
lattice in which the principal pair \\rXX\\t\\t\\t\\tare \
$\\\\gp{m,n}$.\\rXX\\t\\t\\t\\t\\\\\\\\\\rXX\\t\\t\\t\\t$m$, $n$, $u$, $v$ & \
Integers satisfying $m v- n u=\\\\Delta$ and $\\\\Delta=\\\\pm 1$.\\\\index{B\
\\\\'ezout relation}\\rXX\\t\\t\\t\\t\\\\\\\\\\\\hline\\rXX\\\\end{tabularx} \
\\rXX\\\\end{table}\\rXX%\\rXXWe use surface coordinates $(x,z)$ on a \
cylinder, of fixed circumference 1, that extends infinitely in the vertical \
direction $z$.  At the origin we place a point of the lattice. By rotating an \
angle $2\\\\pi d$ around the cylinder from the origin and rising by \
$z=h$\\rXXwe place a second point. Repetitions of this translation will \
define the whole lattice,  and we will call  \\rXX$h$ the {rise} and $d$ the \
divergence. \\rXX\\rXX\\rXX\\\\mmafig{Txb0403Coordinates}{\\rXXEquivalent \
parameterisations of the same periodic planar lattice with divergence $d$ and \
rise $h$, here $d=4/10$, $h=1/10$.  In this case the cylindrical lattice \
point labelled 3 has co-ordinates $(3d-1,3h) =(3d - [3d],3h)$. In (c), some \
parastichy vectors are shown and  $\\\\pvec{3}=3\\\\pvec{1}-\\\\pvec{0}$: the \
vector $\\\\pvec{0}$ encodes the periodicity of the lattice.  In (c), the \
double diagonal lines mark the periodic boundary $x=\\\\pm\\\\jhalf$ of the \
cylindrical lattice. Elsewhere in this book the pale green rectangle alone, \
of width 1,  is used as a convention to indicate this periodicity of the \
cylinder. \
\\rXX}{1.0}\\rXX\\rXX\\\\newcommand{\\\\dk}{x_k}\\\\newcommand{\\\\dm}{x_m}\\\
\\newcommand{\\\\dn}{x_n}\\\\newcommand{\\\\dmn}{x_{m+n}}\\rXXSpecifically, \
the lattice  $\\\\mathcal{L}(d,h)$ is the set of points  $\\\\jpoint{k}$ with \
coordinates  $(x,z)=(\\\\dk,kh)$ where $k$\\rXXis any integer, \
$\\\\dk=kd-[kd]$ and $[x]$ is the nearest integer to $x$, with ties chosen so \
that $-\\\\jhalf < \\\\dk \\\\leq \\\\jhalf$.%\\rXX\\\\jNote{There is a \
temptation to take the range of $x$ as $[0,1]$ instead of \
$[-\\\\jhalf,\\\\jhalf]$. Nothing bad happens if we do; the choice here is \
partly historical, when a large part was played by spirals winding in \
opposite directions, and following this convention means opposing spirals \
will have positive and negative $x$ components.}\\rXXSee \
Figure~\\\\ref{fig:Txb0403Coordinates}. \\rXXCo-ordinates of lattice points \
are in the cylinder strip $C=(-\\\\jhalf,\\\\jhalf]\\\\times\\\\jR$, and \
there is a natural \\rXX{planar lattice}  which is the unrolled set of points \
$\\\\mathcal{L}+w (1,0)$ over all integers $w$. \\rXXThere is a simple map \
from the plane back to the cylinder: $(x,z)\\\\rightarrow(x-w,z)$ where \
$w=[x]$ is the \\\\emph{winding number} of the vector $(x,z)$. This maps all \
the plane lattice points of rise $kh$ onto the unique cylindrical lattice \
point $\\\\jpoint{k}$ of rise $kh$. \\rXX\\rXXMore generally, planar lattices \
are generated from pairs of vectors $\\\\mathbf{a}$ and $\\\\mathbf{b}$ as \
the set of all possible integer sums  $u \\\\mathbf{a}+ v\\\\mathbf{b}$. It \
will often happen that two different generating pairs generate the same given \
lattice. A planar lattice is $1$-periodic if it has the vector $(1,0)$ as a \
member, and then it has a corresponding cylindrical lattice which is the \
subset of points with the divergence $x$ in $[\\\\jhalf,\\\\jhalf]$.  \
\\rXX\\rXX\\\\subsection{Labelling cylindrical vectors}\\rXXEach point of the \
plane lattice corresponds to a \\rXXvector in $\\\\jR^2$ with the normal \
rules of vector arithmetic. But although the map of planar-lattice points to \
cylindrical-lattice points is many-to-one, the map of planar vectors to \
cylindrical vectors is one-to-one, because each pair of points on the \
cylinder will be joined by a family of vectors, each winding a different \
number of times around the cylinder, and with co-ordinate components equal to \
components of the corresponding plane vector.   Thus we can do our normal \
vector arithmetic on the cylinder, although we will  be careful about how we \
label vectors. \\rXX\\rXXFirst we distinguish one special vector \
$\\\\pvec{0}=(1,0)$ which encodes the periodicity of the lattice. After that, \
we note that the shortest of all the vectors on the cylinder from the origin \
to $\\\\jpoint{k}$ is the shortest of the set of vectors from the origin to \
any of the points in the planar lattice with rise $kh$; it must be one of the \
two vectors to the point $\\\\jpoint{k}$ with winding number zero. \\rXXWe \
name this shortest of the vectors from the origin to $\\\\jpoint{k}$ as  the \
\\\\textit{parastichy vector} $\\\\pvec{k}$.\\rXX\\rXXSometimes adding two \
parastichy vectors takes the sum outside of the cylinder and then the sum is \
not a parastichy vector. For the most part we only need to be concerned with \
parastichy vectors, but for some (mathematically if not biologically)  \
significant special cases,  there is a role for the \\\\textit{second} \
shortest vector to the point $\\\\jpoint{k}$. We call this the \
\\\\emph{complementary vector} $\\\\phatvec{k}$ \
(Figure~\\\\ref{fig:Txb0404Complementary}). The complementary vector is the \
shorter of $\\\\pvec{k}\\\\pm \\\\pvec{0}$. There is a  special case when $d=\
\\\\jhalf$, so that the vectors $(\\\\jhalf,h)$ and $(-\\\\jhalf,h)$ are \
equal-length vectors to the point $\\\\jpoint{1}$: in this case we label them \
as $\\\\pvec{1}$ and $\\\\phatvec{1}$ \
respectively.\\rXX\\rXX\\rXX\\\\mmafig{Txb0404Complementary}{\\rXXThe \
parastichy vector $\\\\pvec{2}=(x_2,2h)$, in red, is the shortest vector on \
the cylinder to the point $\\\\jpoint{2}$ and always has \
$|x_2|\\\\leq\\\\jhalf$. The second-shortest vector to the point will wind in \
the opposite direction and is called the complementary vector \
$\\\\phatvec{2}$, in blue. Here $d=17/72$ so $x_2=2d$ and \
$\\\\phatvec{2}=\\\\pvec{2}-\\\\pvec{0}$ where  $\\\\pvec{0}=(1,0)$ is the \
horizontal vector around the circumference of the cylinder. A further, \
un-named vector is shown in green that winds more than a full turn about the \
cylinder: there are many vectors to the point $\\\\jpoint{2}$ with non-zero \
winding numbers. \
\\rXX}{1}\\rXX\\rXX\\\\begin{jExercise}\\\\label{ex:phoriz}\\rXX\\tShow that \
every parastichy vector has a horizontal component with absolute value less \
than or equal to $\\\\jhalf$, and every complementary vector has a horizontal \
component with absolute value unstrictly between $\\\\jhalf$ and $1$. Show \
that the sum of two parastichy vectors is either a parastichy vector or a \
complementary vector. \
\\rXX\\\\end{jExercise}\\rXX\\\\begin{jAnswer}{ex:phoriz}\\rXX\\tIf \
$\\\\pvec{k}=(x,z)$, then $|x|\\\\leq\\\\jhalf$ direct from the definition of \
a parastichy vector.\\rXX\\tIf $x>0$, then $\\\\phatvec{k}=\\\\pvec{k}- \
\\\\pvec{0}$ with \\rXX\\thorizontal component $x-1$ which is between $-1$ \
and $-\\\\jhalf$, and similarly for $x<0$. \\rXX\\tAdding $x$ components \
gives the final sentence. \
\\rXX\\\\end{jAnswer}\\rXX\\rXX\\rXX\\\\begin{jExercise}\\\\label{ex:pwinding}\
\\rXX\\tShow that it is not true in general that $\\\\pvec{k}=k\\\\pvec{1}$, \
but that $\\\\pvec{k}=k\\\\pvec{1}-w_k\\\\pvec{0}$ for some integer winding \
number $w_k$. Find a lattice in which there are no integers $m,n$ such that $\
\\\\pvec{3}=m\\\\pvec{1}+n\\\\pvec{2}$. \
\\rXX\\\\end{jExercise}\\rXX\\\\begin{jAnswer}{ex:pwinding}\\rXX\\tFor \
$d>\\\\jfrac{1}{4}$, $\\\\pvec{2}= (2d-1, h)=2\\\\pvec{1}-(1,0)\\\\neq \
2\\\\pvec{1}$;   in general we need to set $w_k= [ kd]$. For the second \
counter-example, choose $d$ so that $\\\\pvec{1}$ and $\\\\pvec{2}$ both have \
a positive $x$ component and $\\\\pvec{3}$ has a negative one.  \
\\rXX\\\\end{jAnswer}\\t\\t\\rXX\\\\begin{jExercise}\\\\label{ex:pcongruent}\\\
rXX\\t\\tTwo vectors on the cylindrical lattice are \\\\textit{congruent} if \
they go to the same point: $(\\\\jpoint{k},w)\\\\equiv(\\\\jpoint{l},w')$ iff \
$k=l$. \\rXX\\tShow that $\\\\pvec{n}\\\\equiv n\\\\pvec{1}$ and more \
generally that $u\\\\pvec{m}+v\\\\pvec{n}\\\\equiv\\\\pvec{um+vn}$ for \
integer  $u, v$.\\rXX\\tThis book doesn't explicitly make any further use of \
the congruence relation. \
\\rXX\\t\\\\label{ex:npm}\\rXX\\\\end{jExercise}\\rXX\\\\begin{jAnswer}{ex:\
pcongruent}\\rXX\\tUnwind the spiral onto the lattice in the plane by setting \
$\\\\Pvec{m}=\\\\pvec{m}+([md],0)=m(d,h)$. Then $u\\\\Pvec{m}+v\\\\Pvec{n}=\\\
\\Pvec{um+vn}$, and the result follows by taking the $x$ coordinate modulo~1. \
\\rXX\\t\\t\\\\end{jAnswer}\\rXX\\t\\rXX\\t\\rXX\\t\\rXX\\tInteger values of \
the divergence $d$ will not be very useful, and because   \
$\\\\mathcal{L}(d,h)= \\\\mathcal{L}(1+d,h)$, the range of $d$ can be taken \
as $(-\\\\jhalf,\\\\jhalf)$. The two lattices $\\\\mathcal{L}(d,h)$ and \
$\\\\mathcal{L}(-d,-h)$ are the same and we will assume that $h>0$. By \
contrast, the  lattices $\\\\mathcal{L}(d,h)$ and $\\\\mathcal{L}(-d,h)$ are \
mirror-images of each \
other.\\rXX\\t\\t\\rXX\\\\section{Parastichies}\\rXX\\\\label{sec:\
parastichies}\\rXXThe idea behind parastichies is to characterise a lattice \
not by its divergence, nor by identifying one point nearly above the origin, \
but by the most visible structures in the lattice, the families of straight \
lines that the eye naturally constructs through points in the lattice \
(Figure~\\\\ref{fig:Txb0405Parastichy5}).\\rXX\\rXX\\rXX\\rXX\\\\mmafig{\
Txb0405Parastichy5}{\\rXX\\tThe family of 5-parastichies is a set of five \
lines on the cylinder, each member passing through one of the points \
$\\\\jpoint{0}$ to $\\\\jpoint{4}$.\\rXX\\tThe thick line that passes through \
the origin  $\\\\jpoint{0}$, by definition the origin-parastichy of order 5,  \
also passes through the points $\\\\jpoint{5}$ and all points \
$\\\\jpoint{5k}$. The parastichy vector $\\\\pvec{5}$ (blue arrow) is the \
shortest vector from $\\\\jpoint{k}$ to $\\\\jpoint{k+5}$. \\rXX\\tThis \
lattice has divergence $d=17/72$ and rise $h=0.03$.\\rXX}{1}\\rXX\\rXX\\rXXWe \
model this psychological choice through the parastichy vector. For an integer \
$m$, the origin-parastichy of order $m$ is the infinite line on the cylinder \
winding through the origin and $\\\\jpoint{m}$ with slope $mh/\\\\dm$ (or \
zero in the case $m=0$). This choice of slope is equivalent to choosing the \
line that traverses the smallest $x$ distance between $0$ and \
$\\\\jpoint{m}$, and the portion of this line between $0$ and $\\\\jpoint{m}$ \
coincides with the vector $\\\\mvec=(\\\\dm,mh)$ defined above as the \
parastichy vector.\\rXX\\rXXFor integer $m$, we define the $m$-foliation as  \
the family of  $m$ lines on the cylinder containing the origin-parastichy of \
order $m$ and the parallel lines to it through the points \
$\\\\jpoint{1},\\\\ldots,\\\\jpoint{m-1}$. (These $m$ lines might not be \
distinct: there are only 5 distinct members of the $10$-foliation in \
Figure~\\\\ref{fig:Txb0405Parastichy5}.)\\rXXAn $m$-parastichy is any one \
member of the $m$-foliation, though usually we are thinking of the \
origin-parastichy of order $m$. \\rXXThe 1-parastichy, which passes through \
every point of the lattice, is known as the \\\\emph{genetic spiral}. \\rXX \
and each horizontal line through a point of the lattice is a $0$-parastichy. \
\\rXX\\rXXMost of the time the (eg) 5-parastichy, the point $\\\\jpoint{5}$, \
and the vector $\\\\pvec{5}$,  can be thought of interchangeably as standing \
for each other; but $\\\\phatvec{5}$ is a  vector winding the other way \
around the cylinder to $\\\\pvec{5}$ although it also arrives at  \
$\\\\jpoint{5}$.\\rXX\\\\subsection{Visible points and parastichies}\\rXXIn \
Figure~\\\\ref{fig:Txb0405Parastichy5} the point $\\\\jpoint{10}$ is not \
`visible' from the origin because the point $\\\\jpoint{5}$ can be thought of \
as obscuring it; the \\rXXorigin-parastichies of order 5 and 10 are the same \
lines. \\rXXWe say that $\\\\jpoint{m}$ is a \\\\emph{visible point}, or the \
$m$-parastichy is a \\\\emph{visible parastichy}\\\\index{parastichy \
vector!visible}, if the latter is linearly independent of all the \
$n$-parastichies for all $|n|<|m|$. \
\\rXX\\\\begin{jExercise}\\\\label{ex:pvisible}\\rXX\\tCheck  visually that \
in the lattice of Figure~\\\\ref{fig:Txb0405Parastichy5} the $7$- and $9$- \
parastichies are visible but the $2$- parastichy is not.\\rXXIf a point \
$\\\\jpoint{n}$ is on an $m$-parastichy then show that $\\\\jpoint{m+n}$ is \
on the same \
one.\\rXX\\\\label{ex:bb}\\rXX\\\\end{jExercise}\\rXX\\\\begin{jAnswer}{ex:\
pvisible}\\rXX\\tEach time we move from $\\\\jpoint{k}$ to $\\\\jpoint{k+1}$ \
we move to the next label in order of the foliation, which has $m$ members. \
When we have moved $m$ times we return to the original \
member.\\rXX\\\\end{jAnswer}\\rXX\\rXX\\rXX\\\\section{Parastichy pairs}\\rXX\
\\rXXSo far we have formalised what it means to be able to `see' a straight \
line in the lattice as a visible parastichy. We now concentrate on pairs of \
parastichies, as it is these pairs we will use to classify our lattices. \
Figure~\\\\ref{fig:Txb0406Parastichy45} shows two examples of parastichy \
pairs which might naturally be identified in a lattice. \
\\rXX\\rXX\\\\mmafig{Txb0406Parastichy45}{\\rXX\\tSome of the more obvious \
parastichies and their parastichy vectors in a lattice with $d=17/72$ and \
$h=0.03$. The blue lines highlight the family of 4-parastichies,  the red \
lines the family of 5-parastichies, and the green ones the family of \
1-parastichies. There are four members of the 4-parastichies, and the member \
that passes through the point 0 also passes through the point 4. For this \
lattice, $\\\\gp{1,4}$ and $\\\\gp{4,5}$ are each  examples of a generating \
and opposed pair: in each case the two parastichies wind in opposite \
directions, the parallelogram defined by the pair tiles the lattice and every \
lattice point is at a vertex of one of the parallelograms; the edges of the \
parallelograms form the parastichy lines. \
\\rXX}{0.9}\\rXX\\rXX\\\\begin{definition}\\rXXThe $\\\\gp{m,n}$-parastichy \
pair is the pair of parastichy vectors $\\\\mvec$ and $\\\\nvec$.\\rXXThe \
\\\\gphat{m}{n}-complementary pair is the pair of the parastichy vector \
$\\\\mvec$ and the complementary vector $\\\\phatvec{n}$.\\rXX\\\\index{pairs \
of parastichy vectors}\\\\index{parastichy vector!complementary \
vector}\\rXX\\\\label{def:pp}\\rXX\\\\end{definition}\\rXXComplementary pairs \
are only really needed for thinking about the special cases \\\\gphat{1}{k} \
and do not play a role in large Fibonacci lattices. The most important of \
these special cases, though is frequently seen. Plants may show \
\\\\textit{distichous} phyllotaxis, with successive organs  alternating in \
front and behind with a divergence of $180^\\\\circ$, correspond to a lattice \
with a \\\\gphat{1}{1} parastichy pair as in \
Figure~\\\\ref{fig:Txb0401LeafTypes}. The  hat can and will be dropped from \
the second \\\\textsf{1} when it is clear which of the vectors is meant. \
\\rXX\\rXX\\\\subsection{Opposed parastichy pairs}\\rXX\\\\index{pairs of \
parastichy vectors!opposed}\\rXXA parastichy pair $\\\\gp{m,n}$ is \
\\\\emph{opposed} if $m/\\\\dm$ and $n/\\\\dn$ have opposite sign, where \
$\\\\dm$ and $\\\\dn$ are the $x$-components of $\\\\mvec$ and $\\\\nvec$. A \
complementary pair \\\\gphat{m}{m} is always opposed. \\rXX Historically, the \
idea of opposed pairs, with parastichies that wind in opposite directions, \
was an important organising idea for lattice classification, and they do play \
a role, but here we put more emphasis on the idea of a {generating pair}, \
and, later,  even more on the principal pair. \
\\rXX\\rXX\\rXX\\rXX\\rXX\\\\section{Generating pairs}\\rXX\\\\index{pairs of \
parastichy vectors!generating pairs}\\rXXThere are many pairs of visible \
parastichies in a lattice, but Figure~\\\\ref{fig:Txb0407PPairs}  shows that \
finding one is not enough to characterise our lattices.   Looking at the \
lower left diagram of the Figure, both $\\\\pvec{5}$ and $\\\\pvec{7}$ are \
visible but knowing this pair exists doesn't tell us about $\\\\pvec{4}$: \
even though the pair  are linearly independent, we can't always express other \
parastichy vectors as their integer sums.  To make that precise we use the \
idea of a generating pair. \\rXX\\\\mmafig{Txb0407PPairs}{\\rXX\\tFurther \
parastichy pairs in the same lattice as \
Figure~\\\\ref{fig:Txb0406Parastichy45}. (a) $\\\\gp{5,9}$ is a generating \
but not opposed pair and the corresponding parallelogram (in black) has no \
lattice points except at its corners; (b) $\\\\gp{3,8}$, though a linearly \
independent pair, is  nonopposed and nongenerating pair; (c) although \
$\\\\pvec{5}$ and $\\\\pvec{7}$ are both visible parastichies, and are \
linearly independent, $\\\\gp{5,7}$ is  not a generating pair because there \
are lattice points internal to its parallelogram; (d) $\\\\gp{1,2}$ is not a \
linearly independent pair and cannot be generating, although for this spiral \
lattice, \\\\gphat{1}{2} is a generating \
pair.\\rXX}{1}\\rXX\\rXX\\\\begin{definition} A pair of vectors \
$\\\\mathbf{a}$ and $\\\\mathbf{b}$\\rXX\\t\\t   is \\\\emph{generating} in a \
lattice $\\\\mathcal{L}$ if every vector of $\\\\mathcal{L}$ can be expressed \
as a vector sum $q\\\\mathbf{a}+r\\\\mathbf{b}$\\rXX\\t\\t   for integer \
$q,r$.\\rXX\\\\label{def:g}\\rXX\\\\end{definition}\\rXX Most of the time the \
pair of vectors we see making up a generating pair will themselves each be \
parastichy vectors, but that is not required by the definition. If a pair is \
generating in the lattice $\\\\mathcal{L}(d,h)$ it is also generating in any \
other lattice with the same divergence, independently of $h$. In general one \
lattice has infinitely many generating pairs. \
\\rXX\\\\begin{jExercise}\\\\label{ex:pinfgp}\\rXX\\tShow \
this.\\rXX\\\\end{jExercise}\\rXX\\\\begin{jAnswer}{ex:pinfgp}\\rXX\\tIf the \
pair $(x_m, m h)$ and $(x_n,n h)$ is generating in the lattice \
$\\\\mathcal{L}(d,h)$, then the lattice  $\\\\mathcal{L}(d, s h )$ has a \
generating pair $(x_m, s m h)$ and $(x_n,s n h)$.\\rXX\\t\\rXX\\tIf \
$\\\\mvec$ and $\\\\nvec$ are a generating pair for $\\\\mathcal{L}$ then so \
is any invertible linear \
combination\\rXX\\t\\\\begin{equation}\\rXX\\t\\t\\\\begin{pmatrix}\\rXX\\t\\\
t\\\\mvec' \\\\\\\\ \\\\nvec' \\rXX\\t\\t\\\\end{pmatrix}= \
\\rXX\\t\\\\begin{pmatrix}\\rXX\\t\\ta & b  \\\\\\\\ c & d  \
\\rXX\\t\\\\end{pmatrix}\\t\\\\begin{pmatrix}\\rXX\\t\\\\mvec \\\\\\\\ \
\\\\nvec \\rXX\\\\end{pmatrix}\\rXX\\t\\\\end{equation}\\rXX\\tfor integer \
$a,b,c,d$. Most of these will not be parastichy vector \
pairs.\\rXX\\\\end{jAnswer}\\rXX\\rXXSince every point in our lattice has a \
rise which is an integer multiple of $h$, a necessary condition for a pair to \
be generating is that it can generate all these $h$ multiples in the vertical \
component of its \
sums:\\rXX\\\\begin{theorem}\\rXX\\t\\\\label{thm:coprime1}\\rXX\\tIf a \
parastichy pair $\\\\gp{m,n}$ is generating, then $m$ and $n$ are co-prime. \
\\rXX\\\\end{theorem}\\rXX\\\\begin{proof}\\rXX\\tWrite $\\\\pvec{1}= \
v\\\\pvec{m}-u\\\\pvec{n}$; then the rise of $\\\\pvec{1}$ shows $mv-nu = 1$ \
holds and Section~\\\\ref{sec:coprime} shows that $|m|,|n|$, and hence $m,n$, \
are co-prime. The converse is not true: see \
Figure~\\\\ref{fig:Txb0407PPairs}. In particular though 1 and 1 are co-prime \
the parastichy pair $\\\\gp{1,1}$ is not \
generating.\\rXX\\\\end{proof}\\rXXThis is not a sufficient condition. For \
example:\\rXX\\\\begin{theorem}\\rXX\\t\\\\label{thm:coprime}\\rXX\\tIf \
$\\\\mvec$ and $\\\\nvec$ are co-linear then they are not \
generating.\\rXX\\\\end{theorem}\\rXX\\\\begin{proof}\\rXX\\tCo-linearity \
means that any vector sum of $\\\\pvec{m}$ and $\\\\pvec{n}$ lies on the line \
in the plane through $\\\\jpoint{m}$ and $\\\\jpoint{n}$. For some large \
enough $k$ this will contain a point of the plane lattice of rise $kh$ with \
co-ordinates outside of the cylinder. The vector to this point is therefore \
not a parastichy vector but is the only candidate for a vector sum with rise \
$kh$, and so the parastichy vector $\\\\pvec{k}$ is not an integer sum of $\\\
\\mvec$ and $\\\\nvec$.\\rXX\\\\end{proof}\\rXXExcluding co-linearity is \
still not enough, as part (b) of Figure~\\\\ref{fig:Txb0407PPairs} suggests. \
The next section finds an algebraic condition for a pair to be generating. \
\\rXX\\rXX\\\\begin{jExercise}\\\\label{ex:p01g}\\rXX\\t\\\\label{ex:\
01generating}\\rXX\\tShow that $\\\\gp{0,1}$ is always generating, and that  \
$\\\\gp{0,n>1}$ never is. \
\\rXX\\\\end{jExercise}\\rXX\\\\begin{jAnswer}{ex:p01g}\\rXX\\tAny parastichy \
vector $\\\\pvec{k}$ can be written as $k\\\\pvec{1}-w_k \\\\pvec{0}$, so $\\\
\\gp{0,1}$ is generating. The rise of every integer sum of $\\\\pvec{0}$ and \
$\\\\pvec{n>1}$ is a multiple of $nh$ and cannot be equal to $h$ and the pair \
cannot generate \
$\\\\pvec{1}$.\\rXX\\t\\rXX\\\\end{jAnswer}\\rXX\\\\begin{jExercise}\\\\label{\
ex:pcomp}\\rXX\\tShow that the complementary pair \\\\gphat{m}{m} is \
generating only when \
$|m|=1$.\\rXX\\\\end{jExercise}\\rXX\\\\begin{jAnswer}{ex:pcomp}\\rXX\\tSince \
$\\\\pvec{0}=\\\\pvec{1}\\\\pm\\\\phatvec{1}$, every parastichy vector \
$\\\\pvec{k}=k\\\\pvec{1}-w\\\\pvec{0}$ is an integer sum of $\\\\pvec{1}$ \
and $\\\\phatvec{1}$. However every integer sum of\\rXX\\t$\\\\pvec{m}$ and $\
\\\\phatvec{m}$ has rise which is a multiple of $m$ and so the pair is not \
generating unless $|m|=1$. \
\\rXX\\\\end{jAnswer}\\rXX\\rXX\\rXX\\rXX\\\\begin{jExercise}\\\\label{ex:\
p57ng}\\rXX\\tShow that in the lattice $\\\\mathcal{L}(d=17/72)$, \
$\\\\pvec{4}$ cannot be expressed as an integer sum of $\\\\pvec{5}$ and \
$\\\\pvec{7}$ and thus that $\\\\gp{5,7}$ is not generating in this \
lattice.\\rXX\\\\end{jExercise}\\rXX\\\\begin{jAnswer}{ex:p57ng}\\rXX\\tThe \
only candidate vector sum with the correct rise is \
$2\\\\pvec{7}-2\\\\pvec{5}$, but by direct calculation this is \
$\\\\pvec{4}-(1,0)$ and thus is not a parastichy vector. \
\\rXX\\\\end{jAnswer}\\rXX\\rXX\\rXX\\\\subsection{Generating pairs as basis \
vectors}\\rXX A helpful way to think of the generating pair $\\\\gp{m,n}$ is \
that  $\\\\pvec{m}$ and $\\\\pvec{n}$ provide a coordinate basis for the \
plane, and the lattice points are the ones with integer coordinates in that \
basis. From this perspective, a cylindrical lattice is not generated merely \
by the first parastichy vector $\\\\pvec{1}$, but instead by  the pair \
comprising  $\\\\pvec{1}$ together with the periodicity vector $\\\\pvec{0}$, \
which is used as necessary to pull multiples of $\\\\pvec{1}$ back into the \
cylindrical strip (Figure~\\\\ref{fig:Txb0408Periodic}).\\rXX \
\\\\mmafig{Txb0408Periodic}{The  pair of red and blue vectors $\\\\pvec{3}$ \
and $\\\\pvec{2}$ , and the pair of white and green vectors $\\\\pvec{0}$ and \
$\\\\pvec{1}$ each generate the same lattice}{1.0}\\rXX Indeed we saw in \
Exercise~\\\\ref{ex:01generating} that $\\\\pvec{0}$ and $\\\\pvec{1}$ are \
always generating, or in this sense always form a basis pair for the \
cylindrical lattice. \\rXX But there are many possible gnerating pairs. \\rXX \
One of the ways that this is viewpoint is useful  that it gives us a way to \
characterise generating pairs by thinking of them as corresponding to a \
change of basis from the basis associated with $\\\\gp{0,1}$ and produce the \
central algebraic result of this \
chapter:\\rXX\\rXX\\\\begin{theorem}\\rXX\\\\label{thm:gLattice}\\rXX\\\\\
label{thm:glattice}\\rXX\\tIn any lattice $\\\\mathcal{L}(d,h)$, the \
following are equivalent for coprime integers \
$m,n$:\\rXX\\t\\\\begin{enumerate}\\rXX\\t\\t\\t\\\\item The pair of \
parastichy vectors $\\\\mvec$ and $\\\\nvec$, is a generating \
pair.\\rXX\\\\item The area of the parallelogram formed by $\\\\mvec$ and $\\\
\\nvec$, namely the vector cross product $h\\\\Delta_{mn}=\\\\mvec\\\\times\\\
\\nvec$, satisfies\\rXX$|\\\\Delta_{mn}|=1$. \\t\\rXX\\t\\t\\\\item The \
integers $u=[md],v=[nd]$ satisfy $|mv-un|=1$ and the parastichy \
vectors\\t\\rXX\\t\\t satisfy \
\\rXX\\t\\\\begin{align}\\\\label{eq:Pmnuv1}\\rXX\\t\\t\\t\\\\begin{pmatrix}\\\
rXX\\t\\t\\t\\\\nvec \\\\\\\\ \\\\mvec \\rXX\\t\\t\\\\end{pmatrix} = \
&\\rXX\\t\\t\\\\begin{pmatrix}\\rXX\\t\\tn & - v \
\\rXX\\t\\t\\\\\\\\\\rXX\\t\\tm &- u \
&\\rXX\\t\\t\\t\\\\end{pmatrix}\\rXX\\t\\t\\\\begin{pmatrix}\\rXX\\t\\t\\t\\\\\
pvec{1}\\rXX\\t\\t\\t\\\\\\\\\\rXX\\t\\t\\t\\\\pvec{0}\\rXX\\t\\t\\\\end{\
pmatrix}\\rXX\\t\\\\end{align}\\rXX\\t\\\\end{enumerate}\\rXX\\\\end{theorem}\
\\rXX\\\\begin{proof}\\rXX\\tSuppose (1) is true. Since the pair  $\\\\mvec$ \
and $\\\\nvec$, is generating the lattice is tiled\\rXX\\tby the \
$(\\\\mvec,\\\\nvec)$ parallelogram with an area per point of \
$h|\\\\Delta_{mn}|$. But  the $(\\\\pvec{0},\\\\pvec{1})$ parallelogram also \
tiles the same lattice with an area per point of $h= \
(1,0)\\\\times(d,h)=h\\\\Delta_{01}$. These areas must be the same, so that \
$|\\\\Delta_{mn}|=|\\\\Delta_{01}|=1$, and (1) $\\\\implies$ (2). \
\\rXX\\t\\rXXBy definition $\\\\mvec=m\\\\pvec{1}- [md]\\\\pvec{0}$,  \
$\\\\nvec=n\\\\pvec{1}-[nd]\\\\pvec{0}$. Assume (2) is true  and set $u=[md]$ \
and $v=[nd]$, so~\\\\eqref{eq:Pmnuv1} holds \\rXX\\t\\tand the cross product \
$h\\\\Delta_{mn}=\\\\mvec\\\\times\\\\nvec=(m v - u n) (\\\\pvec{1} \\\\times \
\\\\pvec{0})$ gives $|m v-un|=1$ and so\\rXX\\t (2)$\\\\implies$(3). \
\\rXX\\rXXSuppose (3) holds, and invert equation~\\\\eqref{eq:Pmnuv1} in \
integers to \
see\\rXX\\t\\\\begin{align}\\t\\rXX\\t\\t\\\\label{eq:Pmnuv2}\\rXX\\t\\t\\\\\
begin{pmatrix}\\rXX\\t\\t\\t\\\\pvec{1}\\rXX\\t\\t\\t\\\\\\\\\\rXX\\t\\t\\t\\\
\\pvec{0}\\rXX\\t\\t\\\\end{pmatrix} = & \\\\pm 1 \
\\\\cdot\\rXX\\t\\t\\\\begin{pmatrix}\\rXX\\t\\t\\t-u &  v \\rXX\\t\\t\\t\\\\\
\\\\\\rXX\\t\\t\\t-m & n \
&\\rXX\\t\\t\\\\end{pmatrix}\\rXX\\t\\t\\\\begin{pmatrix}\\rXX\\t\\t\\t\\\\\
nvec \\\\\\\\ \\\\mvec \\rXX\\t\\t\\\\end{pmatrix}. \
\\rXX\\t\\\\end{align}\\rXXThis shows  $\\\\pvec{0}$ and $\\\\pvec{1}$ are \
expressible as integer sums of $\\\\mvec$ and $\\\\nvec$ and so the pair  $\\\
\\mvec$ and $\\\\nvec$ is generating and (3) $\\\\implies$ (1). \
\\rXX\\rXX\\\\end{proof}\\rXX Figure~\\\\ref{fig:Txb0409Apextriangle} \
illustrates the properties $m\\\\nvec-n\\\\mvec=\\\\pm\\\\pvec{0}$ and \
$v\\\\mvec-u\\\\nvec=\\\\pm\\\\pvec{1}$ shown \
by~\\\\eqref{eq:Pmnuv2}.\\rXX%\\rXX\\\\mmafig{Txb0409Apextriangle}{A \
generating pair \\rXX\\tmust by definition be able to express other lattice \
vectors, and in particular  $\\\\pvec{0}$ and $\\\\pvec{1}$. \
Theorem~\\\\ref{thm:glattice} finds the necessary coefficients. Here \
$d=17/72$, and the $\\\\gp{m,n}=\\\\gp{5,4}$ pair is generating, with \
$x_m=13/72$, $x_n=-4/72$, $u=1$, $v=1$, $\\\\Delta=m v-nu=1$.\\rXX\\tThe \
larger triangle is formed by translating $\\\\mvec$ by $\\\\pvec{0}$ , and \
then scaling it by $n$ until it meets   $m\\\\nvec$; that must be a lattice \
point if the pair is generating. This illustrates $\\\\pvec{0}=m\\\\pvec{n}-n\
\\\\pvec{m}$.\\rXX\\tIn the smaller triangle, out of every $u$ and $v$ \
satisfying $mv-nu=1$, and thus giving\\rXX\\t $v\\\\pvec{m}-u\\\\pvec{n}$  \
rise 1, the same as $\\\\pvec{1}$, there is exactly one $(u,v)$ pair giving a \
parastichy vector which is therefore $\\\\pvec{1}$. \
\\t}{1.0}\\rXX%\\rXX%\\rXXThe parallelogram tiling of \
Theorem~\\\\ref{thm:glattice} also shows the following, since the $m$ and $n$ \
parastichies are formed by the boundary of the $\\\\pvec{m},\\\\pvec{n}$ \
parallelogram\\rXX\\\\begin{theorem}\\rXX\\t\\\\label{thm:planeintersect}\\\
rXX\\tIf the parastichy pair $\\\\gp{m,n}$ is generating then the plane \
parastichies of order $m$ and $n$ intersect only at points of the lattice in \
the plane.\\rXX\\\\end{theorem}\\rXXThe converse of the Theorem is not true; \
the intersections of the 3- and 8-parastichies in  \
Figure~\\\\ref{fig:Txb0407PPairs} are exactly the points of $\\\\mathcal{L}$ \
but $\\\\gp{3,8}$ is not generating for that lattice. \\rXXThis Theorem \
allows a more algebraic demonstration of the requirement that $|\\\\Delta|=1$ \
for a generating pair,  by calculating the coordinates of the apex point in \
Figure~\\\\ref{fig:Txb0409Apextriangle}: this has rise $mnh/\\\\Delta_{mn}$ \
which must be an integer multiple of $mn$ since it is a lattice point and so \
$|\\\\Delta_{mn}|=1$ since $m$ and $n$ are co-prime.  \
\\rXX\\rXX\\t\\rXX\\\\begin{jExercise}\\\\label{ex:padajacent}\\rXX\\tIf \
$\\\\gp{m,n}$ is generating, then $\\\\mvec$ lies on the adjacent \
$n$-parastichy to $\\\\nvec$. \
\\rXX\\\\end{jExercise}\\rXX\\\\begin{jAnswer}{ex:padajacent}\\rXX\\t$\\\\\
mvec$ lies on the $m$-parastichy through the origin, and on some \
$n$-parastichy. If this was not the one adjacent to the $n$-parastichy \
through the origin, then it would intersect that $n$-parastichy and the \
intersection would be a lattice point since the pair is generating. But then \
the intersection would be a lattice point in but not at the corners of the \
$m,n$ parallelogram which it cannot be since the pair is generating. \
\\rXX\\\\end{jAnswer}\\rXX\\rXXTheorem~\\\\ref{thm:glattice} is not as \
general as it could be because not all generating pairs are pairs of \
parastichy vectors. We will also encounter the case of the pair of vectors \
\\rXX$\\\\pvec{1}$ and $\\\\phatvec{n}$ which are a parastichy vector and a \
complementary vector. But if need be, each part of \
Theorem~\\\\ref{thm:glattice} can be translated as a statement about \
$\\\\phatvec{n}=\\\\nvec\\\\pm\\\\pvec{0}$ instead of $\\\\nvec$. \
\\rXX\\rXX\\\\begin{jExercise}\\\\label{ex:pdeltacomp}\\\\label{ex:calcdelta}\
\\rXXExtend the definition of $\\\\Delta$ to complementary vectors. \\tFind   \
$\\\\Delta_{1n}$ and $\\\\Delta_{1\\\\hat n}$. Find  $d$-intervals on which \
\\rXX$\\\\Delta_{12}=1$ or $\\\\Delta_{1\\\\hat 2}=1$. \
Rewrite~\\\\eqref{eq:Pmnuv1} for the case \
$\\\\phatvec{n}=\\\\pvec{n}+\\\\sigma\\\\pvec{1}$.\\rXX\\\\end{jExercise}\\\
rXX\\\\begin{jAnswer}{ex:pdeltacomp}\\rXXFrom Theorem~\\\\ref{thm:glattice}, \
$h\\\\Delta_{1n}=\\\\pvec{1}\\\\times\\\\pvec{n}=[nd]$.\\rXXSetting \
$\\\\sigma=\\\\Sign (nd -[nd])$, \
$\\\\phatvec{n}=\\\\pvec{n}-\\\\sigma\\\\pvec{0}$ and so $\\\\Delta_{1\\\\hat \
n}=[nd]+\\\\sigma$. \\rXXIf $0<d<\\\\jfrac{1}{4}$ then $\\\\Delta_{12}=1$ and \
$\\\\Delta_{1\\\\hat2}=0$, while \\rXXif  $\\\\jfrac{1}{4}<d<\\\\jfrac{1}{2}$ \
then  $\\\\Delta_{12}=0$ and $\\\\Delta_{1\\\\hat2}=1$.\\rXXFinally we must \
choose $u,v$ so that $|mv -u(n+\\\\sigma)|=1$ \
and\\rXX\\t\\t\\\\begin{align}\\\\label{eq:Pmnuv1ex}\\rXX\\t\\t\\\\begin{\
pmatrix}\\rXX\\t\\t\\t\\\\phatvec{n} \\\\\\\\ \\\\mvec \
\\rXX\\t\\t\\\\end{pmatrix} = &\\rXX\\t\\t\\\\begin{pmatrix}\\rXX\\t\\t\\t(n+\
\\\\sigma)  & - v \\rXX\\t\\t\\t\\\\\\\\\\rXX\\t\\t\\tm &- u \
&\\rXX\\t\\t\\\\end{pmatrix}\\rXX\\t\\t\\\\begin{pmatrix}\\rXX\\t\\t\\t\\\\\
pvec{1}\\rXX\\t\\t\\t\\\\\\\\\\rXX\\t\\t\\t\\\\pvec{0}\\rXX\\t\\t\\\\end{\
pmatrix}\\rXX\\t\\\\end{align}\\rXX\\\\end{jAnswer}\\rXX\\rXXTheorem~\\\\ref{\
thm:glattice} gives us a criterion, $|\\\\Delta_{mn}|=1$, for a parastichy \
pair to be generating which is independent of $h$: whether a parastichy pair \
is generating or not is independent of the rise, as can be seen by scaling \
the diagrams of Figure~\\\\ref{fig:Txb0407PPairs} vertically.  Note also that \
$\\\\gp{m,n}$ are not claimed to be unique: for fixed $d$ and thus \
$\\\\pvec{0}$ and $\\\\pvec{1}$, every integer matrix with determinant of \
modulus 1 in~\\\\eqref{eq:Pmnuv1} yields a different generating \
pair.\\rXX\\rXX\\rXX\\\\section{Estimating the divergence for a generating \
parastichy pair}\\rXXSuppose that we observe a lattice with a  generating \
parastichy pair of $\\\\gp{55,89}$. Although this is  compatible with a range \
of divergences $d$, they turn out all to be in a small interval around the \
Fibonacci angle. To make this precise, we will \\rXXcompute \
\\\\emph{generating intervals}. Since, as we have just seen, whether or not a \
pair are generating in a lattice $  \\\\mathcal{L}(d,h)$ is independent of \
$h$, these intervals only depend on $d$:\\rXX\\\\begin{definition}\\rXX\\tThe \
generating interval for the integers $m$ and $n$ is the subset\\rXX\\tof the \
$d$-interval $[0,1]$ for which $\\\\gp{m,n}$ is generating in  \
$\\\\mathcal{L}(d,\\\\cdot)$.\\rXX\\\\end{definition}\\rXXIt's apparent from \
Theorem~\\\\ref{thm:glattice} that the generating interval is exactly when \
\\rXX $|\\\\Delta=mv-nu|=1$. This integer valued function is dependent on the \
real variable $d$, so it must be a step-function of $d$. A few special cases, \
like $\\\\Delta_{01}=1$, and $\\\\Delta_{1\\\\hat 1}=1$ are constant on the \
whole $d$-interval, but in general the work in calculating $\\\\Delta$ \
consists in finding where these step changes are.%\\rXX\\rXX\\rXX\\rXXFor \
simple parastichy numbers we can calculate generating intervals directly, \
along with the \\rXXcomplementary-generating interval for the integers $m$ \
and $n$, which is the subset of  $[0,1]$ for which  \\\\gphat{m}{n} is \
generating in  \
$\\\\mathcal{L}(d,\\\\cdot)$.\\rXX\\\\begin{jExercise}\\\\label{ex:pmn01g}\\\
rXX\\tFind the generating and complementary-generating intervals for \
$m=0,n=1$ and for $m=1,n$. \
\\rXX\\\\end{jExercise}\\rXX\\\\begin{jAnswer}{ex:pmn01g}\\rXX\\t By \
Exercise~\\\\ref{ex:calcdelta} the generating and complementary-generating \
intervals for $m=0$ and $n=1$ are the whole $d$-interval  $[0,\\\\jhalf]$.  \
\\rXX\\tThe generating interval for $1,1$ is empty, since $\\\\gp{1,1}$ is \
never generating, but the complementary-generating interval is the whole \
$d$-interval, since \\\\gphat{1}{1} is always generating.\\rXXFor $m=1$, \
$n=2$, Exercise~\\\\ref{ex:calcdelta} shows that the generating interval is \
$[\\\\jfrac{1}{4},\\\\jhalf]$ and the complementary-generating interval is \
the whole $d$-interval.\\rXXFor $m=1$ and $n>2$,  \
Exercise~\\\\ref{ex:calcdelta} shows the generating interval is the $d$ such \
that $[nd]=1$, which is $2nd\\\\in [1,3]$.  \\rXXThe complementary pair is \
generating either when (a) $[nd]=0$, which requires $2nd<1$ or (b) when both \
$[nd]=2$ (so $2nd\\\\in [3,5]$) and $nd<[nd]=2$,\\rXXso (b) requires \
$2nd\\\\in[3,4]$. These two possibilities flank the generating interval.\\rXX\
\\\\end{jAnswer}\\rXXThese direct calculations become more irksome for larger \
numbers, but we can also calculate generating intervals using winding-number \
pairs. The strategy to find the generating interval for ${m,n}$ is first to \
find $u,v$ satisfying equation $mv-nu=\\\\pm 1$, so we can satisfy Theorem~\\\
\\ref{thm:gLattice} and then to solve the piecewise linear equations $[md]=u$ \
and $[nd]=v$ for $d$. For a general one of these B\\\\'ezout pairs, the \
resulting interval won't be in $[0,\\\\jhalf]$, although there will be one \
related by an integer difference or the mirror symmetry $d\\\\rightarrow1-d$. \
In fact, the selection of the winding-number pair from the possible \
B\\\\'ezout pairs in section~\\\\ref{sec:wnp} was so as to ensure we get a \
generating interval in $[0,\\\\jhalf]$, as we will see in the proof of \
Theorem~\\\\ref{thm:fundamentalcorresponding}. \
\\rXX\\rXX\\rXX\\\\begin{jExercise}\\\\label{ex:pmirror}\\rXX\\tShow that the \
$d$-intervals on which\\rXX\\t$\\\\Delta_{mn}=\\\\pm1$ are related by the \
mirror symmetry.\\rXX\\\\end{jExercise}\\rXX\\\\begin{jAnswer}{ex:pmirror}\\\
rXX\\tWrite the intervals for $\\\\Delta=-1$ as $(L_{m-},R_{m-})= \
(u_--\\\\jhalf,u_-+\\\\jhalf)/m$, $(L_{n-},R_{n-})= \
(v_--\\\\jhalf,v_-+\\\\jhalf)/n$.\\rXX\\tUse $u_-=m-u$ and $v_-=n-v$. \\rXX\\\
\\end{jAnswer}\\rXX\\rXXExample~\\\\ref{ex:fibex} shows the relationship \
between Fibonacci generating pairs and the golden ratio. \\rXX\\rXX\\rXX\\rXX\
\\\\begin{jExercise}\\\\label{ex:pneartau}\\rXX\\tShow that  pairs of large \
enough adjacent Fibonacci numbers are parastichy numbers which are generating \
in a lattice only if the divergence in $[0,\\\\jhalf]$ is near to \
$1/\\\\tau^2$.\\rXX\\t\\\\label{ex:fibex}\\rXX\\\\end{jExercise}\\rXX\\\\\
begin{jAnswer}{ex:pneartau}\\rXX\\tSuppose $k$ is odd, then the \
winding-number pair for \\rXX\\t$m=F_k$, $n=F_{k+1}$ is $u=F_{k-1}$, \
$v=F_{k}$. \\rXX\\tLet $I_k$ be the interval \
$[F_k-\\\\jhalf,F_k+\\\\jhalf]/F_{k+1}$. \\rXX\\tThen $[md]=u$ when $d\\\\in \
I_k$ and $[nd]=v$ when $d\\\\in I_{k+1}$.\\rXX\\tAs $k$ becomes large and \
odd, $I_k$ tends to the point $\\\\lim F_k/F_{k+1}=1/\\\\tau$.\\rXX\\tIf $k$ \
is even, the winding number pair is $F_{k-2}$,$F_{k-1} = \
F_{k}-F_{k-1},F_{k+1}-F_k$ which we recognise as giving us the interval \
$1-I_k$ for $[md]=u$ and $[nd]=v$ instead.  \\rXXSince $1/\\\\tau>\\\\jhalf$, \
in either case the interval in $[0,\\\\jhalf]$ on which\\rXXparastichy \
vectors for adjacent Fibonacci numbers\\rXX is generating is close to $1-1/\\\
\\tau=1/\\\\tau^2$. \
\\t\\rXX\\\\end{jAnswer}\\rXX\\rXX\\rXX\\rXX\\\\section{Opposed \
intervals}\\rXXSimilarly to calculating generating intervals, we can \
calculate opposed intervals: those on which a given parastichy pair is \
opposed. There are no more than two disjoint generating intervals for a given \
pair, related by the mirror symmetry, but there can be many opposed \
intervals. \\rXXWe recall \\rXX$\\rXXx_m = m d - [ m d]$,\\rXX$\\rXXx_n = n d \
- [ n d ].\\rXX$\\rXXFor $m,n$ positive integers not both equal to one, the \
pair $\\\\gp{m,n}$ is {opposed} if $x_m x_n <0$.\\rXXWe define $\\\\gp{0,1}$  \
and \\\\gphat{m}{m}  to be opposed.\\rXX\\rXX\\\\section{The Fundamental \
Theorem of Phyllotaxis}\\rXX\\\\mmafig{Txb0410GeneratingIntervals}{Generating \
intervals for a range of $\\\\gp{m,n}$ parastichy pairs. The horizontal line \
represents the $d$ interval $[0,\\\\jhalf]$ . It is drawn dashed if it is the \
$\\\\Delta_{mn}=+1$ generating interval which falls into $[0,\\\\jhalf]$ and \
dotted if it is the $\\\\Delta_{mn}=-1$ interval. \\rXX\\tRed bars show the \
subinterval on which the $\\\\gp{m,n}$ pair is generating and opposed; grey \
bars show the subinterval on which it is generating and \
unopposed.\\rXX}{.8}\\rXX\\\\label{sec:ftp}\\rXXFinally, we can take the \
intersection of the generating interval and the opposed interval to find the \
generating and opposed interval. This is the $d-$interval on which the pair \
of vectors $\\\\gp{m,n}$ is both generating and opposed in the lattice \
$\\\\mathcal{L}(d,h)$.\\rXXWhen we calculate this we get what Jean called the \
`Fundamental Theorem' of \
Phyllotaxis~\\\\autocite{jeanPhyllotaxisSystemicStudy1994}:\\rXX\\\\begin{\
theorem}  \\rXX\\t\\\\label{thm:fundamentalcorresponding}\\rXX\\tSuppose that \
a lattice $\\\\mathcal{L}(d,h)$ is generated by  $d$ in $[0,\\\\jhalf]$ and \
that $1<m<n$. \\rXX\\tIf the parastichy vectors $\\\\pvec{n}$ and \
$\\\\pvec{m}$ are generating and opposed,\\rXX\\tand $u$ and $v$ are the \
winding-number pair for  $m$ and $n$ defined in section~\\\\ref{sec:wnp}, \
then $d$ is in the Farey interval \
$G=[u/m,v/n]$.\\rXX\\\\end{theorem}\\rXXThis says that if we see $m$ spirals \
one way and $n$ the other, the divergence of the lattice will be in the range \
$[u/m,v/n]$. The  winding-number pair, which already played a discreet role \
in Theorem~\\\\ref{thm:gLattice}, appears again in the Fundamental Theorem, \
without a very satisfying reason. The proof below doesn't add much \
explanation, but one will appear in the next \
Chapter.\\rXX\\rXX\\\\begin{proof}\\rXX\\tTemporarily allow $u$ and $v$ to be \
any B\\\\'ezout pair for $m$ and $n$, and let  $M$ be the $d$-interval on \
which $[md]=u$ \\rXX\\t\\tand  $N$ that where $[nd]=v$. The third part of \
Theorem~\\\\ref{thm:gLattice} says that the lattice $\\\\mathcal{L}({d,h})$ \
has  $\\\\pvec{m}$ and $\\\\pvec{n}$ as a generating pair on the interval \
$M\\\\cap N $. \\rXX\\t\\t\\t\\t\\rXX\\rXX\\tFrom $[md]=u$ etc we can \
calculate the endpoints of $M=[L_m,R_m]$ and $N=[L_n,R_n]$ as $m \
L_m=u-\\\\jhalf$, $mR_m=u+\\\\jhalf$, $n L_n=v-\\\\jhalf$, $n \
R_n=v+\\\\jhalf$. \\tSetting $\\\\Delta=n u - mv$, noting that $\\\\Delta=-1$ \
if $u/m<v/n$ and $\\\\Delta=+1$ if $u/m>v/n$  we find \
\\rXX\\t\\\\begin{align*}\\rXX\\t\\t 2mn (u/m-L_m)& =n \\rXX\\t\\t \
\\\\\\\\\\rXX\\t\\t  2mn (v/n-L_m)& =n - 2\\\\Delta\\rXX\\t\\t \
\\\\\\\\\\rXX\\t\\t \\t 2mn (u/m-L_n)& =m+2\\\\Delta\\rXX\\t\\t\\t\\t \
\\\\\\\\\\rXX\\t\\t \\t 2mn (v/n-L_n)& \
=m\\rXX\\t\\t\\\\end{align*}\\rXX\\t\\tso that with either choice of \
$\\\\Delta=\\\\pm 1$, both $L_m$ and $L_n$ are less than or equal to the \
smaller of $u/m$ and $v/n$.\\rXX\\t\\tA similar argument shows that both \
$R_m$ and $R_n$ are larger than the greater of  $u/m$ and $v/n$.\\rXX\\t\\tso \
the Farey interval $G=[u/m,v/n]$ is contained within the  interval $M\\\\cap \
N $.\\rXX\\t\\t\\rXX\\tOn the interval  $M\\\\cap N $, the horizontal \
components of the parastichy vectors are  $x_m(d)=md-u$ and $x_n(d)=nd-v$.  \
These are increasing functions with unique zeros at $u/m$ and $v/n$ \
respectively; both horizontal components are negative at the beginning of  $M\
\\\\cap N$ and both are positive at the end and change sign exactly one, at  \
$u/m$ and $v/n$ respectively, so that the Farey interval $G$ is the only \
subinterval of $M\\\\cap N$ on which the two parastichy vectors are opposed, \
and so is a generating and opposed interval.\\rXX\\t\\t\\t\\t\\rXX\\tRecall \
from section~\\\\ref{sec:wnp} that the winding-number pair $u, v$ for $m, n$ \
has the property that their Farey interval \
$G=[u/m,v/n]\\\\subseteq[0,\\\\jhalf]$. If instead $u, v$ were a different \
B\\\\'ezout pair for $m,n$, then they are either of the form $u'=m-u$, \
$v'=n-v$, which would lead to a Farey interval of $G'=1-G$ and so outside \
$[0,\\\\jhalf]$, or $u'=u+km$, $v'=v+kn$ which would lead to a Farey interval \
$G'=[u/m+k,v/n+k]$ outside $[0,1]$. \\rXX\\t\\rXX\\tSo the generating and \
opposed interval in  $[0,\\\\jhalf]$ is exactly the Farey interval for the \
winding-number pair. \
\\rXX\\t\\rXX\\t\\t\\t\\rXX\\\\end{proof}\\rXX\\rXXJean's statement of this \
theorem~\\\\autocite{jeanPhyllotaxisSystemicStudy1994} is incorrect in the \
case $m=1$. This is because of the complication which arises in the following \
exercise, but although of historical significance\\\\footnote{Trying to \
understand these complications is what led me to write this half of this \
book, and in particular to introduce the complementary vector.} there is \
little deeper importance to this edge case and it is excluded in my version \
of the Theorem above.\\rXX\\rXX\\\\begin{jExercise}\\\\label{ex:ftpfail}\\rXX\
\\tCalculate generating and opposed intervals for the integer pairs $m=1,n=1$ \
and $m=1,n>1$.\\rXX\\\\end{jExercise}\\rXX\\\\begin{jAnswer}{ex:ftpfail}\\rXX\
\\tIn Theorem~\\\\ref{thm:fundamentalcorresponding} the vectors are \
restricted to be parastichy vectors, but to find two generating and opposed \
vectors  with $m=1$ and $n=1$ we must allow complementary vectors and take \
$\\\\pvec{1}$ and $\\\\phatvec{1}$. \\rXX\\tThese are always generating and \
opposed and so the generating interval is $[0,1]$. \\rXX\\tEither B\\\\'ezout \
pair of $u=1, v=0$ or $u=0,v=1$ allows this to be written as $[u/m,v/n]$ in \
some order.\\rXX\\t\\rXX\\tSuppose that $m=1$ and $n>1$. If $dn<\\\\jhalf$, \
then $\\\\pvec{1}$ and $\\\\pvec{n}$ are co-linear, so instead pay attention \
to the pair $\\\\pvec{1}$ and $\\\\phatvec{n}$. For $d$ small and positive \
this pair is generating and opposed, and remains so until $dn=\\\\jhalf$ at \
which point the horizontal component of $\\\\pvec{n}$ increases through \
$\\\\jhalf$ and jumps back down to $-\\\\jhalf$ so that  $\\\\pvec{n}$ is no \
longer co-linear with $\\\\pvec{1}$. As $d$ continues to increase, the new \
pair $\\\\pvec{1}$ and $\\\\pvec{n}$ remain generating and opposed until\\rXX\
\\t $\\\\pvec{n}$ becomes vertical, which happens when $nd=1$. After this the \
pair is no longer opposed.\\rXX\\t \\t For $m=1$ amd $n>1$, the \
winding-number pair is $u=0$ and $v=1$, corresponding to a Farey interval of \
$[0,1/n]$. Thus this is the interval on which the lattice has an opposed \
generating pair, but below the midpoint $d<1/2n$, the pair is of a parastichy \
vector and a complementary vector. \\rXX\\t \\rXX\\rXX\\\\end{jAnswer}\\rXX% \
exercise\\rXX\\rXXLike Theorem~\\\\ref{thm:glattice}, this \
Theorem~\\\\ref{thm:fundamentalcorresponding} is independent of the rise, and \
does not claim that the generating and opposed pair is unique for $d$. \
Figure~\\\\ref{fig:Txb0410GeneratingIntervals} gives examples of generating \
opposed intervals. %\\rXX\\rXX\\rXX%\\rXXAs Jean's name for it suggests, this \
Theorem has historically been given some prominence. One reason is the \
following special case when the parastichy numbers are adjacent Fibonacci \
numbers:\\rXX\\\\begin{theorem}\\rXX\\tLattice divergences which lead to \
Fibonacci structure are very close to the golden \
angle:\\rXX\\t\\\\begin{enumerate}\\rXX\\\\item\\rXX\\tIf $F_j$ and $F_{j+1}$ \
are successive Fibonacci numbers larger than 1 then the interval on which $\\\
\\gpbug{{\\\\textsf F}_j,{\\\\textsf F}_{j+1}}$ is both generating and \
opposed in $[0,\\\\jhalf]$  contains the point $1/\\\\tau^2$ and has a width \
\\rXX\\t which shrinks as fast as $\\\\tau^{-2j}$.\\rXX\\\\item \\rXXIf \
$F^k_m$ and $F^k_{m+1}$ are successive members of the sequence $F^k_0=1$, \
$F^k_1=k$, $F^k_{i+1}=F^k_i+F^k_{i-1}$ for integer $k>2$, then \\rXX\\tthe \
interval on which $\\\\gpbug{{\\\\textsf F}^k_m,{\\\\textsf F}^k_{m+1}}$ is \
generating and opposed in  $[0,\\\\jhalf]$ contains the point $\\\\tau/(1+k\\\
\\tau)$ and shrinks as fast as  \
$\\\\tau^{-2j}$.\\rXX\\\\end{enumerate}\\rXX\\\\end{theorem}\\rXX\\\\begin{\
proof}\\rXX\\tWe have from section~\\\\ref{sec:euclidean} that $F^{k}_j \
F_j-F^{k}_{j+1}F_{j-1}=(-1)^{j-1}$, so that we can set $m=F^{k}_j$, \
$n=F^{k}_{j+1}$, $u=F_{j-1}$, $v=F_{j}$ and have $mv-un=(-1)^{j-1}$ and \
$0<v<n$, and $0<u<m$. \\rXX\\tSo the interval $G=[u/m,v/n]$ of the theorem is \
$[F_{j-1}/F^k_{j},F_j/F^k_{j+1}]$.\\rXX\\tMoreover it has width \
$1/F^k_jF^{k}_{j+1}$ which is of order $\\\\tau^{-2j}$.\\rXX\\tFor $k>2$ the \
interval is already in $[0,\\\\jhalf]$; for the Fibonacci numbers, with \
$k=1$, $u/m$ and $v/n$ are both larger than a half and the interval $G$ is \
close to $1/(1+\\\\tau)$ so its mirror \\rXX\\t interval in $[0,\\\\jhalf]$ \
is  \\rXX\\t$1-G$ containing $1/\\\\tau^2$. \
\\rXX\\\\end{proof}\\rXX\\\\begin{jExercise}\\\\label{ex:pdiv}\\rXX\\tCompute \
the divergence interval in $[0,\\\\jhalf]$ on which  $\\\\gp{55,89}$ is a \
generating opposed \
pair.\\rXX\\\\end{jExercise}\\rXX\\\\begin{jAnswer}{ex:pdiv}\\rXX\\tWe set \
$m=55=F_j$ and $89=n=F_j$ with $j=10$, and use $u=F_9=34$, $v=F_{10}=55$ to \
give $mv-nu=(-1)^{11}$ as expected.\\rXX\\tThe interval in $[0,\\\\jhalf]$ is \
$1-(34/55,55/89)= 1/\\\\tau^2+ [-0.00014\\\\ldots, \
0.0005\\\\ldots]$.\\rXX\\tThus the divergence angle of such a lattice must be \
within less than 2 parts in a thousand of the golden angle. \
\\rXX\\\\end{jAnswer}\\rXX\\rXXSo we can apparently deduce from the fact of \
55 and 89 parastichies in Figure~\\\\ref{fig:Txb0102Sunflower91} that the \
arrangement of successive florets in the sunflower head is at an angle very \
close to the golden angle $\\\\Phi$. However recall from \
Exercise~\\\\ref{ex:fibex} that this also follows from the fact that the \
Fibonacci parastichy pair is generating: observing that it is opposed merely \
tightens the interval around $\\\\Phi$. But more fundamentally we also need \
to assume, incorrectly, that the seeds are indeed arranged in a lattice in \
the first place: a more accurate description of the Theorem is that it says \
what the divergence must be \\\\textit{if} the arrangement was a lattice. \
\\rXX\\rXX\\\\section{Principal \
parastichies}\\rXX\\rXX\\\\label{sec:ppair}\\rXXOne lattice can have many \
generating, or generating and opposed, parastichy\\\\index{parastichy}{} \
pairs.  We want to pick a principal pair that preserves the idea of being the \
`most obvious' to the eye. \\rXXOne strong idea of obviousness comes from \
returning to the motivating example of the sunflower head. In practice each \
seed is typically in direct contact with four others and shaped into a \
corresponding diamond. It is these seeds which are directly adjacent which \
define, to the eye, the spirals. \\rXXIn the language of our mathematical \
lattice it is the parastichies through the points nearest to the origin.\\rXX\
\\\\begin{definition}\\rXX\\tThe principal vector (or first principal vector, \
or principal parastichy) of the lattice is the parastichy vector of \
non-negative rise which is shortest. Ties will be common, and if we must we \
choose the vector with the largest $x$ component.\\rXX\\tIf the first \
principal vector is $\\\\mvec$ then the first parastichy number is $m$.  The \
second principal vector  is the shortest lattice vector which is not \
co-linear with the principal vector. The $n$-th principal vector is the \
$n$-th  shortest lattice vector not co-linear with the first to ($n-1$)-th \
principal-vectors.%\\rXX\\t\\rXX\\\\end{definition}\\rXXThe first principal \
vector has to be a parastichy vector, and the second principal vector will \
normally be a parastichy vector or sometimes a complementary \
vector.\\rXX\\\\begin{definition}\\rXX\\tAn  $\\\\pp{m,n}$ lattice is a \
lattice $\\\\mathcal{L}(h,d)$ in which the first and second principal vectors \
have parastichy numbers $m$ and $n$ respectively. \
\\rXX\\\\end{definition}\\rXXSimilarly a  $\\\\pp{m,n,t}$ lattice is a \
lattice  in which the first  second  and third parastichy numbers are $m$, \
$n$ and $t$. If the first and second principal  vectors are equal in length \
we alternatively describe the lattice as an $\\\\pp{m=n,t}$ \
lattice.\\rXXPrincipal pairs are always generating pairs and a proof of this \
will become apparent after we have seen how to construct principal pairs. \
\\rXX\\rXXWhether a parastichy vector is a principal one is an $h$-dependent \
property, unlike the properties of being opposed or generating which are \
$h$-independent. At any fixed $d$, for $h$ large enough, the principal vector \
is always $\\\\pvec{0}$; if $d=1/\\\\tau^2$, for example, we will see  how \
the principal parastichy number increases through the Fibonacci numbers as \
$h$ decreases. We will see below that lattices with ties in length between \
principal parastichy vectors, though non-generic, are particularly important \
in organising the classification, and that hexagonal lattices where the first \
three parastichy vectors are equal in length play a crucial role. \
\\rXXFigure~\\\\ref{fig:Txb0411LatticesSpecialD} shows principal parastichy \
pairs for the special case of  $d=0$ and distichous patterns $d=\\\\jhalf$.  \
\\rXX\\\\mmafig{Txb0411LatticesSpecialD}{Lattices, and principal \
parastichies, in the special cases $d=0$  and distichous patterns \
$d=\\\\jhalf$, and varying $h$. A circle equal in diameter to the shortest \
principal parastichy vector is drawn around each point.\\rXXRed lines \
correspond to the principal parastichy, and blue lines to the parastichy \
which has the next strictly shorter parastichy \
vector.}{1}\\rXX%\\rXX\\\\section{Spiral \
lattices}\\rXX\\\\label{sec:spiral}\\rXX\\rXXBefore we go on to the main \
result we can look at a special case which is algebraically simple, although \
not applicable to large Fibonacci number phyllotaxis. This is the \
\\\\emph{spiral lattice} which by definition is a lattice \
$\\\\mathcal{L}(d<\\\\jfrac{1}{4},h)$ as in the examples in \
Figure~\\\\ref{fig:Txb0412Spiral}. These are lattices in which\\rXXthe \
genetic spiral or 1-parastichy visually dominates, and in which the idea of a \
principal pair is not the most observationally important. \
\\rXX%\\rXXNevertheless spiral lattices are the first initial cases that will \
begin\\rXXour Fibonacci framework, and calculating principal pairs directly \
for such lattices can help explain the marginal structure of the diagrams in \
the following \
Chapter.\\rXX\\\\begin{jExercise}\\\\label{ex:pspiral}\\rXX\\tFix  \
$d<\\\\jfrac{1}{4}$ and set  $k=\\\\lfloor1/2d\\\\rfloor-1$.\\rXX\\tShow that \
as $h$ decreases, the principal parastichy pair of the lattice \
$\\\\mathcal{L}(d,h)$ begins as \\rXX\\t $\\\\pp{0,1}$ and then passes \
through $\\\\pp{1,0}$,  $\\\\pphat{1}{1}$,\\rXX\\t  \
$\\\\pphat{1}{2}$,\\\\ldots ,  $\\\\pphat{1}{k}$, until reaching \
$\\\\pp{1,k+1}$ and that  both principal vectors are parastichy vectors for \
all $h$ values smaller than this. \\rXX\\t \\rXX\\\\end{jExercise} \
\\rXX\\\\begin{jAnswer}{ex:pspiral}\\rXXFor $h$ large enough, \\tthe shortest \
vector in the lattice is  $\\\\pvec{0}=(1,0)$ \\rXXof length 1, and the \
second shortest is  $\\\\pvec{1}=(h,d)$ of length $h^2+d^2$.\\rXXThese change \
relative magnitude when $h^2+d^2=1$ giving us a $(1,0)$ lattice.\\rXXAs $h$ \
decreases further, there is a point when  $\\\\phatvec{1}=(h,d-1)$ is of \
equal length to $\\\\pvec{0}$: this is when $h^2+d^2=2d$. These give the \
boundaries between the $(0,1)$, $(1,0)$ and $(1,\\\\hat 1)$ regions in \
Figure~\\\\ref{fig:Txb0501VanItersonMain}. \\rXX\\rXXAs $h$ continues to \
decrease, but as long as $\\\\pvec{1}$ remains the shortest vector in the \
lattice, the second shortest\\rXXmust be on the adjacent 1-parastichy to the \
origin. Given the definition of $k=\\\\lfloor1/2d\\\\rfloor-1\\\\geq 1$, \
$1/2(k+1)<d\\\\leq 1/2k$,  and then $\\\\pvec{2},\\\\ldots,\\\\pvec{k}$ are \
co-linear with $\\\\pvec{1}$ on the origin parastichy, so they are not the \
second shortest principal vector. On the adjacent 1-parastichy, though, we \
can set $\\\\rpvec{n}=  (nd-1,n h)$, and we have \
$\\\\phatvec{n}=\\\\rpvec{n}=\\\\pvec{n}-\\\\pvec{0}$ for $-k\\\\leq n\\\\leq \
k$ and $\\\\pvec{n}=\\\\rpvec{n}$ for $k+1\\\\leq n\\\\leq 2k+1$. Then the \
second principal vector is one of these $\\\\rpvec{}$s and specifically it is \
the one closest to $\\\\mathbf{n}$: the vector which normal to the origin \
1-parastichy from the origin to the adjacent 1-parastichy: see \
Figure~\\\\ref{fig:Txb0412Spiral}.\\rXX %\\rXX\\\\mmafig{Txb0412Spiral}{First \
(red) and second (blue) parastichies in a lattice with $d=7/72$ and (left to \
right) $h$ equal to 0.4, 0.115, 0.08. The corresponding principal parastichy \
pairs are $(1,\\\\hat 1)$, $(1,\\\\hat 3)$,\\rXXand $(1,6)$.  The normal to \
the 1-parastichy is shown as a thin line. For large enough $h$, as in the \
first two cases, one of the principal vectors is a complementary vector. \
}{1.0}\\rXX%\\rXX\\rXXWe have $\\\\pvec{1}=(d,h)$; so $\\\\mathbf{n}$  has \
slope $-d/h$. Since   $\\\\mathbf{n}$ and $\\\\pvec{1}$\\rXXmust form a \
rectangle of area $h$, we can find the length of  $\\\\mathbf{n}$ and \
discover  $\\\\mathbf{n} = \\\\nu (-h^2 /d,h)$\\rXXwhere \\rXX$\\rXX\\t\\\\nu \
= \\rXX\\t%\\\\frac\\rXX\\t{d}/{(h^2+d^2)}\\rXX$\\rXXSince the rise of \
$\\\\mathbf{n}$ is $h\\\\nu$, it passes through one of the $r_n$ every time $\
\\\\nu$ passes through an integer,\\rXXand the closest  $\\\\mathbf{r}_n$ has \
$n=[\\\\nu]$, so that the second principal vector changes from $\\\\rpvec{n}$ \
to \\rXX$\\\\rpvec{n+1}$  when $\\\\nu=n+\\\\jhalf$ which can be rewritten as \
\\rXX\\\\begin{equation}\\rXX{h^2+\\\\left(d-\\\\frac{1}{2n+1}\\\\right)^2}=  \
\\\\frac{1}{(2n+1)^2}\\rXX\\\\end{equation}\\rXXNote that for the initial \
case $n=0$ we recover $h^2+d^2=2d$ as the $0=\\\\hat{1}$ boundary where a \
$(1,0)$ lattice became a $(1,\\\\hat 1)$ lattice. For each of \
$n=1,\\\\ldots,k$ this gives the point at which a  $(1,\\\\hat n)$ becomes a  \
$(1,\\\\widehat {n+1})$ lattice, and then for $n=k+1$ the lattice transitions \
from a  $(1,\\\\hat {k})$ to a $(1, {k+1})$ lattice.  From this point on the \
principal pair are both parastichy vectors, though at some yet smaller $h$.  \
$\\\\pvec{1}$ will cease to be the principal vector and we are back in the \
full complexity of Figure~\\\\ref{fig:Txb0501VanItersonMain}.\\rXX\\rXXThe \
region of lattice space in which lattices are of the form $(1,\\\\hat{n})$ \
are shown in \
Figure~\\\\ref{fig:Txb0413SpiralExample}.\\rXX\\\\mmafig{Txb0413SpiralExample}\
{Structure of lattices space near $(d,h)=(0,0)$ where lattices are spiral \
lattices. Shaded in light and dark yellow are regions where the principal \
parastichy pair are $(1,\\\\hat{n})$ for $n=1$ to $n=7$.  At each the \
light-dark boundary the lattice is square, as will be shown in the next \
chapter. The principal pair transitions from $(1,\\\\hat{n})$ to  $(1,{n})$ \
at the vertical line $d=\\\\jfrac{1}{2n}$. \
}{.5}\\rXX\\rXX\\\\end{jAnswer}\\rXX \\rXX\\rXX\\\\section{Turing-Euclid \
reduction of generating pairs}\\rXX\\\\label{sec:TEreduction}\\rXXThe \
examples of the previous section explicitly computed the principal vector \
pairs for the special case of spiral lattices, and now we turn to calculating \
them in \\rXXgeneral. \\rXXThe principal vectors can often be found by eye \
--- indeed that is the point of them --- and certainly always by an \
exhaustive search of what is only a finite number of possibilities, since \
they must be at least as short as $\\\\pvec{0}$ and $\\\\pvec{1}$, which \
bounds the possible rise.\\rXXBut they can also be found by a reduction \
process from any vectors which generate the lattice. One reason to do this is \
in the proof of Turing's Theorem below. Moreover this reduction process is a \
version of the Euclidean algorithm, which begins to explain the connection \
between the continued fraction of the divergence and the principal pairs of \
the lattice that we will see in subsequent chapters. \
\\rXX\\\\todo{xxx}\\rXXWe gave a standard version of the Euclidean algorithm \
back in section~\\\\eqref{sec:euclidean} as a series of successive reductions \
of pairs of integers, and it can be generalised to vectors as long as we \
choose a norm for those vectors. Another way of viewing the first half of \
this chapter and Theorem~\\\\ref{thm:glattice} in particular is that \\rXXif \
we define the size of a lattice vector as its rise, then application of the \
Euclidean algorithm to successively reduce the size of pairs of generating  \
vectors $\\\\mvec$ and $\\\\nvec$  terminates with a pair that have the very \
smallest rises, ie $\\\\pvec{0}$ and $\\\\pvec{1}$. If instead we define the \
size of a lattice vector as its length, then the same Euclidean algorithm \
terminates not at the vectors with shortest rise, but the vectors with \
shortest length: the principal vectors. One step of the algorithm is \
illustrated in Figure~\\\\ref{fig:Txb0414Reduction}.\\rXX \
\\\\mmafig{Txb0414Reduction}{A pair of generating vectors reduced by a step \
of the Euclidean algorithm. $\\\\pvec{4}=\\\\pvec{14}-2\\\\pvec{5}$\\rXX\\tis \
the shortest of all vectors of the form  $\\\\pvec{14}-q\\\\pvec{5}$ and by \
construction it must be \\rXX\\tshorter than $\\\\pvec{5}$; the pair \
$\\\\gp{5,14}$ has been reduced to the pair \
$\\\\gp{4,5}$.}{1.0}\\rXX\\rXX\\rXXSpecifically, Turing-Euclid reduction \
starts with \\rXX$i=0$ and two vectors $\\\\mathbf{a}$ and $\\\\mathbf{b}$ \
that generate the lattice, and ordered so that\\rXX$|a|>|b|$. Set \
$\\\\rpvec{-1}=\\\\mathbf{a}$ and $\\\\rpvec{0}=\\\\mathbf{b}$ and \
then\\rXX\\\\begin{enumerate}\\rXX\\t\\\\item Choose $q_i$ to be the integer \
that minimises  $|\\\\rpvec{i-1}-q_i\\\\rpvec{i}|$. If there is a tie, choose \
the $q$ closest to zero. \\rXX\\t\\\\item If $q_i=0$, then set $N=i$ and \
terminate.\\t\\rXX\\t\\\\item Otherwise set  \
$\\\\rpvec{i+1}=\\\\rpvec{i-1}-q_i\\\\rpvec{i}$. Increment $i$ and return to \
step 1.\\rXX\\\\end{enumerate}\\rXXAs before $|\\\\rpvec{i}|$ is strictly \
decreasing over a finite set of vectors shorter than $\\\\mathbf{a}$ so the \
algorithm terminates with an $\\\\fvec$ and $\\\\svec$ satisfying \
\\rXX\\\\begin{align}\\rXX\\t\\\\label{eq:EuclidFS}\\rXX\\t|\\\\fvec|&\\\\leq|\
\\\\svec| \\\\leq |\\\\svec-q\\\\fvec| \\\\mbox{ for any integer $q$}.\\rXX\\\
\\end{align}\\rXX\\rXX\\\\begin{jExercise}\\\\label{ex:pte}\\rXX\\tIn the \
lattice $h=1/100$, $d=17/72$, find an example where Turing-Euclidean \
reduction  requires more than two steps to \
terminate.\\rXX\\\\end{jExercise}\\rXX\\\\begin{jAnswer}{ex:pte}\\rXX\\tThe \
pair $\\\\gp{73,103}$ is successively reduced to $\\\\gp{30,73}$, \
$\\\\gp{13,30}$, and terminates at $\\\\gp{4,13}$ which  is the principal \
pair for the lattice. \\rXX\\\\end{jAnswer}\\rXX\\rXXTuring-Euclid reduction \
certainly terminates with a pair of vectors no longer than the pair that it \
started with. To show that it actually terminates at the shortest pair of \
vectors in the lattice we will use\\rXX\\\\begin{theorem}\\rXX\\tIf \
$\\\\fvec$ and $\\\\svec$ are a pair of vectors with positive rise that \
generate the lattice and satisfy~\\\\eqref{eq:EuclidFS} then they are the \
first and second principal vectors and the third principal vector has the \
form $\\\\pm\\\\fvec\\\\pm\\\\svec$. \
\\rXX\\t\\\\label{thm:third}\\rXX\\\\end{theorem}\\rXX\\rXX\\\\begin{proof}\\\
rXX\\tFirst note that~\\\\eqref{eq:EuclidFS} with $q=1$ shows $|\\\\svec|^2<|\
\\\\svec-\\\\fvec|^2= |\\\\svec|^2- 2 |\\\\fvec.\\\\svec|+|\\\\fvec|^2$ and \
so $|\\\\fvec.\\\\svec|<\\\\jhalf |\\\\fvec|^2$. \\rXX\\t\\rXX\\tSet \
$\\\\Delta$ to be the sign of $\\\\fvec.\\\\svec$, and let \
$\\\\tvec=\\\\svec-\\\\Delta \\\\fvec$.\\t\\rXXWe will show that no other \
lattice vectors,  not co-linear with $\\\\fvec$ or $\\\\svec$, are shorter \
than $\\\\tvec$. Since $\\\\fvec$ and $\\\\svec$ are generating, we can write \
any other vector as \\rXX$\\\\mathbf{x}(q,r)=q\\\\svec- r\\\\Delta \\\\fvec$ \
for nonzero integer $q,r$, where we have used $\\\\Delta=\\\\pm 1$. We can \
show that $\\\\mathbf{x}(q,-r)$ is longer than $\\\\mathbf{x}(q,r)$ by \
using\\rXX\\\\begin{align}\\rXX\\t|\\\\mathbf{x}(q,-r)|^2-|\\\\mathbf{x}(q,r)|\
^2=4 qr | \
\\\\fvec.\\\\svec|,\\rXX\\t\\\\label{eq:pdir}\\rXX\\\\end{align}\\rXXso we \
need only check $r>0$. \\rXXSetting $q=1$ in equation~\\\\ref{eq:pdir} we \
have in particular \
that\\rXX$|\\\\tvec|=|\\\\svec-\\\\Delta\\\\fvec|<|\\\\svec+\\\\Delta\\\\fvec|\
$.\\rXXWe calculate \
\\rXX\\\\begin{align*}\\rXX\\t|\\\\mathbf{x}(q,r)|^2-|\\\\tvec|^2 & = \
(q^2-1)|\\\\svec|^2 -2 \\\\Delta (qr-1) (\\\\fvec.\\\\svec)+ \
(r^2-1)|\\\\fvec|^2 \\rXX\\t\\\\shortintertext{and using \
$|\\\\fvec|<|\\\\svec|$ and $2\\\\Delta \
\\\\fvec.\\\\svec=2|\\\\fvec.\\\\svec|<|\\\\fvec|^2$}\\rXX\\t|\\\\mathbf{x}(q,\
r)|^2-|\\\\tvec|^2& \\\\geq  \\\\left(q^2-1 - (qr-1)+ \
r^2-1\\\\right)|\\\\fvec|^2 \\rXX\\t\\\\\\\\ \\rXX\\t&=   (q^2-qr+r^2-1) \
|\\\\fvec|^2 = ((q-r)^2+qr-1) |\\\\fvec|^2 \\rXX\\\\end{align*}\\rXXand the \
final bracket is nonnegative since $q,r \\\\geq 1$. \\rXXThis shows that \
$\\\\fvec$ and $\\\\svec$ in order are the first two principal vectors and \
that the third is $\\\\svec-\\\\fvec$ if $\\\\fvec.\\\\svec>0$ \
and\\rXX$\\\\svec-\\\\fvec$ otherwise. \\rXX\\\\end{proof}\\rXXThe algebra of \
the proof could be simplified by first rotating and scaling the lattice so \
that $\\\\fvec$ is horizontal and of length 1: this is  the renormalisation \
transform we will encounter in the next Chapter. \\rXX\\rXXBecause the first \
and second parastichy vectors $\\\\fvec$ and $\\\\svec$ are of the forms \
$\\\\mvec$ and $\\\\nvec$, with parastichy numbers $m$ and $n$, a simpler \
restatement of this result is Turing's theorem \
:\\rXX\\\\begin{theorem}\\rXX\\t\\\\label{thm:Turing}\\rXX\\tThe third \
parastichy number is the sum or difference of the first \
two.%\\rXX\\t\\\\end{theorem}\\rXXSee \
Figure~\\\\ref{fig:Txb0415SumDifference}.\\tThis form of the Theorem neglects \
the hats, so requires us to interpret $1+\\\\hat{1}$ as $2$ or $\\\\hat{2}$ \
as necessary. We will see in the next Chapter how Turing sought to use this \
theorem as part of his explanation of Fibonacci \
structure.\\rXX\\\\mmafig{Txb0415SumDifference}{Turing's theorem: the third \
parastichy vector in a lattice is always the sum or difference of the first \
two.}{1.0}\\rXX\\rXX\\rXX\\rXX\\rXX\\\\section{Orthostichies}\\rXXWith the \
notation in place we can observe a consequence of having golden angle \
lattices. An \\\\textit{orthostichy} is a parastichy\\\\index{parastichy}{} \
vector of nonnegative rise which is closer to the vertical than any other \
parastichy vector of lower nonnegative rise.%\\rXX\\\\jNote{Historically, \
orthostichy has also been used to mean a strictly vertical parastichy.} Thus \
there are is a sequence of orthostichies,  starting with $\\\\pvec{0}$ and \
$\\\\pvec{1}$, of increasing rise. If the divergence of the lattice is a \
rational $d=p/q$ in its lowest terms then the final orthostichy is \
$\\\\pvec{q}$; if $d$ is irrational then the sequence of orthostichies is \
infinite, and tends to the vertical. The parastichy number of each \
orthostichy corresponds to the denominator of an increasingly accurate series \
of rational approximations to the divergence. Provided the rise is small \
enough (and excluding spiral lattices), the principal parastichy pair of the \
lattice will be two successive orthostichies,\\rXXand as the rise continues \
to decrease the principal parastichy counts will move up the sequence of \
these denominators. Thus the principal parastichy numbers could be made to be \
successive and arbitrarily large Fibonacci numbers down to an arbitrary small \
$h$ by setting the divergence sufficiently close to the golden angle, as in \
Figure~\\\\ref{fig:Txb0416FibLattices}.\\rXX\\rXX\\\\mmafig{\
Txb0416FibLattices}{Increasing Fibonacci pairs in a golden angle lattice as \
the rise is reduced}\\rXX{1.0}\\rXX\\rXXThe Standard Picture models have the \
divergence as an outcome, not an input. So under the Standard Picture, this \
observation explains why, if we see some Fibonacci structure, we see a lot, \
not why we see it in the first place. \
\\rXX\\rXX\\rXX\\rXX\\\\section{Touching-circle and hexagonal \
lattices}\\rXX\\\\label{sec:hexdef}\\rXXEquipped with the ability to find the \
shortest vectors in a lattice we can now classify lattice types, as in \
Figure~\\\\ref{fig:Txb0417LatticeTypes}.\\rXX\\\\mmafig{Txb0417LatticeTypes}{\
Different types of lattice. \\\\gp{2,5}: a lattice with principal vector \
$\\\\pvec{2}$ and second principal $\\\\pvec{5}$;  \\\\gp{2=5,3}: a \
touching-circle lattice with a tie for the two shortest vectors, which in \
this case are non-opposed; \\\\gp{2=5,7} a touching-circle lattice which is \
opposed; and \\\\gp{2=5=7}, a hexagonal \
lattice.}{1.0}\\rXX\\rXX\\\\begin{definition}\\rXX\\tA hexagonal lattice is a \
lattice where the first three parastichy vectors are all the same length. \
\\rXX\\\\end{definition}\\rXX\\\\begin{jExercise}\\\\label{ex:hexhex}\\rXX\\\
tShow that every hexagonal lattice is \
hexagonal.\\rXX\\\\end{jExercise}\\rXX\\\\begin{jAnswer}{ex:hexhex}\\rXX\\tIf \
the angle between any two parastichy vectors was not 60$^\\\\circ$, then the \
third of the vectors, which must be their sum or difference, would not be the \
third side of an equilateral triangle and would not also have the same \
length.\\rXX\\\\end{jAnswer}\\rXXLess fundamental, but sometimes of use to \
identify, are square lattices:\\rXX\\\\begin{definition}\\rXX\\tAn square \
lattice has the first and second parastichy vectors the same length and at \
right angles. \\rXX\\\\end{definition}\\rXXSquare and hexagonal lattices are \
special cases of van Iterson lattices:\\rXX\\\\begin{definition}\\rXX\\tA van \
Iterson, or touching circle, lattice, is one in which the first and second \
parastichy vectors have the same length.\\rXX\\\\end{definition}\\rXX\\rXXThe \
van Iterson connection will appear in the next chapter; the reason for the \
name `touching circle' is that disks of diameter equal to the first principal \
parastichy vector can be placed at each point of a van Iterson lattice \
without overlapping, and will touch at a point halfway along that vector. \
\\rXX\\rXX\\rXXFigure~\\\\ref{fig:Txb0418LowOrder} shows a number of touching \
circle lattices, especially showing examples of square and hexagonal \
lattices. \\rXX\\\\mmafig{Txb0418LowOrder}{Some touching circle lattices, \
labelled by the principal vectors. Red lines correspond to the shortest \
vectors in the lattice, including ties, and blue lines to one of the \
second-shortest vectors after ties. \\rXX\\tRedrawn from van \
Iterson~\\\\autocite{vanitersonjrMathematischeUndMikroscopischAnatomische1907}\
. }{1}\\rXX%\\rXXIn a square lattice the first two parastichy vectors \
$\\\\pvec{m}$ and $\\\\pvec{n}$ have the same length, and the third and \
fourth parastichies also share the length $\\\\sqrt{2}|\\\\pvec{m}|$; this is \
the boundary case when the third parastichy number changes between the sum \
and the difference of the first two. In a hexagonal lattice, the  first,  \
second and third principal  vectors all have the same length, and can be \
written as $\\\\pvec{m}$, $\\\\pvec{n}$, and $\\\\pvec{m+n}$ with $m<n$; this \
is the boundary case between changes of first and second principal parastichy \
numbers. \\rXXBy considering these boundary cases, we will be able to  infer \
how principal parastichy numbers change as we cross the boundaries.  \
\\rXX\\rXX\\rXX\\rXX\\\\section{Relation to \\\\textit{Phyllotaxis: a \
systemic study}.}\\rXXThe relationship between continued fractions and \
divergence angles was worked out in some detail by Bravais as early as \
1837~\\\\cite{bravaisEssaiDispositionFeuilles1837}. Bravais also developed \
versions of Theorem~\\\\ref{thm:glattice}, and especially the integer \
condition $| m v - n u|=1$ \
\\\\cite{bravaisSystemsFormedPoints1949}.\\rXX\\rXX \\rXXUseful contributions \
to the analysis of cylindrical lattices then came from many writers, most \
relevantly a series of papers in the 1970s by Adler. Details of these and \
many further references can be conveniently found in Jean's 1994 book \
\\\\textit{Phyllotaxis: a systemic study in plant \
morphogenesis}~\\\\cite{jeanPhyllotaxisSystemicStudy1994}.\\rXXThis section \
notes a few of the differences between Jean's book and the current one and \
can be skipped by most readers.\\rXXJean's book included an invaluable \
mathematical synthesis, predominantly but not exclusively of Adler's work, \
but perhaps as a consequence contains a handful of mathematical \
inconsistencies. It is a tribute to the centrality of Jean's textbook to the \
field that it is still worth untangling them; and while in general the \
problems are ones that do not apply to large-Fibonacci-number lattices, the \
viewpoint of the next chapter requires a robust foundation for simpler \
lattices too. \\rXX\\rXXAlthough I have preserved Jean's name for what is \
here Theorem~\\\\ref{thm:fundamentalcorresponding} as the `fundamental \
theorem of phyllotaxis', it is instead Turing's theorem, \
Theorem~\\\\ref{thm:Turing}, which is more fundamental from the bifurcation \
theory viewpoint of this book. This is because Turing's theorem allows \
patterns to be interpreted as the outcome of a dynamic, and modellable, \
biological process, while the `fundamental' theorem assumes the very \
existence of the emergent lattice which we are attempting to explain. \
\\rXX\\rXXOne notational difference from Jean is in the idea of the \
generating pair which Jean makes much of use of under the name of the \
`visible pair'. Jean gives a number of useful theorems about generating \
pairs: his A4.1 on p306, for example,  is in close correspondence with our \
Theorem~\\\\ref{thm:glattice}. These theorems are correct and consistent for \
most phyllotactic lattices but in my interpretation they fail in some \
edge-cases  alluded to in Exercise~\\\\ref{ex:ftpfail}. Specifically, they \
fail with the spiral lattices we introduced in \
Section~\\\\ref{sec:spiral}.\\rXX %\\rXXAs a counter-example to Jean's A4.2 \
(p307 of~\\\\cite{jeanPhyllotaxisSystemicStudy1994}), consider its statement \
for the particular case  $m=1$ and $n=2$. It becomes `the parastichy pair \
(1,2) is visible and opposed iff there exist unique integers $u$ and $v$ such \
that $0\\\\leq u<1$, $0\\\\leq v<2$, $|v-2u=1|$ and such that the divergence \
$d<\\\\jhalf$ lies at or is between $u$ and $v/2$'. Solving the constraints \
unambiguously gives $u=0$ and $v=1$, and gives a generating interval of \
$[0,1/2]$.  However the pair $\\\\pvec{1}$ and $\\\\pvec{2}$ are only \
generating on the interval $d\\\\in [1/4,1/2]$. \\rXX For any $d<1/4$ it is \
not true, at least in the language of this book, to say as  \\rXX Jean's A4.2 \
does that the parastichy pair  \\\\gp{1,2} is a generating pair (and also \
incorrectly, that the pair is opposed for all $0<d<\\\\jhalf$).  What has \
happened is that Adler's proof method actually leads to the pair \
\\\\gphat{1}{2}, ie the 1-parastichy vector and the 2-complementary vector, \
which \\\\textit{is} generating and opposed: see \
Figure~\\\\ref{fig:Txb0419JeanX}.\\rXX \\\\mmafig{Txb0419JeanX}{A \
counter-example to Jean's Proposition \
A4.2~\\\\autocite{jeanPhyllotaxisSystemicStudy1994}, with $m=1$, $n=2$, \
$d=7/72$ and $h=0.1$; this counter-example holds for all $h$ and \
$0<d<\\\\jfrac{1}{4}$. A4.2 asserts that the 1-parastichy and the \
2-parastichy form what Jean calls a visible pair and we call a generating \
pair. For spiral lattices, in the sense of Section~\\\\ref{sec:spiral}, \
Jean's A4.2 fails because the 2-parastichy is not visible: it is the pair \
\\\\gphat{1}{2} which is the generating pair. \
}{1}\\rXX\\rXX\\rXX\\rXX\\rXXAnother area where this text differs from Jean's \
synthesis is the \\\\emph{conspicuous pair} as a model of the most obvious \
spirals. Adler~\\\\cite{adlerModelContactPressure1974} defined a conspicuous \
visible opposed parastichy pair as identical to our principal parastichy pair \
(at least when opposed, and away from spiral lattices), and in \
1988~\\\\cite[p214]{jeanNumbertheoreticPropertiesTwodimensional1988} Jean \
followed this, but by 1994 he was differently defining the conspicuous pair \
as that closest to a right \
angle~\\\\cite[p18]{jeanPhyllotaxisSystemicStudy1994}.\\rXX\\rXXIn any case I \
prefer here to use the principal parastichy pair as the most natural model of \
`obvious'. \\rXXThe concept of the principal parastichy pair, central to this \
book, was first made explicit by \
Turing~\\\\autocite{turingMorphogenTheoryPhyllotaxis2013} in unpublished \
material in the early 1950s: Theorems~\\\\ref{thm:third} \
and~\\\\ref{thm:Turing} are based on his ideas. Turing's algorithm was \
eventually published in the 1990s as described \
in~\\\\cite{turingMorphogenTheoryPhyllotaxis2013}.  With the aid of \
hindsight, the theorem I have called here Turing's Theorem is implicit in \
Bravais' nineteenth century work. \\rXXThe independent Adler/Jean synthesis  \
makes use of `contractions' (eg A4.3 \
of~\\\\cite{jeanPhyllotaxisSystemicStudy1994}) which correspond to steps in \
the Turing-Euclid reduction, and implicitly uses reaching the principal  \
vectors as a stopping point.\\rXX\\rXXAdler was well aware of Turing's notes \
on phyllotaxis and cited them in his 1974 literature \
survey~\\\\cite{adlerModelContactPressure1974}. Adler's perspective was that \
the central mathematical problem was the relationship between the divergence \
and the set of possible generating pairs. It was from this perspective that \
he wrote that Turing had been `prevented' from using this `fundamental' \
concept because of Turing's focus on the principal parastichy pair, which is \
in fact more fundamental to the modern Standard Picture. For some reason, \
perhaps the very long delay in publishing Turing's notes, even this dismissal \
was removed from Jean's book, even though the notes had by then been \
published. As a consequence Jean's book contains no explicit equivalent of \
Turing's Theorem. \\rXX\\rXX \\rXX \\\\section{Multijugate \
lattices}\\rXX\\\\mmafig{Txb0420MultiJugate}{Left: A monojugate lattice with \
divergence $d=2/10$,  rise $h=1/10$, and $J=1$, which has principal \
parastichy numbers \\\\gp{1,4}. Right a bijugate lattice with $J=2$, \
divergence $d/J$, rise $h/J$,  whose principal parastichy numbers are \
\\\\gp{2,8}.}\\rXX{1.0}\\rXX The \\\\textit{jugacy} of a cylindrical lattice \
is the number of points in the lattice at each rise. The assumption at the \
beginning of this chapter that of nozero rise per node ensured that we  have \
so far only seen  monojugate lattices: those with a jugacy $J=1$. More \
generally, a multijugate lattice $\\\\mathcal{L}(d,h,J)$ can be defined as \
the set of points \\rXX $ (kd+ l/J - [kd+ l/J],kh)$ with $ k\\\\in\\\\jZ$ and \
$l\\\\in  0,\\\\ldots,J$,\\rXX and can be constructed by placing $J$ copies \
of the primary cylinder next to each other and then reducing the divergence \
by a factor of $J$ so the multijugate lattice is still on a cylinder of \
circumference 1: see Figure~\\\\ref{fig:Txb0420MultiJugate}. If we then also \
reduce the rise by a factor of $J$ we will produce a lattice in which the \
parastichy vectors have the same proportions  as in the original. Instead of \
numbering the points $0$, $1$, \\\\ldots, at each succesive rise, we can \
number them around the cylinder first and then increase with the rise. \\rXX \
With this natural numbering of points in the multijugate lattice, the points \
numbered $0$ and $k$ in the monojugate lattice become the points $0$ and \
$kJ$, so the principal parastichy numbers of a the lattice \
$\\\\mathcal{L}(d/J,h/J,J)$ are $J$ times the principal parastichy numbers of \
$\\\\mathcal{L}(d,h,1)$. \\rXX %\\rXX \\rXX% %\\rXX% \\rXX% If needed, the \
apparatus of hats and complementary vectors goes over to multijugate \
lattices, so that for instance the bijugate version of a \\\\gphat{1}{1} \
lattice is a \\\\gphat{2}{2} lattice as in \
Figure~\\\\ref{fig:Txb0421JugacyHat}. \\rXX% \\\\mmafig{Txb0421JugacyHat}{The \
multijugate version of lattices with complementary vectors as principal \
vectors have the same property, although perhaps easier to visualise. Left: A \
monojugate lattice with divergence $d=0.245$,  rise $h=0.45$, and $J=1$, with \
 principal parastichy numbers are \\\\gphatnothat{1}{1}{0}. Right the \
corresponding bijugate lattice with  $J=2$, divergence $d/J$, rise $h/J$,  \
whose principal parastichy numbers are \\\\gphatnothat{2}{2}{0}}{1.0}\\rXX \\\
\\section{Dropping the hats}\\rXX Complementary vectors and the hat notation \
have done their job now in allowing precision in  the Theorems of this \
Chapter when applied to spiral lattices and we can drop them from now on, \
with the understanding that any future description of a \\\\gp{m,m} \
parastichy pair is referring to what this chapter called a \\\\gphat{m}{m} \
pair. In particular we can  without ambiguity now talk of the lattice with \
divergence $d=1/2$ as having a \\\\gp{1,1}  parastichy pair corresponding to \
the two lines from the origin to ${1/2,h}$ winding in opposite directions \
around the cylinder. \\rXX\\rXX\\\\section{Summary of parastichies}\\rXXWe \
have classified parastichy pairs in lattices. Most simply we classified them  \
by whether they are opposed, that is wind in opposite directions. That simple \
classification is less useful than knowing whether they are generating, that \
is capable of describing the whole lattice, and we saw that a simple visual \
check for this was whether the triangle they defined contained any other \
lattice points. Each lattice has many generating pairs but typically only one \
of them is the shortest pair. \\rXX\\rXXWe called this shortest pair the \
principal parastichy pair and argued that this a good model for the spiral \
counts typically done when examining specimens. This principal parastichy \
pair depends on the rise: lattices with the same $d$ and different $h$ will \
have exactly the same generating pairs but which of those is the principal \
pair will vary with $h$. Crucially, we observed Turing's Theorem: geometrical \
constraints mean that the third principal parastichy number is always the sum \
or difference of the first two. \\rXX\\rXX\"\>"], "Output",
 CellLabel->"Out[93]=",ExpressionUUID->"2bed8bf2-6bb3-c041-908b-4b6ea9bfb3a4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["string"], "Input",
 CellLabel->"In[85]:=",ExpressionUUID->"d83b09fe-fc58-ac4a-83aa-df4ee7acb363"],

Cell[BoxData["\<\"\\r\\n\\r\\n\\\\chapter{The geometry of cylindrical \
lattices}\\r\\n\\\\label{ch:cylinder}\\r\\n\\\\abstract{\\r\\nThe goal of \
this chapter is to characterise the shortest vectors in a cylindrical \
lattice. This will allow us, in the next Chapter, to classify lattices by \
their shortest vectors in a way that has biological relevance. Cylindrical \
lattices have a natural representation as `unrolled' plane lattices in which \
the cylinder circumference corresponds to a  vector of the plane lattice \
encoding the periodicity; the height of a point in the cylindrical lattice is \
the component perpendicular to the periodicity vector. Any vector in the \
lattice has a parastichy number corresponding to the size of this component \
in units of node height. \\r\\nThe principal \
parastichy\\\\index{parastichy}{} vectors are the two shortest vectors in the \
plane lattice. We show how the the cylindrical spirals formed by these \
vectors -- and the two corresponding parastichy\\\\index{parastichy}{} \
numbers --  provide a natural model for  biological observations of spiral \
counts. In order to compute these parastichy numbers in a given lattice we \
will consider generating pairs of vectors as the building blocks of the \
lattice, and carry out the main analysis of this chapter: how to deduce from \
the generating pairs what the lattice parameters are and, especially, what \
the shortest vectors in the lattice are. The central and suggestive result of \
this Chapter is Turing's theorem: that the third-shortest vector in a lattice \
has a parastichy number which is the sum or difference of \
th\\r\\n}\\r\\n\\r\\n\\\\section{Botanical lattices}\\r\\nBefore we study \
lattices, it is worth exploring their biological relevance for phyllotaxis. \
Leaf arrangements have long been the subject of botanical study. \
Figure~\\\\ref{fig:Txb0401LeafTypes} shows a typical, and typically \
idealised, classification. We will call the number of leaves $J$ at each stem \
height where they occur the \\\\textit{jugacy}. The first and second patterns \
are our primary interest in this chapter: they are \\\\textit{monojugate} \
with a fixed angle between each leaf; in the special case of the alternate \
distichous arrangement the angle is 180\\\\degree.\\r\\nBy contrast the last \
three patterns in Figure~\\\\ref{fig:Txb0401LeafTypes} are multijugate; the \
case when $J>2$ is botanically called a \\\\textit{whorled} \
phyllotaxis.\\r\\n  \\r\\n\\\\mmafig{Txb0401LeafTypes}{Five different types \
of leaf arrangements on stems, with  jugacy $J$, a classification by \
principal parastichy numbers which will be developed in this chapter, and a \
reprsentation as a lattice on a cylinder, with a point at one height joined \
to the two nearest points at the next height.}{1}\\r\\n\\r\\nThese patterns \
can be idealised into a family of points on a cylinder, each rotated by a \
fixed fraction of the circle or \\\\emph{divergence} $d$ from the next and \
shifted vertically by the \\\\emph{rise}. \\r\\nIn the spiral example, the \
third leaf is roughly vertically above the first one, and the fifth leaf even \
more so. \\r\\nIf there was always a $p$-th leaf directly above the first, \
after having gone round the stem $q$ times, then all divergences would be \
rational fractions $p/q$  and this would provide a system of classification \
of leaf patterns. At its simplest this would come from identifying which is \
the leaf `directly' above the first (defining a vertical line called the \
\\\\emph{orthostichy}), but this is in many cases impractical or \\r\\nprone \
to disagreement. An alternative would be to estimate the divergence, which \
has the attraction that it can be estimated locally from nearby leaf \
positions and can be averaged over many observations, and \\r\\nthen \
approximating it by a rational fraction. Of course one divergence can be \
approximated by many different rational fractions so the choice of \
approximation is another potential source of dispute.\\r\\nNevertheless, this \
classification method is a natural one which works well for small \
denominators,  when the orthostichy leaf is not too far away, and was in \
successful and widespread throughout the nineteenth century and beyond. But \
as well as its conceptual shortcomings, it becomes practically inadequate for \
more complex patterns. Accordingly we will turn to a more modern idea of \
characterising lattice patterns by their \
parastichies.\\r\\n\\\\jpgfig{F0402BravaisFig2}{Bravais and Bravais's 1837 \
idealisation of the pine cone as a lattice on a \
cylinder~\\\\cite[p79]{bravaisEssaiDispositionFeuilles1837}. \\r\\n\\t}{1}\\r\
\\n\\\\todo{Expand bravais section}\\r\\n\\r\\nThese leaf-on-stem examples \
are naturally modelled in cylindrical coordinates on a vertical cylinder of \
fixed radius, but other examples, notably the arrangement of seeds on the \
sunflower head, suggest models which take place in polar coordinates on a \
disk. There are simple mathematical maps between the two geometries, and we \
will see later that these maps do correspond to an underlying biological \
similarity.% Chapter~\\\\ref{ch:transformations} gives more details of these \
mathematical mappings.  \\r\\n\\r\\n\\r\\n\\r\\n\\\\section{Cylindrical and \
plane lattices}\\\\label{sec:latticedef}\\r\\nCylindrical lattices can be \
thought of as lattices in the plane with a particular distinguished vector \
corresponding to the cylindrical periodicity,  and in this plane all the \
normal rules of vector arithmetic hold. \\r\\nTable~\\\\ref{tab:notation} \
summarises the notation used in this Chapter.\\r\\n%\\r\\n\\\\begin{table}\\r\
\\n\\t\\t\\\\caption{Notation used in this \
Chapter.}\\r\\n\\t\\t\\t\\\\label{tab:notation}\\\\begin{tabularx}{\\\\\
textwidth}{l|X}\\r\\n\\t\\t\\t\\\\hline\\r\\n\\t\\t$[x]$ & The nearest \
integer to $x$. \\r\\n\\t\\t\\\\\\\\\\r\\n\\t\\t\\t$l_k$ & The $k$-th lattice \
point, with coordinates $(dk - [dk],kh)$. \\r\\n\\t\\t\\t\\t\\\\\\\\\\r\\n\\t\
\\t\\t\\t$(x,z)$ & Real coordinates in a vertical cylinder \
$[0,1]\\\\times\\\\jR$ or the plane $\\\\jR^2$, or more often a vector in $\\\
\\jR^2$ relative to an origin $(0,0)$. (Warning: at the end of \
Chapter~\\\\ref{ch:classifying} we use a different $z=d+ih$ with \
$z\\\\in\\\\jC$.)\\r\\n\\t\\t\\t\\t\\\\\\\\\\r\\n\\t\\t\\t\\t$\\\\pvec{}$, \
$\\\\fvec$, $\\\\svec$ \\\\ldots & Vectors with form $(x,z)$..\\r\\n\\t\\t\\t\
\\t\\\\\\\\\\r\\n\\t\\t\\t\\t$\\\\pvec{0}$ & The vector $(1,0)$. We call this \
the \\\\textit{periodicity} vector.\\\\index{periodicity \
vector}\\r\\n\\t\\t\\t\\t\\\\\\\\\\r\\n\\t\\t\\t\\t$\\\\pvec{1}$ & The vector \
$(d,h)$, usually with $0< d\\\\leq \\\\jhalf$ and $h>0$. This is the \
\\\\textit{generating} vector.\\\\index{generating vector} \\r\\n\\t\\t\\\\\\\
\\\\r\\n\\t\\t\\t\\t$\\\\mathcal{L}(d,h)$ & The lattice on the cylinder \
generated by the vectors $\\\\pvec{0}$ and $\\\\pvec{1}$:\\tthe set \
$a\\\\pvec{0}+b\\\\pvec{1}$ for $a,b\\\\in \\\\jZ$, after identifying points \
differing by an integer in $x$. \\r\\n\\t\\t\\t\\t\\\\\\\\\\r\\n\\t\\t\\t\\t$\
\\\\pvec{k}$ & The $k$-th parastichy\\\\index{parastichy vector} vector: the \
vector from $(0,0)$ to \
$(dk-[dk],kh)$.\\r\\n\\t\\t\\t\\t\\\\\\\\\\r\\n\\t\\t\\t\\t$\\\\phatvec{k}$ & \
The $k$-th complementary vector: the shorter of \
$\\\\pvec{k}\\\\pm\\\\pvec{0}$.\\\\index{complementary vector}\\r\\n\\t\\t\\t\
\\t\\\\\\\\\\r\\n\\t\\t\\t\\t$\\\\gp{m,n}$ pair & The principal \
vectors\\\\index{principal vector pair} of the lattice: the linearly \
independent pair $\\t\\\\pvec{m}$ and $\\\\pvec{n}$ (or $\\\\phatvec{n}$)  \
which are shortest in the lattice). More generally:\\r\\n\\t\\t\\t\\t\\\\\\\\\
\\r\\n\\t\\t\\t\\t$\\\\gp{r,s}$ pair & A generating pair: any pair of vectors \
that also generate $\\\\mathcal{L}(d,h)$.\\\\index{generating \
pair}\\r\\n\\t\\t\\t\\t\\\\\\\\\\r\\n\\t\\t\\t\\t$\\\\pp{m,n}$ lattice & A \
lattice in which the principal pair \\r\\n\\t\\t\\t\\tare \
$\\\\gp{m,n}$.\\r\\n\\t\\t\\t\\t\\\\\\\\\\r\\n\\t\\t\\t\\t$m$, $n$, $u$, $v$ \
& Integers satisfying $m v- n u=\\\\Delta$ and $\\\\Delta=\\\\pm \
1$.\\\\index{B\\\\'ezout relation}\\r\\n\\t\\t\\t\\t\\\\\\\\\\\\hline\\r\\n\\\
\\end{tabularx} \\r\\n\\\\end{table}\\r\\n%\\r\\nWe use surface coordinates \
$(x,z)$ on a cylinder, of fixed circumference 1, that extends infinitely in \
the vertical direction $z$.  At the origin we place a point of the lattice. \
By rotating an angle $2\\\\pi d$ around the cylinder from the origin and \
rising by $z=h$\\r\\nwe place a second point. Repetitions of this translation \
will define the whole lattice,  and we will call  \\r\\n$h$ the {rise} and \
$d$ the divergence. \
\\r\\n\\r\\n\\r\\n\\\\mmafig{Txb0403Coordinates}{\\r\\nEquivalent \
parameterisations of the same periodic planar lattice with divergence $d$ and \
rise $h$, here $d=4/10$, $h=1/10$.  In this case the cylindrical lattice \
point labelled 3 has co-ordinates $(3d-1,3h) =(3d - [3d],3h)$. In (c), some \
parastichy vectors are shown and  $\\\\pvec{3}=3\\\\pvec{1}-\\\\pvec{0}$: the \
vector $\\\\pvec{0}$ encodes the periodicity of the lattice.  In (c), the \
double diagonal lines mark the periodic boundary $x=\\\\pm\\\\jhalf$ of the \
cylindrical lattice. Elsewhere in this book the pale green rectangle alone, \
of width 1,  is used as a convention to indicate this periodicity of the \
cylinder. \
\\r\\n}{1.0}\\r\\n\\r\\n\\\\newcommand{\\\\dk}{x_k}\\\\newcommand{\\\\dm}{x_m}\
\\\\newcommand{\\\\dn}{x_n}\\\\newcommand{\\\\dmn}{x_{m+n}}\\r\\nSpecifically,\
 the lattice  $\\\\mathcal{L}(d,h)$ is the set of points  $\\\\jpoint{k}$ \
with coordinates  $(x,z)=(\\\\dk,kh)$ where $k$\\r\\nis any integer, \
$\\\\dk=kd-[kd]$ and $[x]$ is the nearest integer to $x$, with ties chosen so \
that $-\\\\jhalf < \\\\dk \\\\leq \\\\jhalf$.%\\r\\n\\\\jNote{There is a \
temptation to take the range of $x$ as $[0,1]$ instead of \
$[-\\\\jhalf,\\\\jhalf]$. Nothing bad happens if we do; the choice here is \
partly historical, when a large part was played by spirals winding in \
opposite directions, and following this convention means opposing spirals \
will have positive and negative $x$ components.}\\r\\nSee \
Figure~\\\\ref{fig:Txb0403Coordinates}. \\r\\nCo-ordinates of lattice points \
are in the cylinder strip $C=(-\\\\jhalf,\\\\jhalf]\\\\times\\\\jR$, and \
there is a natural \\r\\n{planar lattice}  which is the unrolled set of \
points $\\\\mathcal{L}+w (1,0)$ over all integers $w$. \\r\\nThere is a \
simple map from the plane back to the cylinder: $(x,z)\\\\rightarrow(x-w,z)$ \
where $w=[x]$ is the \\\\emph{winding number} of the vector $(x,z)$. This \
maps all the plane lattice points of rise $kh$ onto the unique cylindrical \
lattice point $\\\\jpoint{k}$ of rise $kh$. \\r\\n\\r\\nMore generally, \
planar lattices are generated from pairs of vectors $\\\\mathbf{a}$ and \
$\\\\mathbf{b}$ as the set of all possible integer sums  $u \\\\mathbf{a}+ \
v\\\\mathbf{b}$. It will often happen that two different generating pairs \
generate the same given lattice. A planar lattice is $1$-periodic if it has \
the vector $(1,0)$ as a member, and then it has a corresponding cylindrical \
lattice which is the subset of points with the divergence $x$ in $[\\\\jhalf,\
\\\\jhalf]$.  \\r\\n\\r\\n\\\\subsection{Labelling cylindrical \
vectors}\\r\\nEach point of the plane lattice corresponds to a \\r\\nvector \
in $\\\\jR^2$ with the normal rules of vector arithmetic. But although the \
map of planar-lattice points to cylindrical-lattice points is many-to-one, \
the map of planar vectors to cylindrical vectors is one-to-one, because each \
pair of points on the cylinder will be joined by a family of vectors, each \
winding a different number of times around the cylinder, and with co-ordinate \
components equal to components of the corresponding plane vector.   Thus we \
can do our normal vector arithmetic on the cylinder, although we will  be \
careful about how we label vectors. \\r\\n\\r\\nFirst we distinguish one \
special vector $\\\\pvec{0}=(1,0)$ which encodes the periodicity of the \
lattice. After that, we note that the shortest of all the vectors on the \
cylinder from the origin to $\\\\jpoint{k}$ is the shortest of the set of \
vectors from the origin to any of the points in the planar lattice with rise \
$kh$; it must be one of the two vectors to the point $\\\\jpoint{k}$ with \
winding number zero. \\r\\nWe name this shortest of the vectors from the \
origin to $\\\\jpoint{k}$ as  the \\\\textit{parastichy vector} \
$\\\\pvec{k}$.\\r\\n\\r\\nSometimes adding two parastichy vectors takes the \
sum outside of the cylinder and then the sum is not a parastichy vector. For \
the most part we only need to be concerned with parastichy vectors, but for \
some (mathematically if not biologically)  significant special cases,  there \
is a role for the \\\\textit{second} shortest vector to the point \
$\\\\jpoint{k}$. We call this the \\\\emph{complementary vector} \
$\\\\phatvec{k}$ (Figure~\\\\ref{fig:Txb0404Complementary}). The \
complementary vector is the shorter of $\\\\pvec{k}\\\\pm \\\\pvec{0}$. There \
is a  special case when $d=\\\\jhalf$, so that the vectors $(\\\\jhalf,h)$ \
and $(-\\\\jhalf,h)$ are equal-length vectors to the point $\\\\jpoint{1}$: \
in this case we label them as $\\\\pvec{1}$ and $\\\\phatvec{1}$ \
respectively.\\r\\n\\r\\n\\r\\n\\\\mmafig{Txb0404Complementary}{\\r\\nThe \
parastichy vector $\\\\pvec{2}=(x_2,2h)$, in red, is the shortest vector on \
the cylinder to the point $\\\\jpoint{2}$ and always has \
$|x_2|\\\\leq\\\\jhalf$. The second-shortest vector to the point will wind in \
the opposite direction and is called the complementary vector \
$\\\\phatvec{2}$, in blue. Here $d=17/72$ so $x_2=2d$ and \
$\\\\phatvec{2}=\\\\pvec{2}-\\\\pvec{0}$ where  $\\\\pvec{0}=(1,0)$ is the \
horizontal vector around the circumference of the cylinder. A further, \
un-named vector is shown in green that winds more than a full turn about the \
cylinder: there are many vectors to the point $\\\\jpoint{2}$ with non-zero \
winding numbers. \
\\r\\n}{1}\\r\\n\\r\\n\\\\begin{jExercise}\\\\label{ex:phoriz}\\r\\n\\tShow \
that every parastichy vector has a horizontal component with absolute value \
less than or equal to $\\\\jhalf$, and every complementary vector has a \
horizontal component with absolute value unstrictly between $\\\\jhalf$ and \
$1$. Show that the sum of two parastichy vectors is either a parastichy \
vector or a complementary vector. \
\\r\\n\\\\end{jExercise}\\r\\n\\\\begin{jAnswer}{ex:phoriz}\\r\\n\\tIf \
$\\\\pvec{k}=(x,z)$, then $|x|\\\\leq\\\\jhalf$ direct from the definition of \
a parastichy vector.\\r\\n\\tIf $x>0$, then $\\\\phatvec{k}=\\\\pvec{k}- \
\\\\pvec{0}$ with \\r\\n\\thorizontal component $x-1$ which is between $-1$ \
and $-\\\\jhalf$, and similarly for $x<0$. \\r\\n\\tAdding $x$ components \
gives the final sentence. \
\\r\\n\\\\end{jAnswer}\\r\\n\\r\\n\\r\\n\\\\begin{jExercise}\\\\label{ex:\
pwinding}\\r\\n\\tShow that it is not true in general that \
$\\\\pvec{k}=k\\\\pvec{1}$, but that \
$\\\\pvec{k}=k\\\\pvec{1}-w_k\\\\pvec{0}$ for some integer winding number \
$w_k$. Find a lattice in which there are no integers $m,n$ such that \
$\\\\pvec{3}=m\\\\pvec{1}+n\\\\pvec{2}$. \
\\r\\n\\\\end{jExercise}\\r\\n\\\\begin{jAnswer}{ex:pwinding}\\r\\n\\tFor $d>\
\\\\jfrac{1}{4}$, $\\\\pvec{2}= (2d-1, h)=2\\\\pvec{1}-(1,0)\\\\neq \
2\\\\pvec{1}$;   in general we need to set $w_k= [ kd]$. For the second \
counter-example, choose $d$ so that $\\\\pvec{1}$ and $\\\\pvec{2}$ both have \
a positive $x$ component and $\\\\pvec{3}$ has a negative one.  \
\\r\\n\\\\end{jAnswer}\\t\\t\\r\\n\\\\begin{jExercise}\\\\label{ex:pcongruent}\
\\r\\n\\t\\tTwo vectors on the cylindrical lattice are \\\\textit{congruent} \
if they go to the same point: $(\\\\jpoint{k},w)\\\\equiv(\\\\jpoint{l},w')$ \
iff $k=l$. \\r\\n\\tShow that $\\\\pvec{n}\\\\equiv n\\\\pvec{1}$ and more \
generally that $u\\\\pvec{m}+v\\\\pvec{n}\\\\equiv\\\\pvec{um+vn}$ for \
integer  $u, v$.\\r\\n\\tThis book doesn't explicitly make any further use of \
the congruence relation. \
\\r\\n\\t\\\\label{ex:npm}\\r\\n\\\\end{jExercise}\\r\\n\\\\begin{jAnswer}{ex:\
pcongruent}\\r\\n\\tUnwind the spiral onto the lattice in the plane by \
setting $\\\\Pvec{m}=\\\\pvec{m}+([md],0)=m(d,h)$. Then \
$u\\\\Pvec{m}+v\\\\Pvec{n}=\\\\Pvec{um+vn}$, and the result follows by taking \
the $x$ coordinate modulo~1. \
\\r\\n\\t\\t\\\\end{jAnswer}\\r\\n\\t\\r\\n\\t\\r\\n\\t\\r\\n\\tInteger \
values of the divergence $d$ will not be very useful, and because   \
$\\\\mathcal{L}(d,h)= \\\\mathcal{L}(1+d,h)$, the range of $d$ can be taken \
as $(-\\\\jhalf,\\\\jhalf)$. The two lattices $\\\\mathcal{L}(d,h)$ and \
$\\\\mathcal{L}(-d,-h)$ are the same and we will assume that $h>0$. By \
contrast, the  lattices $\\\\mathcal{L}(d,h)$ and $\\\\mathcal{L}(-d,h)$ are \
mirror-images of each other.\\r\\n\\t\\t\\r\\n\\\\section{Parastichies}\\r\\n\
\\\\label{sec:parastichies}\\r\\nThe idea behind parastichies is to \
characterise a lattice not by its divergence, nor by identifying one point \
nearly above the origin, but by the most visible structures in the lattice, \
the families of straight lines that the eye naturally constructs through \
points in the lattice \
(Figure~\\\\ref{fig:Txb0405Parastichy5}).\\r\\n\\r\\n\\r\\n\\r\\n\\\\mmafig{\
Txb0405Parastichy5}{\\r\\n\\tThe family of 5-parastichies is a set of five \
lines on the cylinder, each member passing through one of the points \
$\\\\jpoint{0}$ to $\\\\jpoint{4}$.\\r\\n\\tThe thick line that passes \
through the origin  $\\\\jpoint{0}$, by definition the origin-parastichy of \
order 5,  also passes through the points $\\\\jpoint{5}$ and all points \
$\\\\jpoint{5k}$. The parastichy vector $\\\\pvec{5}$ (blue arrow) is the \
shortest vector from $\\\\jpoint{k}$ to $\\\\jpoint{k+5}$. \\r\\n\\tThis \
lattice has divergence $d=17/72$ and rise \
$h=0.03$.\\r\\n}{1}\\r\\n\\r\\n\\r\\nWe model this psychological choice \
through the parastichy vector. For an integer $m$, the origin-parastichy of \
order $m$ is the infinite line on the cylinder winding through the origin and \
$\\\\jpoint{m}$ with slope $mh/\\\\dm$ (or zero in the case $m=0$). This \
choice of slope is equivalent to choosing the line that traverses the \
smallest $x$ distance between $0$ and $\\\\jpoint{m}$, and the portion of \
this line between $0$ and $\\\\jpoint{m}$ coincides with the vector \
$\\\\mvec=(\\\\dm,mh)$ defined above as the parastichy vector.\\r\\n\\r\\nFor \
integer $m$, we define the $m$-foliation as  the family of  $m$ lines on the \
cylinder containing the origin-parastichy of order $m$ and the parallel lines \
to it through the points $\\\\jpoint{1},\\\\ldots,\\\\jpoint{m-1}$. (These \
$m$ lines might not be distinct: there are only 5 distinct members of the \
$10$-foliation in Figure~\\\\ref{fig:Txb0405Parastichy5}.)\\r\\nAn \
$m$-parastichy is any one member of the $m$-foliation, though usually we are \
thinking of the origin-parastichy of order $m$. \\r\\nThe 1-parastichy, which \
passes through every point of the lattice, is known as the \\\\emph{genetic \
spiral}. \\r\\n and each horizontal line through a point of the lattice is a \
$0$-parastichy. \\r\\n\\r\\nMost of the time the (eg) 5-parastichy, the point \
$\\\\jpoint{5}$, and the vector $\\\\pvec{5}$,  can be thought of \
interchangeably as standing for each other; but $\\\\phatvec{5}$ is a  vector \
winding the other way around the cylinder to $\\\\pvec{5}$ although it also \
arrives at  $\\\\jpoint{5}$.\\r\\n\\\\subsection{Visible points and \
parastichies}\\r\\nIn Figure~\\\\ref{fig:Txb0405Parastichy5} the point \
$\\\\jpoint{10}$ is not `visible' from the origin because the point \
$\\\\jpoint{5}$ can be thought of as obscuring it; the \
\\r\\norigin-parastichies of order 5 and 10 are the same lines. \\r\\nWe say \
that $\\\\jpoint{m}$ is a \\\\emph{visible point}, or the $m$-parastichy is a \
\\\\emph{visible parastichy}\\\\index{parastichy vector!visible}, if the \
latter is linearly independent of all the $n$-parastichies for all $|n|<|m|$. \
\\r\\n\\\\begin{jExercise}\\\\label{ex:pvisible}\\r\\n\\tCheck  visually that \
in the lattice of Figure~\\\\ref{fig:Txb0405Parastichy5} the $7$- and $9$- \
parastichies are visible but the $2$- parastichy is not.\\r\\nIf a point \
$\\\\jpoint{n}$ is on an $m$-parastichy then show that $\\\\jpoint{m+n}$ is \
on the same \
one.\\r\\n\\\\label{ex:bb}\\r\\n\\\\end{jExercise}\\r\\n\\\\begin{jAnswer}{ex:\
pvisible}\\r\\n\\tEach time we move from $\\\\jpoint{k}$ to $\\\\jpoint{k+1}$ \
we move to the next label in order of the foliation, which has $m$ members. \
When we have moved $m$ times we return to the original \
member.\\r\\n\\\\end{jAnswer}\\r\\n\\r\\n\\r\\n\\\\section{Parastichy \
pairs}\\r\\n\\r\\nSo far we have formalised what it means to be able to `see' \
a straight line in the lattice as a visible parastichy. We now concentrate on \
pairs of parastichies, as it is these pairs we will use to classify our \
lattices. Figure~\\\\ref{fig:Txb0406Parastichy45} shows two examples of \
parastichy pairs which might naturally be identified in a lattice. \
\\r\\n\\r\\n\\\\mmafig{Txb0406Parastichy45}{\\r\\n\\tSome of the more obvious \
parastichies and their parastichy vectors in a lattice with $d=17/72$ and \
$h=0.03$. The blue lines highlight the family of 4-parastichies,  the red \
lines the family of 5-parastichies, and the green ones the family of \
1-parastichies. There are four members of the 4-parastichies, and the member \
that passes through the point 0 also passes through the point 4. For this \
lattice, $\\\\gp{1,4}$ and $\\\\gp{4,5}$ are each  examples of a generating \
and opposed pair: in each case the two parastichies wind in opposite \
directions, the parallelogram defined by the pair tiles the lattice and every \
lattice point is at a vertex of one of the parallelograms; the edges of the \
parallelograms form the parastichy lines. \
\\r\\n}{0.9}\\r\\n\\r\\n\\\\begin{definition}\\r\\nThe \
$\\\\gp{m,n}$-parastichy pair is the pair of parastichy vectors $\\\\mvec$ \
and $\\\\nvec$.\\r\\nThe \\\\gphat{m}{n}-complementary pair is the pair of \
the parastichy vector $\\\\mvec$ and the complementary vector \
$\\\\phatvec{n}$.\\r\\n\\\\index{pairs of parastichy \
vectors}\\\\index{parastichy vector!complementary \
vector}\\r\\n\\\\label{def:pp}\\r\\n\\\\end{definition}\\r\\nComplementary \
pairs are only really needed for thinking about the special cases \
\\\\gphat{1}{k} and do not play a role in large Fibonacci lattices. The most \
important of these special cases, though is frequently seen. Plants may show \
\\\\textit{distichous} phyllotaxis, with successive organs  alternating in \
front and behind with a divergence of $180^\\\\circ$, correspond to a lattice \
with a \\\\gphat{1}{1} parastichy pair as in \
Figure~\\\\ref{fig:Txb0401LeafTypes}. The  hat can and will be dropped from \
the second \\\\textsf{1} when it is clear which of the vectors is meant. \
\\r\\n\\r\\n\\\\subsection{Opposed parastichy pairs}\\r\\n\\\\index{pairs of \
parastichy vectors!opposed}\\r\\nA parastichy pair $\\\\gp{m,n}$ is \
\\\\emph{opposed} if $m/\\\\dm$ and $n/\\\\dn$ have opposite sign, where \
$\\\\dm$ and $\\\\dn$ are the $x$-components of $\\\\mvec$ and $\\\\nvec$. A \
complementary pair \\\\gphat{m}{m} is always opposed. \\r\\n Historically, \
the idea of opposed pairs, with parastichies that wind in opposite \
directions, was an important organising idea for lattice classification, and \
they do play a role, but here we put more emphasis on the idea of a \
{generating pair}, and, later,  even more on the principal pair. \\r\\n\\r\\n\
\\r\\n\\r\\n\\r\\n\\\\section{Generating pairs}\\r\\n\\\\index{pairs of \
parastichy vectors!generating pairs}\\r\\nThere are many pairs of visible \
parastichies in a lattice, but Figure~\\\\ref{fig:Txb0407PPairs}  shows that \
finding one is not enough to characterise our lattices.   Looking at the \
lower left diagram of the Figure, both $\\\\pvec{5}$ and $\\\\pvec{7}$ are \
visible but knowing this pair exists doesn't tell us about $\\\\pvec{4}$: \
even though the pair  are linearly independent, we can't always express other \
parastichy vectors as their integer sums.  To make that precise we use the \
idea of a generating pair. \\r\\n\\\\mmafig{Txb0407PPairs}{\\r\\n\\tFurther \
parastichy pairs in the same lattice as \
Figure~\\\\ref{fig:Txb0406Parastichy45}. (a) $\\\\gp{5,9}$ is a generating \
but not opposed pair and the corresponding parallelogram (in black) has no \
lattice points except at its corners; (b) $\\\\gp{3,8}$, though a linearly \
independent pair, is  nonopposed and nongenerating pair; (c) although \
$\\\\pvec{5}$ and $\\\\pvec{7}$ are both visible parastichies, and are \
linearly independent, $\\\\gp{5,7}$ is  not a generating pair because there \
are lattice points internal to its parallelogram; (d) $\\\\gp{1,2}$ is not a \
linearly independent pair and cannot be generating, although for this spiral \
lattice, \\\\gphat{1}{2} is a generating \
pair.\\r\\n}{1}\\r\\n\\r\\n\\\\begin{definition} A pair of vectors \
$\\\\mathbf{a}$ and $\\\\mathbf{b}$\\r\\n\\t\\t   is \\\\emph{generating} in \
a lattice $\\\\mathcal{L}$ if every vector of $\\\\mathcal{L}$ can be \
expressed as a vector sum $q\\\\mathbf{a}+r\\\\mathbf{b}$\\r\\n\\t\\t   for \
integer $q,r$.\\r\\n\\\\label{def:g}\\r\\n\\\\end{definition}\\r\\n Most of \
the time the pair of vectors we see making up a generating pair will \
themselves each be parastichy vectors, but that is not required by the \
definition. If a pair is generating in the lattice $\\\\mathcal{L}(d,h)$ it \
is also generating in any other lattice with the same divergence, \
independently of $h$. In general one lattice has infinitely many generating \
pairs. \\r\\n\\\\begin{jExercise}\\\\label{ex:pinfgp}\\r\\n\\tShow \
this.\\r\\n\\\\end{jExercise}\\r\\n\\\\begin{jAnswer}{ex:pinfgp}\\r\\n\\tIf \
the pair $(x_m, m h)$ and $(x_n,n h)$ is generating in the lattice \
$\\\\mathcal{L}(d,h)$, then the lattice  $\\\\mathcal{L}(d, s h )$ has a \
generating pair $(x_m, s m h)$ and $(x_n,s n h)$.\\r\\n\\t\\r\\n\\tIf \
$\\\\mvec$ and $\\\\nvec$ are a generating pair for $\\\\mathcal{L}$ then so \
is any invertible linear \
combination\\r\\n\\t\\\\begin{equation}\\r\\n\\t\\t\\\\begin{pmatrix}\\r\\n\\\
t\\t\\\\mvec' \\\\\\\\ \\\\nvec' \\r\\n\\t\\t\\\\end{pmatrix}= \
\\r\\n\\t\\\\begin{pmatrix}\\r\\n\\t\\ta & b  \\\\\\\\ c & d  \
\\r\\n\\t\\\\end{pmatrix}\\t\\\\begin{pmatrix}\\r\\n\\t\\\\mvec \\\\\\\\ \
\\\\nvec \\r\\n\\\\end{pmatrix}\\r\\n\\t\\\\end{equation}\\r\\n\\tfor integer \
$a,b,c,d$. Most of these will not be parastichy vector \
pairs.\\r\\n\\\\end{jAnswer}\\r\\n\\r\\nSince every point in our lattice has \
a rise which is an integer multiple of $h$, a necessary condition for a pair \
to be generating is that it can generate all these $h$ multiples in the \
vertical component of its \
sums:\\r\\n\\\\begin{theorem}\\r\\n\\t\\\\label{thm:coprime1}\\r\\n\\tIf a \
parastichy pair $\\\\gp{m,n}$ is generating, then $m$ and $n$ are co-prime. \
\\r\\n\\\\end{theorem}\\r\\n\\\\begin{proof}\\r\\n\\tWrite $\\\\pvec{1}= \
v\\\\pvec{m}-u\\\\pvec{n}$; then the rise of $\\\\pvec{1}$ shows $mv-nu = 1$ \
holds and Section~\\\\ref{sec:coprime} shows that $|m|,|n|$, and hence $m,n$, \
are co-prime. The converse is not true: see \
Figure~\\\\ref{fig:Txb0407PPairs}. In particular though 1 and 1 are co-prime \
the parastichy pair $\\\\gp{1,1}$ is not \
generating.\\r\\n\\\\end{proof}\\r\\nThis is not a sufficient condition. For \
example:\\r\\n\\\\begin{theorem}\\r\\n\\t\\\\label{thm:coprime}\\r\\n\\tIf \
$\\\\mvec$ and $\\\\nvec$ are co-linear then they are not generating.\\r\\n\\\
\\end{theorem}\\r\\n\\\\begin{proof}\\r\\n\\tCo-linearity means that any \
vector sum of $\\\\pvec{m}$ and $\\\\pvec{n}$ lies on the line in the plane \
through $\\\\jpoint{m}$ and $\\\\jpoint{n}$. For some large enough $k$ this \
will contain a point of the plane lattice of rise $kh$ with co-ordinates \
outside of the cylinder. The vector to this point is therefore not a \
parastichy vector but is the only candidate for a vector sum with rise $kh$, \
and so the parastichy vector $\\\\pvec{k}$ is not an integer sum of \
$\\\\mvec$ and $\\\\nvec$.\\r\\n\\\\end{proof}\\r\\nExcluding co-linearity is \
still not enough, as part (b) of Figure~\\\\ref{fig:Txb0407PPairs} suggests. \
The next section finds an algebraic condition for a pair to be generating. \
\\r\\n\\r\\n\\\\begin{jExercise}\\\\label{ex:p01g}\\r\\n\\t\\\\label{ex:\
01generating}\\r\\n\\tShow that $\\\\gp{0,1}$ is always generating, and that  \
$\\\\gp{0,n>1}$ never is. \
\\r\\n\\\\end{jExercise}\\r\\n\\\\begin{jAnswer}{ex:p01g}\\r\\n\\tAny \
parastichy vector $\\\\pvec{k}$ can be written as $k\\\\pvec{1}-w_k \
\\\\pvec{0}$, so $\\\\gp{0,1}$ is generating. The rise of every integer sum \
of $\\\\pvec{0}$ and $\\\\pvec{n>1}$ is a multiple of $nh$ and cannot be \
equal to $h$ and the pair cannot generate \
$\\\\pvec{1}$.\\r\\n\\t\\r\\n\\\\end{jAnswer}\\r\\n\\\\begin{jExercise}\\\\\
label{ex:pcomp}\\r\\n\\tShow that the complementary pair \\\\gphat{m}{m} is \
generating only when \
$|m|=1$.\\r\\n\\\\end{jExercise}\\r\\n\\\\begin{jAnswer}{ex:pcomp}\\r\\n\\\
tSince $\\\\pvec{0}=\\\\pvec{1}\\\\pm\\\\phatvec{1}$, every parastichy vector \
$\\\\pvec{k}=k\\\\pvec{1}-w\\\\pvec{0}$ is an integer sum of $\\\\pvec{1}$ \
and $\\\\phatvec{1}$. However every integer sum of\\r\\n\\t$\\\\pvec{m}$ and \
$\\\\phatvec{m}$ has rise which is a multiple of $m$ and so the pair is not \
generating unless $|m|=1$. \
\\r\\n\\\\end{jAnswer}\\r\\n\\r\\n\\r\\n\\r\\n\\\\begin{jExercise}\\\\label{\
ex:p57ng}\\r\\n\\tShow that in the lattice $\\\\mathcal{L}(d=17/72)$, \
$\\\\pvec{4}$ cannot be expressed as an integer sum of $\\\\pvec{5}$ and \
$\\\\pvec{7}$ and thus that $\\\\gp{5,7}$ is not generating in this \
lattice.\\r\\n\\\\end{jExercise}\\r\\n\\\\begin{jAnswer}{ex:p57ng}\\r\\n\\\
tThe only candidate vector sum with the correct rise is \
$2\\\\pvec{7}-2\\\\pvec{5}$, but by direct calculation this is \
$\\\\pvec{4}-(1,0)$ and thus is not a parastichy vector. \
\\r\\n\\\\end{jAnswer}\\r\\n\\r\\n\\r\\n\\\\subsection{Generating pairs as \
basis vectors}\\r\\n A helpful way to think of the generating pair \
$\\\\gp{m,n}$ is that  $\\\\pvec{m}$ and $\\\\pvec{n}$ provide a coordinate \
basis for the plane, and the lattice points are the ones with integer \
coordinates in that basis. From this perspective, a cylindrical lattice is \
not generated merely by the first parastichy vector $\\\\pvec{1}$, but \
instead by  the pair comprising  $\\\\pvec{1}$ together with the periodicity \
vector $\\\\pvec{0}$, which is used as necessary to pull multiples of \
$\\\\pvec{1}$ back into the cylindrical strip \
(Figure~\\\\ref{fig:Txb0408Periodic}).\\r\\n \\\\mmafig{Txb0408Periodic}{The  \
pair of red and blue vectors $\\\\pvec{3}$ and $\\\\pvec{2}$ , and the pair \
of white and green vectors $\\\\pvec{0}$ and $\\\\pvec{1}$ each generate the \
same lattice}{1.0}\\r\\n Indeed we saw in Exercise~\\\\ref{ex:01generating} \
that $\\\\pvec{0}$ and $\\\\pvec{1}$ are always generating, or in this sense \
always form a basis pair for the cylindrical lattice. \\r\\n But there are \
many possible gnerating pairs. \\r\\n One of the ways that this is viewpoint \
is useful  that it gives us a way to characterise generating pairs by \
thinking of them as corresponding to a change of basis from the basis \
associated with $\\\\gp{0,1}$ and produce the central algebraic result of \
this chapter:\\r\\n\\r\\n\\\\begin{theorem}\\r\\n\\\\label{thm:gLattice}\\r\\\
n\\\\label{thm:glattice}\\r\\n\\tIn any lattice $\\\\mathcal{L}(d,h)$, the \
following are equivalent for coprime integers \
$m,n$:\\r\\n\\t\\\\begin{enumerate}\\r\\n\\t\\t\\t\\\\item The pair of \
parastichy vectors $\\\\mvec$ and $\\\\nvec$, is a generating \
pair.\\r\\n\\\\item The area of the parallelogram formed by $\\\\mvec$ and \
$\\\\nvec$, namely the vector cross product \
$h\\\\Delta_{mn}=\\\\mvec\\\\times\\\\nvec$, \
satisfies\\r\\n$|\\\\Delta_{mn}|=1$. \\t\\r\\n\\t\\t\\\\item The integers \
$u=[md],v=[nd]$ satisfy $|mv-un|=1$ and the parastichy vectors\\t\\r\\n\\t\\t \
satisfy \\r\\n\\t\\\\begin{align}\\\\label{eq:Pmnuv1}\\r\\n\\t\\t\\t\\\\begin{\
pmatrix}\\r\\n\\t\\t\\t\\\\nvec \\\\\\\\ \\\\mvec \
\\r\\n\\t\\t\\\\end{pmatrix} = &\\r\\n\\t\\t\\\\begin{pmatrix}\\r\\n\\t\\tn & \
- v \\r\\n\\t\\t\\\\\\\\\\r\\n\\t\\tm &- u \
&\\r\\n\\t\\t\\t\\\\end{pmatrix}\\r\\n\\t\\t\\\\begin{pmatrix}\\r\\n\\t\\t\\t\
\\\\pvec{1}\\r\\n\\t\\t\\t\\\\\\\\\\r\\n\\t\\t\\t\\\\pvec{0}\\r\\n\\t\\t\\\\\
end{pmatrix}\\r\\n\\t\\\\end{align}\\r\\n\\t\\\\end{enumerate}\\r\\n\\\\end{\
theorem}\\r\\n\\\\begin{proof}\\r\\n\\tSuppose (1) is true. Since the pair  $\
\\\\mvec$ and $\\\\nvec$, is generating the lattice is tiled\\r\\n\\tby the \
$(\\\\mvec,\\\\nvec)$ parallelogram with an area per point of \
$h|\\\\Delta_{mn}|$. But  the $(\\\\pvec{0},\\\\pvec{1})$ parallelogram also \
tiles the same lattice with an area per point of $h= \
(1,0)\\\\times(d,h)=h\\\\Delta_{01}$. These areas must be the same, so that \
$|\\\\Delta_{mn}|=|\\\\Delta_{01}|=1$, and (1) $\\\\implies$ (2). \
\\r\\n\\t\\r\\nBy definition $\\\\mvec=m\\\\pvec{1}- [md]\\\\pvec{0}$,  \
$\\\\nvec=n\\\\pvec{1}-[nd]\\\\pvec{0}$. Assume (2) is true  and set $u=[md]$ \
and $v=[nd]$, so~\\\\eqref{eq:Pmnuv1} holds \\r\\n\\t\\tand the cross product \
$h\\\\Delta_{mn}=\\\\mvec\\\\times\\\\nvec=(m v - u n) (\\\\pvec{1} \\\\times \
\\\\pvec{0})$ gives $|m v-un|=1$ and so\\r\\n\\t (2)$\\\\implies$(3). \
\\r\\n\\r\\nSuppose (3) holds, and invert equation~\\\\eqref{eq:Pmnuv1} in \
integers to \
see\\r\\n\\t\\\\begin{align}\\t\\r\\n\\t\\t\\\\label{eq:Pmnuv2}\\r\\n\\t\\t\\\
\\begin{pmatrix}\\r\\n\\t\\t\\t\\\\pvec{1}\\r\\n\\t\\t\\t\\\\\\\\\\r\\n\\t\\t\
\\t\\\\pvec{0}\\r\\n\\t\\t\\\\end{pmatrix} = & \\\\pm 1 \
\\\\cdot\\r\\n\\t\\t\\\\begin{pmatrix}\\r\\n\\t\\t\\t-u &  v \
\\r\\n\\t\\t\\t\\\\\\\\\\r\\n\\t\\t\\t-m & n &\\r\\n\\t\\t\\\\end{pmatrix}\\r\
\\n\\t\\t\\\\begin{pmatrix}\\r\\n\\t\\t\\t\\\\nvec \\\\\\\\ \\\\mvec \
\\r\\n\\t\\t\\\\end{pmatrix}. \\r\\n\\t\\\\end{align}\\r\\nThis shows  \
$\\\\pvec{0}$ and $\\\\pvec{1}$ are expressible as integer sums of $\\\\mvec$ \
and $\\\\nvec$ and so the pair  $\\\\mvec$ and $\\\\nvec$ is generating and \
(3) $\\\\implies$ (1). \\r\\n\\r\\n\\\\end{proof}\\r\\n \
Figure~\\\\ref{fig:Txb0409Apextriangle} illustrates the properties \
$m\\\\nvec-n\\\\mvec=\\\\pm\\\\pvec{0}$ and \
$v\\\\mvec-u\\\\nvec=\\\\pm\\\\pvec{1}$ shown by~\\\\eqref{eq:Pmnuv2}.\\r\\n%\
\\r\\n\\\\mmafig{Txb0409Apextriangle}{A generating pair \\r\\n\\tmust by \
definition be able to express other lattice vectors, and in particular  \
$\\\\pvec{0}$ and $\\\\pvec{1}$. Theorem~\\\\ref{thm:glattice} finds the \
necessary coefficients. Here $d=17/72$, and the $\\\\gp{m,n}=\\\\gp{5,4}$ \
pair is generating, with $x_m=13/72$, $x_n=-4/72$, $u=1$, $v=1$, $\\\\Delta=m \
v-nu=1$.\\r\\n\\tThe larger triangle is formed by translating $\\\\mvec$ by $\
\\\\pvec{0}$ , and then scaling it by $n$ until it meets   $m\\\\nvec$; that \
must be a lattice point if the pair is generating. This illustrates \
$\\\\pvec{0}=m\\\\pvec{n}-n\\\\pvec{m}$.\\r\\n\\tIn the smaller triangle, out \
of every $u$ and $v$ satisfying $mv-nu=1$, and thus giving\\r\\n\\t \
$v\\\\pvec{m}-u\\\\pvec{n}$  rise 1, the same as $\\\\pvec{1}$, there is \
exactly one $(u,v)$ pair giving a parastichy vector which is therefore \
$\\\\pvec{1}$. \\t}{1.0}\\r\\n%\\r\\n%\\r\\nThe parallelogram tiling of \
Theorem~\\\\ref{thm:glattice} also shows the following, since the $m$ and $n$ \
parastichies are formed by the boundary of the $\\\\pvec{m},\\\\pvec{n}$ \
parallelogram\\r\\n\\\\begin{theorem}\\r\\n\\t\\\\label{thm:planeintersect}\\\
r\\n\\tIf the parastichy pair $\\\\gp{m,n}$ is generating then the plane \
parastichies of order $m$ and $n$ intersect only at points of the lattice in \
the plane.\\r\\n\\\\end{theorem}\\r\\nThe converse of the Theorem is not \
true; the intersections of the 3- and 8-parastichies in  \
Figure~\\\\ref{fig:Txb0407PPairs} are exactly the points of $\\\\mathcal{L}$ \
but $\\\\gp{3,8}$ is not generating for that lattice. \\r\\nThis Theorem \
allows a more algebraic demonstration of the requirement that $|\\\\Delta|=1$ \
for a generating pair,  by calculating the coordinates of the apex point in \
Figure~\\\\ref{fig:Txb0409Apextriangle}: this has rise $mnh/\\\\Delta_{mn}$ \
which must be an integer multiple of $mn$ since it is a lattice point and so \
$|\\\\Delta_{mn}|=1$ since $m$ and $n$ are co-prime.  \\r\\n\\r\\n\\t\\r\\n\\\
\\begin{jExercise}\\\\label{ex:padajacent}\\r\\n\\tIf $\\\\gp{m,n}$ is \
generating, then $\\\\mvec$ lies on the adjacent $n$-parastichy to \
$\\\\nvec$. \
\\r\\n\\\\end{jExercise}\\r\\n\\\\begin{jAnswer}{ex:padajacent}\\r\\n\\t$\\\\\
mvec$ lies on the $m$-parastichy through the origin, and on some \
$n$-parastichy. If this was not the one adjacent to the $n$-parastichy \
through the origin, then it would intersect that $n$-parastichy and the \
intersection would be a lattice point since the pair is generating. But then \
the intersection would be a lattice point in but not at the corners of the \
$m,n$ parallelogram which it cannot be since the pair is generating. \\r\\n\\\
\\end{jAnswer}\\r\\n\\r\\nTheorem~\\\\ref{thm:glattice} is not as general as \
it could be because not all generating pairs are pairs of parastichy vectors. \
We will also encounter the case of the pair of vectors \\r\\n$\\\\pvec{1}$ \
and $\\\\phatvec{n}$ which are a parastichy vector and a complementary \
vector. But if need be, each part of Theorem~\\\\ref{thm:glattice} can be \
translated as a statement about $\\\\phatvec{n}=\\\\nvec\\\\pm\\\\pvec{0}$ \
instead of $\\\\nvec$. \
\\r\\n\\r\\n\\\\begin{jExercise}\\\\label{ex:pdeltacomp}\\\\label{ex:\
calcdelta}\\r\\nExtend the definition of $\\\\Delta$ to complementary \
vectors. \\tFind   $\\\\Delta_{1n}$ and $\\\\Delta_{1\\\\hat n}$. Find  \
$d$-intervals on which \\r\\n$\\\\Delta_{12}=1$ or $\\\\Delta_{1\\\\hat \
2}=1$. Rewrite~\\\\eqref{eq:Pmnuv1} for the case $\\\\phatvec{n}=\\\\pvec{n}+\
\\\\sigma\\\\pvec{1}$.\\r\\n\\\\end{jExercise}\\r\\n\\\\begin{jAnswer}{ex:\
pdeltacomp}\\r\\nFrom Theorem~\\\\ref{thm:glattice}, \
$h\\\\Delta_{1n}=\\\\pvec{1}\\\\times\\\\pvec{n}=[nd]$.\\r\\nSetting \
$\\\\sigma=\\\\Sign (nd -[nd])$, \
$\\\\phatvec{n}=\\\\pvec{n}-\\\\sigma\\\\pvec{0}$ and so $\\\\Delta_{1\\\\hat \
n}=[nd]+\\\\sigma$. \\r\\nIf $0<d<\\\\jfrac{1}{4}$ then $\\\\Delta_{12}=1$ \
and $\\\\Delta_{1\\\\hat2}=0$, while \\r\\nif  \
$\\\\jfrac{1}{4}<d<\\\\jfrac{1}{2}$ then  $\\\\Delta_{12}=0$ and \
$\\\\Delta_{1\\\\hat2}=1$.\\r\\nFinally we must choose $u,v$ so that $|mv \
-u(n+\\\\sigma)|=1$ \
and\\r\\n\\t\\t\\\\begin{align}\\\\label{eq:Pmnuv1ex}\\r\\n\\t\\t\\\\begin{\
pmatrix}\\r\\n\\t\\t\\t\\\\phatvec{n} \\\\\\\\ \\\\mvec \
\\r\\n\\t\\t\\\\end{pmatrix} = \
&\\r\\n\\t\\t\\\\begin{pmatrix}\\r\\n\\t\\t\\t(n+\\\\sigma)  & - v \
\\r\\n\\t\\t\\t\\\\\\\\\\r\\n\\t\\t\\tm &- u &\\r\\n\\t\\t\\\\end{pmatrix}\\r\
\\n\\t\\t\\\\begin{pmatrix}\\r\\n\\t\\t\\t\\\\pvec{1}\\r\\n\\t\\t\\t\\\\\\\\\\\
r\\n\\t\\t\\t\\\\pvec{0}\\r\\n\\t\\t\\\\end{pmatrix}\\r\\n\\t\\\\end{align}\\\
r\\n\\\\end{jAnswer}\\r\\n\\r\\nTheorem~\\\\ref{thm:glattice} gives us a \
criterion, $|\\\\Delta_{mn}|=1$, for a parastichy pair to be generating which \
is independent of $h$: whether a parastichy pair is generating or not is \
independent of the rise, as can be seen by scaling the diagrams of \
Figure~\\\\ref{fig:Txb0407PPairs} vertically.  Note also that $\\\\gp{m,n}$ \
are not claimed to be unique: for fixed $d$ and thus $\\\\pvec{0}$ and \
$\\\\pvec{1}$, every integer matrix with determinant of modulus 1 \
in~\\\\eqref{eq:Pmnuv1} yields a different generating pair.\\r\\n\\r\\n\\r\\n\
\\\\section{Estimating the divergence for a generating parastichy \
pair}\\r\\nSuppose that we observe a lattice with a  generating parastichy \
pair of $\\\\gp{55,89}$. Although this is  compatible with a range of \
divergences $d$, they turn out all to be in a small interval around the \
Fibonacci angle. To make this precise, we will \\r\\ncompute \
\\\\emph{generating intervals}. Since, as we have just seen, whether or not a \
pair are generating in a lattice $  \\\\mathcal{L}(d,h)$ is independent of \
$h$, these intervals only depend on \
$d$:\\r\\n\\\\begin{definition}\\r\\n\\tThe generating interval for the \
integers $m$ and $n$ is the subset\\r\\n\\tof the $d$-interval $[0,1]$ for \
which $\\\\gp{m,n}$ is generating in  \
$\\\\mathcal{L}(d,\\\\cdot)$.\\r\\n\\\\end{definition}\\r\\nIt's apparent \
from Theorem~\\\\ref{thm:glattice} that the generating interval is exactly \
when \\r\\n $|\\\\Delta=mv-nu|=1$. This integer valued function is dependent \
on the real variable $d$, so it must be a step-function of $d$. A few special \
cases, like $\\\\Delta_{01}=1$, and $\\\\Delta_{1\\\\hat 1}=1$ are constant \
on the whole $d$-interval, but in general the work in calculating $\\\\Delta$ \
consists in finding where these step changes are.%\\r\\n\\r\\n\\r\\n\\r\\nFor \
simple parastichy numbers we can calculate generating intervals directly, \
along with the \\r\\ncomplementary-generating interval for the integers $m$ \
and $n$, which is the subset of  $[0,1]$ for which  \\\\gphat{m}{n} is \
generating in  \
$\\\\mathcal{L}(d,\\\\cdot)$.\\r\\n\\\\begin{jExercise}\\\\label{ex:pmn01g}\\\
r\\n\\tFind the generating and complementary-generating intervals for \
$m=0,n=1$ and for $m=1,n$. \
\\r\\n\\\\end{jExercise}\\r\\n\\\\begin{jAnswer}{ex:pmn01g}\\r\\n\\t By \
Exercise~\\\\ref{ex:calcdelta} the generating and complementary-generating \
intervals for $m=0$ and $n=1$ are the whole $d$-interval  $[0,\\\\jhalf]$.  \
\\r\\n\\tThe generating interval for $1,1$ is empty, since $\\\\gp{1,1}$ is \
never generating, but the complementary-generating interval is the whole \
$d$-interval, since \\\\gphat{1}{1} is always generating.\\r\\nFor $m=1$, \
$n=2$, Exercise~\\\\ref{ex:calcdelta} shows that the generating interval is \
$[\\\\jfrac{1}{4},\\\\jhalf]$ and the complementary-generating interval is \
the whole $d$-interval.\\r\\nFor $m=1$ and $n>2$,  \
Exercise~\\\\ref{ex:calcdelta} shows the generating interval is the $d$ such \
that $[nd]=1$, which is $2nd\\\\in [1,3]$.  \\r\\nThe complementary pair is \
generating either when (a) $[nd]=0$, which requires $2nd<1$ or (b) when both \
$[nd]=2$ (so $2nd\\\\in [3,5]$) and $nd<[nd]=2$,\\r\\nso (b) requires \
$2nd\\\\in[3,4]$. These two possibilities flank the generating \
interval.\\r\\n\\\\end{jAnswer}\\r\\nThese direct calculations become more \
irksome for larger numbers, but we can also calculate generating intervals \
using winding-number pairs. The strategy to find the generating interval for \
${m,n}$ is first to find $u,v$ satisfying equation $mv-nu=\\\\pm 1$, so we \
can satisfy Theorem~\\\\ref{thm:gLattice} and then to solve the piecewise \
linear equations $[md]=u$ and $[nd]=v$ for $d$. For a general one of these \
B\\\\'ezout pairs, the resulting interval won't be in $[0,\\\\jhalf]$, \
although there will be one related by an integer difference or the mirror \
symmetry $d\\\\rightarrow1-d$. In fact, the selection of the winding-number \
pair from the possible B\\\\'ezout pairs in section~\\\\ref{sec:wnp} was so \
as to ensure we get a generating interval in $[0,\\\\jhalf]$, as we will see \
in the proof of Theorem~\\\\ref{thm:fundamentalcorresponding}. \
\\r\\n\\r\\n\\r\\n\\\\begin{jExercise}\\\\label{ex:pmirror}\\r\\n\\tShow that \
the $d$-intervals on which\\r\\n\\t$\\\\Delta_{mn}=\\\\pm1$ are related by \
the mirror \
symmetry.\\r\\n\\\\end{jExercise}\\r\\n\\\\begin{jAnswer}{ex:pmirror}\\r\\n\\\
tWrite the intervals for $\\\\Delta=-1$ as $(L_{m-},R_{m-})= \
(u_--\\\\jhalf,u_-+\\\\jhalf)/m$, $(L_{n-},R_{n-})= \
(v_--\\\\jhalf,v_-+\\\\jhalf)/n$.\\r\\n\\tUse $u_-=m-u$ and $v_-=n-v$. \\r\\n\
\\\\end{jAnswer}\\r\\n\\r\\nExample~\\\\ref{ex:fibex} shows the relationship \
between Fibonacci generating pairs and the golden ratio. \
\\r\\n\\r\\n\\r\\n\\r\\n\\\\begin{jExercise}\\\\label{ex:pneartau}\\r\\n\\\
tShow that  pairs of large enough adjacent Fibonacci numbers are parastichy \
numbers which are generating in a lattice only if the divergence in \
$[0,\\\\jhalf]$ is near to $1/\\\\tau^2$.\\r\\n\\t\\\\label{ex:fibex}\\r\\n\\\
\\end{jExercise}\\r\\n\\\\begin{jAnswer}{ex:pneartau}\\r\\n\\tSuppose $k$ is \
odd, then the winding-number pair for \\r\\n\\t$m=F_k$, $n=F_{k+1}$ is \
$u=F_{k-1}$, $v=F_{k}$. \\r\\n\\tLet $I_k$ be the interval \
$[F_k-\\\\jhalf,F_k+\\\\jhalf]/F_{k+1}$. \\r\\n\\tThen $[md]=u$ when $d\\\\in \
I_k$ and $[nd]=v$ when $d\\\\in I_{k+1}$.\\r\\n\\tAs $k$ becomes large and \
odd, $I_k$ tends to the point $\\\\lim F_k/F_{k+1}=1/\\\\tau$.\\r\\n\\tIf $k$ \
is even, the winding number pair is $F_{k-2}$,$F_{k-1} = \
F_{k}-F_{k-1},F_{k+1}-F_k$ which we recognise as giving us the interval \
$1-I_k$ for $[md]=u$ and $[nd]=v$ instead.  \\r\\nSince \
$1/\\\\tau>\\\\jhalf$, in either case the interval in $[0,\\\\jhalf]$ on \
which\\r\\nparastichy vectors for adjacent Fibonacci numbers\\r\\n is \
generating is close to $1-1/\\\\tau=1/\\\\tau^2$. \
\\t\\r\\n\\\\end{jAnswer}\\r\\n\\r\\n\\r\\n\\r\\n\\\\section{Opposed \
intervals}\\r\\nSimilarly to calculating generating intervals, we can \
calculate opposed intervals: those on which a given parastichy pair is \
opposed. There are no more than two disjoint generating intervals for a given \
pair, related by the mirror symmetry, but there can be many opposed \
intervals. \\r\\nWe recall \\r\\n$\\r\\nx_m = m d - [ m d]$,\\r\\n$\\r\\nx_n \
= n d - [ n d ].\\r\\n$\\r\\nFor $m,n$ positive integers not both equal to \
one, the pair $\\\\gp{m,n}$ is {opposed} if $x_m x_n <0$.\\r\\nWe define \
$\\\\gp{0,1}$  and \\\\gphat{m}{m}  to be opposed.\\r\\n\\r\\n\\\\section{The \
Fundamental Theorem of \
Phyllotaxis}\\r\\n\\\\mmafig{Txb0410GeneratingIntervals}{Generating intervals \
for a range of $\\\\gp{m,n}$ parastichy pairs. The horizontal line represents \
the $d$ interval $[0,\\\\jhalf]$ . It is drawn dashed if it is the \
$\\\\Delta_{mn}=+1$ generating interval which falls into $[0,\\\\jhalf]$ and \
dotted if it is the $\\\\Delta_{mn}=-1$ interval. \\r\\n\\tRed bars show the \
subinterval on which the $\\\\gp{m,n}$ pair is generating and opposed; grey \
bars show the subinterval on which it is generating and unopposed.\\r\\n}{.8}\
\\r\\n\\\\label{sec:ftp}\\r\\nFinally, we can take the intersection of the \
generating interval and the opposed interval to find the generating and \
opposed interval. This is the $d-$interval on which the pair of vectors \
$\\\\gp{m,n}$ is both generating and opposed in the lattice \
$\\\\mathcal{L}(d,h)$.\\r\\nWhen we calculate this we get what Jean called \
the `Fundamental Theorem' of \
Phyllotaxis~\\\\autocite{jeanPhyllotaxisSystemicStudy1994}:\\r\\n\\\\begin{\
theorem}  \\r\\n\\t\\\\label{thm:fundamentalcorresponding}\\r\\n\\tSuppose \
that a lattice $\\\\mathcal{L}(d,h)$ is generated by  $d$ in $[0,\\\\jhalf]$ \
and that $1<m<n$. \\r\\n\\tIf the parastichy vectors $\\\\pvec{n}$ and \
$\\\\pvec{m}$ are generating and opposed,\\r\\n\\tand $u$ and $v$ are the \
winding-number pair for  $m$ and $n$ defined in section~\\\\ref{sec:wnp}, \
then $d$ is in the Farey interval \
$G=[u/m,v/n]$.\\r\\n\\\\end{theorem}\\r\\nThis says that if we see $m$ \
spirals one way and $n$ the other, the divergence of the lattice will be in \
the range $[u/m,v/n]$. The  winding-number pair, which already played a \
discreet role in Theorem~\\\\ref{thm:gLattice}, appears again in the \
Fundamental Theorem, without a very satisfying reason. The proof below \
doesn't add much explanation, but one will appear in the next \
Chapter.\\r\\n\\r\\n\\\\begin{proof}\\r\\n\\tTemporarily allow $u$ and $v$ to \
be any B\\\\'ezout pair for $m$ and $n$, and let  $M$ be the $d$-interval on \
which $[md]=u$ \\r\\n\\t\\tand  $N$ that where $[nd]=v$. The third part of \
Theorem~\\\\ref{thm:gLattice} says that the lattice $\\\\mathcal{L}({d,h})$ \
has  $\\\\pvec{m}$ and $\\\\pvec{n}$ as a generating pair on the interval \
$M\\\\cap N $. \\r\\n\\t\\t\\t\\t\\r\\n\\r\\n\\tFrom $[md]=u$ etc we can \
calculate the endpoints of $M=[L_m,R_m]$ and $N=[L_n,R_n]$ as $m \
L_m=u-\\\\jhalf$, $mR_m=u+\\\\jhalf$, $n L_n=v-\\\\jhalf$, $n \
R_n=v+\\\\jhalf$. \\tSetting $\\\\Delta=n u - mv$, noting that $\\\\Delta=-1$ \
if $u/m<v/n$ and $\\\\Delta=+1$ if $u/m>v/n$  we find \
\\r\\n\\t\\\\begin{align*}\\r\\n\\t\\t 2mn (u/m-L_m)& =n \\r\\n\\t\\t \
\\\\\\\\\\r\\n\\t\\t  2mn (v/n-L_m)& =n - 2\\\\Delta\\r\\n\\t\\t \
\\\\\\\\\\r\\n\\t\\t \\t 2mn (u/m-L_n)& =m+2\\\\Delta\\r\\n\\t\\t\\t\\t \
\\\\\\\\\\r\\n\\t\\t \\t 2mn (v/n-L_n)& \
=m\\r\\n\\t\\t\\\\end{align*}\\r\\n\\t\\tso that with either choice of \
$\\\\Delta=\\\\pm 1$, both $L_m$ and $L_n$ are less than or equal to the \
smaller of $u/m$ and $v/n$.\\r\\n\\t\\tA similar argument shows that both \
$R_m$ and $R_n$ are larger than the greater of  $u/m$ and \
$v/n$.\\r\\n\\t\\tso the Farey interval $G=[u/m,v/n]$ is contained within the \
 interval $M\\\\cap N $.\\r\\n\\t\\t\\r\\n\\tOn the interval  $M\\\\cap N $, \
the horizontal components of the parastichy vectors are  $x_m(d)=md-u$ and \
$x_n(d)=nd-v$.  These are increasing functions with unique zeros at $u/m$ and \
$v/n$ respectively; both horizontal components are negative at the beginning \
of  $M\\\\cap N$ and both are positive at the end and change sign exactly \
one, at  $u/m$ and $v/n$ respectively, so that the Farey interval $G$ is the \
only subinterval of $M\\\\cap N$ on which the two parastichy vectors are \
opposed, and so is a generating and opposed interval.\\r\\n\\t\\t\\t\\t\\r\\n\
\\tRecall from section~\\\\ref{sec:wnp} that the winding-number pair $u, v$ \
for $m, n$ has the property that their Farey interval \
$G=[u/m,v/n]\\\\subseteq[0,\\\\jhalf]$. If instead $u, v$ were a different \
B\\\\'ezout pair for $m,n$, then they are either of the form $u'=m-u$, \
$v'=n-v$, which would lead to a Farey interval of $G'=1-G$ and so outside \
$[0,\\\\jhalf]$, or $u'=u+km$, $v'=v+kn$ which would lead to a Farey interval \
$G'=[u/m+k,v/n+k]$ outside $[0,1]$. \\r\\n\\t\\r\\n\\tSo the generating and \
opposed interval in  $[0,\\\\jhalf]$ is exactly the Farey interval for the \
winding-number pair. \
\\r\\n\\t\\r\\n\\t\\t\\t\\r\\n\\\\end{proof}\\r\\n\\r\\nJean's statement of \
this theorem~\\\\autocite{jeanPhyllotaxisSystemicStudy1994} is incorrect in \
the case $m=1$. This is because of the complication which arises in the \
following exercise, but although of historical \
significance\\\\footnote{Trying to understand these complications is what led \
me to write this half of this book, and in particular to introduce the \
complementary vector.} there is little deeper importance to this edge case \
and it is excluded in my version of the Theorem \
above.\\r\\n\\r\\n\\\\begin{jExercise}\\\\label{ex:ftpfail}\\r\\n\\tCalculate \
generating and opposed intervals for the integer pairs $m=1,n=1$ and \
$m=1,n>1$.\\r\\n\\\\end{jExercise}\\r\\n\\\\begin{jAnswer}{ex:ftpfail}\\r\\n\\\
tIn Theorem~\\\\ref{thm:fundamentalcorresponding} the vectors are restricted \
to be parastichy vectors, but to find two generating and opposed vectors  \
with $m=1$ and $n=1$ we must allow complementary vectors and take \
$\\\\pvec{1}$ and $\\\\phatvec{1}$. \\r\\n\\tThese are always generating and \
opposed and so the generating interval is $[0,1]$. \\r\\n\\tEither \
B\\\\'ezout pair of $u=1, v=0$ or $u=0,v=1$ allows this to be written as \
$[u/m,v/n]$ in some order.\\r\\n\\t\\r\\n\\tSuppose that $m=1$ and $n>1$. If \
$dn<\\\\jhalf$, then $\\\\pvec{1}$ and $\\\\pvec{n}$ are co-linear, so \
instead pay attention to the pair $\\\\pvec{1}$ and $\\\\phatvec{n}$. For $d$ \
small and positive this pair is generating and opposed, and remains so until \
$dn=\\\\jhalf$ at which point the horizontal component of $\\\\pvec{n}$ \
increases through $\\\\jhalf$ and jumps back down to $-\\\\jhalf$ so that  \
$\\\\pvec{n}$ is no longer co-linear with $\\\\pvec{1}$. As $d$ continues to \
increase, the new pair $\\\\pvec{1}$ and $\\\\pvec{n}$ remain generating and \
opposed until\\r\\n\\t $\\\\pvec{n}$ becomes vertical, which happens when \
$nd=1$. After this the pair is no longer opposed.\\r\\n\\t \\t For $m=1$ amd \
$n>1$, the winding-number pair is $u=0$ and $v=1$, corresponding to a Farey \
interval of $[0,1/n]$. Thus this is the interval on which the lattice has an \
opposed generating pair, but below the midpoint $d<1/2n$, the pair is of a \
parastichy vector and a complementary vector. \\r\\n\\t \
\\r\\n\\r\\n\\\\end{jAnswer}\\r\\n% exercise\\r\\n\\r\\nLike \
Theorem~\\\\ref{thm:glattice}, this \
Theorem~\\\\ref{thm:fundamentalcorresponding} is independent of the rise, and \
does not claim that the generating and opposed pair is unique for $d$. \
Figure~\\\\ref{fig:Txb0410GeneratingIntervals} gives examples of generating \
opposed intervals. %\\r\\n\\r\\n\\r\\n%\\r\\nAs Jean's name for it suggests, \
this Theorem has historically been given some prominence. One reason is the \
following special case when the parastichy numbers are adjacent Fibonacci \
numbers:\\r\\n\\\\begin{theorem}\\r\\n\\tLattice divergences which lead to \
Fibonacci structure are very close to the golden \
angle:\\r\\n\\t\\\\begin{enumerate}\\r\\n\\\\item\\r\\n\\tIf $F_j$ and \
$F_{j+1}$ are successive Fibonacci numbers larger than 1 then the interval on \
which $\\\\gpbug{{\\\\textsf F}_j,{\\\\textsf F}_{j+1}}$ is both generating \
and opposed in $[0,\\\\jhalf]$  contains the point $1/\\\\tau^2$ and has a \
width \\r\\n\\t which shrinks as fast as $\\\\tau^{-2j}$.\\r\\n\\\\item \
\\r\\nIf $F^k_m$ and $F^k_{m+1}$ are successive members of the sequence \
$F^k_0=1$, $F^k_1=k$, $F^k_{i+1}=F^k_i+F^k_{i-1}$ for integer $k>2$, then \\r\
\\n\\tthe interval on which $\\\\gpbug{{\\\\textsf F}^k_m,{\\\\textsf \
F}^k_{m+1}}$ is generating and opposed in  $[0,\\\\jhalf]$ contains the point \
$\\\\tau/(1+k\\\\tau)$ and shrinks as fast as  \
$\\\\tau^{-2j}$.\\r\\n\\\\end{enumerate}\\r\\n\\\\end{theorem}\\r\\n\\\\begin{\
proof}\\r\\n\\tWe have from section~\\\\ref{sec:euclidean} that $F^{k}_j \
F_j-F^{k}_{j+1}F_{j-1}=(-1)^{j-1}$, so that we can set $m=F^{k}_j$, \
$n=F^{k}_{j+1}$, $u=F_{j-1}$, $v=F_{j}$ and have $mv-un=(-1)^{j-1}$ and \
$0<v<n$, and $0<u<m$. \\r\\n\\tSo the interval $G=[u/m,v/n]$ of the theorem \
is $[F_{j-1}/F^k_{j},F_j/F^k_{j+1}]$.\\r\\n\\tMoreover it has width \
$1/F^k_jF^{k}_{j+1}$ which is of order $\\\\tau^{-2j}$.\\r\\n\\tFor $k>2$ the \
interval is already in $[0,\\\\jhalf]$; for the Fibonacci numbers, with \
$k=1$, $u/m$ and $v/n$ are both larger than a half and the interval $G$ is \
close to $1/(1+\\\\tau)$ so its mirror \\r\\n\\t interval in $[0,\\\\jhalf]$ \
is  \\r\\n\\t$1-G$ containing $1/\\\\tau^2$. \
\\r\\n\\\\end{proof}\\r\\n\\\\begin{jExercise}\\\\label{ex:pdiv}\\r\\n\\\
tCompute the divergence interval in $[0,\\\\jhalf]$ on which  $\\\\gp{55,89}$ \
is a generating opposed \
pair.\\r\\n\\\\end{jExercise}\\r\\n\\\\begin{jAnswer}{ex:pdiv}\\r\\n\\tWe set \
$m=55=F_j$ and $89=n=F_j$ with $j=10$, and use $u=F_9=34$, $v=F_{10}=55$ to \
give $mv-nu=(-1)^{11}$ as expected.\\r\\n\\tThe interval in $[0,\\\\jhalf]$ \
is $1-(34/55,55/89)= 1/\\\\tau^2+ [-0.00014\\\\ldots, \
0.0005\\\\ldots]$.\\r\\n\\tThus the divergence angle of such a lattice must \
be within less than 2 parts in a thousand of the golden angle. \
\\r\\n\\\\end{jAnswer}\\r\\n\\r\\nSo we can apparently deduce from the fact \
of 55 and 89 parastichies in Figure~\\\\ref{fig:Txb0102Sunflower91} that the \
arrangement of successive florets in the sunflower head is at an angle very \
close to the golden angle $\\\\Phi$. However recall from \
Exercise~\\\\ref{ex:fibex} that this also follows from the fact that the \
Fibonacci parastichy pair is generating: observing that it is opposed merely \
tightens the interval around $\\\\Phi$. But more fundamentally we also need \
to assume, incorrectly, that the seeds are indeed arranged in a lattice in \
the first place: a more accurate description of the Theorem is that it says \
what the divergence must be \\\\textit{if} the arrangement was a lattice. \\r\
\\n\\r\\n\\\\section{Principal \
parastichies}\\r\\n\\r\\n\\\\label{sec:ppair}\\r\\nOne lattice can have many \
generating, or generating and opposed, parastichy\\\\index{parastichy}{} \
pairs.  We want to pick a principal pair that preserves the idea of being the \
`most obvious' to the eye. \\r\\nOne strong idea of obviousness comes from \
returning to the motivating example of the sunflower head. In practice each \
seed is typically in direct contact with four others and shaped into a \
corresponding diamond. It is these seeds which are directly adjacent which \
define, to the eye, the spirals. \\r\\nIn the language of our mathematical \
lattice it is the parastichies through the points nearest to the \
origin.\\r\\n\\\\begin{definition}\\r\\n\\tThe principal vector (or first \
principal vector, or principal parastichy) of the lattice is the parastichy \
vector of non-negative rise which is shortest. Ties will be common, and if we \
must we choose the vector with the largest $x$ component.\\r\\n\\tIf the \
first principal vector is $\\\\mvec$ then the first parastichy number is $m$. \
 The second principal vector  is the shortest lattice vector which is not \
co-linear with the principal vector. The $n$-th principal vector is the \
$n$-th  shortest lattice vector not co-linear with the first to ($n-1$)-th \
principal-vectors.%\\r\\n\\t\\r\\n\\\\end{definition}\\r\\nThe first \
principal vector has to be a parastichy vector, and the second principal \
vector will normally be a parastichy vector or sometimes a complementary \
vector.\\r\\n\\\\begin{definition}\\r\\n\\tAn  $\\\\pp{m,n}$ lattice is a \
lattice $\\\\mathcal{L}(h,d)$ in which the first and second principal vectors \
have parastichy numbers $m$ and $n$ respectively. \
\\r\\n\\\\end{definition}\\r\\nSimilarly a  $\\\\pp{m,n,t}$ lattice is a \
lattice  in which the first  second  and third parastichy numbers are $m$, \
$n$ and $t$. If the first and second principal  vectors are equal in length \
we alternatively describe the lattice as an $\\\\pp{m=n,t}$ \
lattice.\\r\\nPrincipal pairs are always generating pairs and a proof of this \
will become apparent after we have seen how to construct principal pairs. \\r\
\\n\\r\\nWhether a parastichy vector is a principal one is an $h$-dependent \
property, unlike the properties of being opposed or generating which are \
$h$-independent. At any fixed $d$, for $h$ large enough, the principal vector \
is always $\\\\pvec{0}$; if $d=1/\\\\tau^2$, for example, we will see  how \
the principal parastichy number increases through the Fibonacci numbers as \
$h$ decreases. We will see below that lattices with ties in length between \
principal parastichy vectors, though non-generic, are particularly important \
in organising the classification, and that hexagonal lattices where the first \
three parastichy vectors are equal in length play a crucial role. \
\\r\\nFigure~\\\\ref{fig:Txb0411LatticesSpecialD} shows principal parastichy \
pairs for the special case of  $d=0$ and distichous patterns $d=\\\\jhalf$.  \
\\r\\n\\\\mmafig{Txb0411LatticesSpecialD}{Lattices, and principal \
parastichies, in the special cases $d=0$  and distichous patterns \
$d=\\\\jhalf$, and varying $h$. A circle equal in diameter to the shortest \
principal parastichy vector is drawn around each point.\\r\\nRed lines \
correspond to the principal parastichy, and blue lines to the parastichy \
which has the next strictly shorter parastichy \
vector.}{1}\\r\\n%\\r\\n\\\\section{Spiral \
lattices}\\r\\n\\\\label{sec:spiral}\\r\\n\\r\\nBefore we go on to the main \
result we can look at a special case which is algebraically simple, although \
not applicable to large Fibonacci number phyllotaxis. This is the \
\\\\emph{spiral lattice} which by definition is a lattice \
$\\\\mathcal{L}(d<\\\\jfrac{1}{4},h)$ as in the examples in \
Figure~\\\\ref{fig:Txb0412Spiral}. These are lattices in which\\r\\nthe \
genetic spiral or 1-parastichy visually dominates, and in which the idea of a \
principal pair is not the most observationally important. \
\\r\\n%\\r\\nNevertheless spiral lattices are the first initial cases that \
will begin\\r\\nour Fibonacci framework, and calculating principal pairs \
directly for such lattices can help explain the marginal structure of the \
diagrams in the following \
Chapter.\\r\\n\\\\begin{jExercise}\\\\label{ex:pspiral}\\r\\n\\tFix  \
$d<\\\\jfrac{1}{4}$ and set  $k=\\\\lfloor1/2d\\\\rfloor-1$.\\r\\n\\tShow \
that as $h$ decreases, the principal parastichy pair of the lattice \
$\\\\mathcal{L}(d,h)$ begins as \\r\\n\\t $\\\\pp{0,1}$ and then passes \
through $\\\\pp{1,0}$,  $\\\\pphat{1}{1}$,\\r\\n\\t  \
$\\\\pphat{1}{2}$,\\\\ldots ,  $\\\\pphat{1}{k}$, until reaching \
$\\\\pp{1,k+1}$ and that  both principal vectors are parastichy vectors for \
all $h$ values smaller than this. \\r\\n\\t \\r\\n\\\\end{jExercise} \\r\\n\\\
\\begin{jAnswer}{ex:pspiral}\\r\\nFor $h$ large enough, \\tthe shortest \
vector in the lattice is  $\\\\pvec{0}=(1,0)$ \\r\\nof length 1, and the \
second shortest is  $\\\\pvec{1}=(h,d)$ of length $h^2+d^2$.\\r\\nThese \
change relative magnitude when $h^2+d^2=1$ giving us a $(1,0)$ \
lattice.\\r\\nAs $h$ decreases further, there is a point when  \
$\\\\phatvec{1}=(h,d-1)$ is of equal length to $\\\\pvec{0}$: this is when \
$h^2+d^2=2d$. These give the boundaries between the $(0,1)$, $(1,0)$ and $(1,\
\\\\hat 1)$ regions in Figure~\\\\ref{fig:Txb0501VanItersonMain}. \
\\r\\n\\r\\nAs $h$ continues to decrease, but as long as $\\\\pvec{1}$ \
remains the shortest vector in the lattice, the second shortest\\r\\nmust be \
on the adjacent 1-parastichy to the origin. Given the definition of \
$k=\\\\lfloor1/2d\\\\rfloor-1\\\\geq 1$, $1/2(k+1)<d\\\\leq 1/2k$,  and then \
$\\\\pvec{2},\\\\ldots,\\\\pvec{k}$ are co-linear with $\\\\pvec{1}$ on the \
origin parastichy, so they are not the second shortest principal vector. On \
the adjacent 1-parastichy, though, we can set $\\\\rpvec{n}=  (nd-1,n h)$, \
and we have $\\\\phatvec{n}=\\\\rpvec{n}=\\\\pvec{n}-\\\\pvec{0}$ for \
$-k\\\\leq n\\\\leq k$ and $\\\\pvec{n}=\\\\rpvec{n}$ for $k+1\\\\leq \
n\\\\leq 2k+1$. Then the second principal vector is one of these \
$\\\\rpvec{}$s and specifically it is the one closest to $\\\\mathbf{n}$: the \
vector which normal to the origin 1-parastichy from the origin to the \
adjacent 1-parastichy: see Figure~\\\\ref{fig:Txb0412Spiral}.\\r\\n %\\r\\n\\\
\\mmafig{Txb0412Spiral}{First (red) and second (blue) parastichies in a \
lattice with $d=7/72$ and (left to right) $h$ equal to 0.4, 0.115, 0.08. The \
corresponding principal parastichy pairs are $(1,\\\\hat 1)$, $(1,\\\\hat \
3)$,\\r\\nand $(1,6)$.  The normal to the 1-parastichy is shown as a thin \
line. For large enough $h$, as in the first two cases, one of the principal \
vectors is a complementary vector. }{1.0}\\r\\n%\\r\\n\\r\\nWe have \
$\\\\pvec{1}=(d,h)$; so $\\\\mathbf{n}$  has slope $-d/h$. Since   \
$\\\\mathbf{n}$ and $\\\\pvec{1}$\\r\\nmust form a rectangle of area $h$, we \
can find the length of  $\\\\mathbf{n}$ and discover  $\\\\mathbf{n} = \\\\nu \
(-h^2 /d,h)$\\r\\nwhere \\r\\n$\\r\\n\\t\\\\nu = \
\\r\\n\\t%\\\\frac\\r\\n\\t{d}/{(h^2+d^2)}\\r\\n$\\r\\nSince the rise of \
$\\\\mathbf{n}$ is $h\\\\nu$, it passes through one of the $r_n$ every time $\
\\\\nu$ passes through an integer,\\r\\nand the closest  $\\\\mathbf{r}_n$ \
has $n=[\\\\nu]$, so that the second principal vector changes from \
$\\\\rpvec{n}$ to \\r\\n$\\\\rpvec{n+1}$  when $\\\\nu=n+\\\\jhalf$ which can \
be rewritten as \
\\r\\n\\\\begin{equation}\\r\\n{h^2+\\\\left(d-\\\\frac{1}{2n+1}\\\\right)^2}=\
  \\\\frac{1}{(2n+1)^2}\\r\\n\\\\end{equation}\\r\\nNote that for the initial \
case $n=0$ we recover $h^2+d^2=2d$ as the $0=\\\\hat{1}$ boundary where a \
$(1,0)$ lattice became a $(1,\\\\hat 1)$ lattice. For each of \
$n=1,\\\\ldots,k$ this gives the point at which a  $(1,\\\\hat n)$ becomes a  \
$(1,\\\\widehat {n+1})$ lattice, and then for $n=k+1$ the lattice transitions \
from a  $(1,\\\\hat {k})$ to a $(1, {k+1})$ lattice.  From this point on the \
principal pair are both parastichy vectors, though at some yet smaller $h$.  \
$\\\\pvec{1}$ will cease to be the principal vector and we are back in the \
full complexity of Figure~\\\\ref{fig:Txb0501VanItersonMain}.\\r\\n\\r\\nThe \
region of lattice space in which lattices are of the form $(1,\\\\hat{n})$ \
are shown in \
Figure~\\\\ref{fig:Txb0413SpiralExample}.\\r\\n\\\\mmafig{\
Txb0413SpiralExample}{Structure of lattices space near $(d,h)=(0,0)$ where \
lattices are spiral lattices. Shaded in light and dark yellow are regions \
where the principal parastichy pair are $(1,\\\\hat{n})$ for $n=1$ to $n=7$.  \
At each the light-dark boundary the lattice is square, as will be shown in \
the next chapter. The principal pair transitions from $(1,\\\\hat{n})$ to  \
$(1,{n})$ at the vertical line $d=\\\\jfrac{1}{2n}$. \
}{.5}\\r\\n\\r\\n\\\\end{jAnswer}\\r\\n \\r\\n\\r\\n\\\\section{Turing-Euclid \
reduction of generating pairs}\\r\\n\\\\label{sec:TEreduction}\\r\\nThe \
examples of the previous section explicitly computed the principal vector \
pairs for the special case of spiral lattices, and now we turn to calculating \
them in \\r\\ngeneral. \\r\\nThe principal vectors can often be found by eye \
--- indeed that is the point of them --- and certainly always by an \
exhaustive search of what is only a finite number of possibilities, since \
they must be at least as short as $\\\\pvec{0}$ and $\\\\pvec{1}$, which \
bounds the possible rise.\\r\\nBut they can also be found by a reduction \
process from any vectors which generate the lattice. One reason to do this is \
in the proof of Turing's Theorem below. Moreover this reduction process is a \
version of the Euclidean algorithm, which begins to explain the connection \
between the continued fraction of the divergence and the principal pairs of \
the lattice that we will see in subsequent chapters. \
\\r\\n\\\\todo{xxx}\\r\\nWe gave a standard version of the Euclidean \
algorithm back in section~\\\\eqref{sec:euclidean} as a series of successive \
reductions of pairs of integers, and it can be generalised to vectors as long \
as we choose a norm for those vectors. Another way of viewing the first half \
of this chapter and Theorem~\\\\ref{thm:glattice} in particular is that \
\\r\\nif we define the size of a lattice vector as its rise, then application \
of the Euclidean algorithm to successively reduce the size of pairs of \
generating  vectors $\\\\mvec$ and $\\\\nvec$  terminates with a pair that \
have the very smallest rises, ie $\\\\pvec{0}$ and $\\\\pvec{1}$. If instead \
we define the size of a lattice vector as its length, then the same Euclidean \
algorithm terminates not at the vectors with shortest rise, but the vectors \
with shortest length: the principal vectors. One step of the algorithm is \
illustrated in Figure~\\\\ref{fig:Txb0414Reduction}.\\r\\n \
\\\\mmafig{Txb0414Reduction}{A pair of generating vectors reduced by a step \
of the Euclidean algorithm. \
$\\\\pvec{4}=\\\\pvec{14}-2\\\\pvec{5}$\\r\\n\\tis the shortest of all \
vectors of the form  $\\\\pvec{14}-q\\\\pvec{5}$ and by construction it must \
be \\r\\n\\tshorter than $\\\\pvec{5}$; the pair $\\\\gp{5,14}$ has been \
reduced to the pair $\\\\gp{4,5}$.}{1.0}\\r\\n\\r\\n\\r\\nSpecifically, \
Turing-Euclid reduction starts with \\r\\n$i=0$ and two vectors \
$\\\\mathbf{a}$ and $\\\\mathbf{b}$ that generate the lattice, and ordered so \
that\\r\\n$|a|>|b|$. Set $\\\\rpvec{-1}=\\\\mathbf{a}$ and \
$\\\\rpvec{0}=\\\\mathbf{b}$ and \
then\\r\\n\\\\begin{enumerate}\\r\\n\\t\\\\item Choose $q_i$ to be the \
integer that minimises  $|\\\\rpvec{i-1}-q_i\\\\rpvec{i}|$. If there is a \
tie, choose the $q$ closest to zero. \\r\\n\\t\\\\item If $q_i=0$, then set \
$N=i$ and terminate.\\t\\r\\n\\t\\\\item Otherwise set  \
$\\\\rpvec{i+1}=\\\\rpvec{i-1}-q_i\\\\rpvec{i}$. Increment $i$ and return to \
step 1.\\r\\n\\\\end{enumerate}\\r\\nAs before $|\\\\rpvec{i}|$ is strictly \
decreasing over a finite set of vectors shorter than $\\\\mathbf{a}$ so the \
algorithm terminates with an $\\\\fvec$ and $\\\\svec$ satisfying \
\\r\\n\\\\begin{align}\\r\\n\\t\\\\label{eq:EuclidFS}\\r\\n\\t|\\\\fvec|&\\\\\
leq|\\\\svec| \\\\leq |\\\\svec-q\\\\fvec| \\\\mbox{ for any integer $q$}.\\r\
\\n\\\\end{align}\\r\\n\\r\\n\\\\begin{jExercise}\\\\label{ex:pte}\\r\\n\\tIn \
the lattice $h=1/100$, $d=17/72$, find an example where Turing-Euclidean \
reduction  requires more than two steps to terminate.\\r\\n\\\\end{jExercise}\
\\r\\n\\\\begin{jAnswer}{ex:pte}\\r\\n\\tThe pair $\\\\gp{73,103}$ is \
successively reduced to $\\\\gp{30,73}$, $\\\\gp{13,30}$, and terminates at $\
\\\\gp{4,13}$ which  is the principal pair for the lattice. \
\\r\\n\\\\end{jAnswer}\\r\\n\\r\\nTuring-Euclid reduction certainly \
terminates with a pair of vectors no longer than the pair that it started \
with. To show that it actually terminates at the shortest pair of vectors in \
the lattice we will use\\r\\n\\\\begin{theorem}\\r\\n\\tIf $\\\\fvec$ and $\\\
\\svec$ are a pair of vectors with positive rise that generate the lattice \
and satisfy~\\\\eqref{eq:EuclidFS} then they are the first and second \
principal vectors and the third principal vector has the form $\\\\pm\\\\fvec\
\\\\pm\\\\svec$. \\r\\n\\t\\\\label{thm:third}\\r\\n\\\\end{theorem}\\r\\n\\r\
\\n\\\\begin{proof}\\r\\n\\tFirst note that~\\\\eqref{eq:EuclidFS} with $q=1$ \
shows $|\\\\svec|^2<|\\\\svec-\\\\fvec|^2= |\\\\svec|^2- 2 \
|\\\\fvec.\\\\svec|+|\\\\fvec|^2$ and so $|\\\\fvec.\\\\svec|<\\\\jhalf \
|\\\\fvec|^2$. \\r\\n\\t\\r\\n\\tSet $\\\\Delta$ to be the sign of $\\\\fvec.\
\\\\svec$, and let $\\\\tvec=\\\\svec-\\\\Delta \\\\fvec$.\\t\\r\\nWe will \
show that no other lattice vectors,  not co-linear with $\\\\fvec$ or \
$\\\\svec$, are shorter than $\\\\tvec$. Since $\\\\fvec$ and $\\\\svec$ are \
generating, we can write any other vector as \
\\r\\n$\\\\mathbf{x}(q,r)=q\\\\svec- r\\\\Delta \\\\fvec$ for nonzero integer \
$q,r$, where we have used $\\\\Delta=\\\\pm 1$. We can show that \
$\\\\mathbf{x}(q,-r)$ is longer than $\\\\mathbf{x}(q,r)$ by \
using\\r\\n\\\\begin{align}\\r\\n\\t|\\\\mathbf{x}(q,-r)|^2-|\\\\mathbf{x}(q,\
r)|^2=4 qr | \
\\\\fvec.\\\\svec|,\\r\\n\\t\\\\label{eq:pdir}\\r\\n\\\\end{align}\\r\\nso we \
need only check $r>0$. \\r\\nSetting $q=1$ in equation~\\\\ref{eq:pdir} we \
have in particular \
that\\r\\n$|\\\\tvec|=|\\\\svec-\\\\Delta\\\\fvec|<|\\\\svec+\\\\Delta\\\\\
fvec|$.\\r\\nWe calculate \
\\r\\n\\\\begin{align*}\\r\\n\\t|\\\\mathbf{x}(q,r)|^2-|\\\\tvec|^2 & = \
(q^2-1)|\\\\svec|^2 -2 \\\\Delta (qr-1) (\\\\fvec.\\\\svec)+ \
(r^2-1)|\\\\fvec|^2 \\r\\n\\t\\\\shortintertext{and using \
$|\\\\fvec|<|\\\\svec|$ and $2\\\\Delta \
\\\\fvec.\\\\svec=2|\\\\fvec.\\\\svec|<|\\\\fvec|^2$}\\r\\n\\t|\\\\mathbf{x}(\
q,r)|^2-|\\\\tvec|^2& \\\\geq  \\\\left(q^2-1 - (qr-1)+ \
r^2-1\\\\right)|\\\\fvec|^2 \\r\\n\\t\\\\\\\\ \\r\\n\\t&=   (q^2-qr+r^2-1) \
|\\\\fvec|^2 = ((q-r)^2+qr-1) |\\\\fvec|^2 \\r\\n\\\\end{align*}\\r\\nand the \
final bracket is nonnegative since $q,r \\\\geq 1$. \\r\\nThis shows that $\\\
\\fvec$ and $\\\\svec$ in order are the first two principal vectors and that \
the third is $\\\\svec-\\\\fvec$ if $\\\\fvec.\\\\svec>0$ and\\r\\n$\\\\svec-\
\\\\fvec$ otherwise. \\r\\n\\\\end{proof}\\r\\nThe algebra of the proof could \
be simplified by first rotating and scaling the lattice so that $\\\\fvec$ is \
horizontal and of length 1: this is  the renormalisation transform we will \
encounter in the next Chapter. \\r\\n\\r\\nBecause the first and second \
parastichy vectors $\\\\fvec$ and $\\\\svec$ are of the forms $\\\\mvec$ and \
$\\\\nvec$, with parastichy numbers $m$ and $n$, a simpler restatement of \
this result is Turing's theorem \
:\\r\\n\\\\begin{theorem}\\r\\n\\t\\\\label{thm:Turing}\\r\\n\\tThe third \
parastichy number is the sum or difference of the first \
two.%\\r\\n\\t\\\\end{theorem}\\r\\nSee \
Figure~\\\\ref{fig:Txb0415SumDifference}.\\tThis form of the Theorem neglects \
the hats, so requires us to interpret $1+\\\\hat{1}$ as $2$ or $\\\\hat{2}$ \
as necessary. We will see in the next Chapter how Turing sought to use this \
theorem as part of his explanation of Fibonacci \
structure.\\r\\n\\\\mmafig{Txb0415SumDifference}{Turing's theorem: the third \
parastichy vector in a lattice is always the sum or difference of the first \
two.}{1.0}\\r\\n\\r\\n\\r\\n\\r\\n\\r\\n\\\\section{Orthostichies}\\r\\nWith \
the notation in place we can observe a consequence of having golden angle \
lattices. An \\\\textit{orthostichy} is a parastichy\\\\index{parastichy}{} \
vector of nonnegative rise which is closer to the vertical than any other \
parastichy vector of lower nonnegative rise.%\\r\\n\\\\jNote{Historically, \
orthostichy has also been used to mean a strictly vertical parastichy.} Thus \
there are is a sequence of orthostichies,  starting with $\\\\pvec{0}$ and \
$\\\\pvec{1}$, of increasing rise. If the divergence of the lattice is a \
rational $d=p/q$ in its lowest terms then the final orthostichy is \
$\\\\pvec{q}$; if $d$ is irrational then the sequence of orthostichies is \
infinite, and tends to the vertical. The parastichy number of each \
orthostichy corresponds to the denominator of an increasingly accurate series \
of rational approximations to the divergence. Provided the rise is small \
enough (and excluding spiral lattices), the principal parastichy pair of the \
lattice will be two successive orthostichies,\\r\\nand as the rise continues \
to decrease the principal parastichy counts will move up the sequence of \
these denominators. Thus the principal parastichy numbers could be made to be \
successive and arbitrarily large Fibonacci numbers down to an arbitrary small \
$h$ by setting the divergence sufficiently close to the golden angle, as in \
Figure~\\\\ref{fig:Txb0416FibLattices}.\\r\\n\\r\\n\\\\mmafig{\
Txb0416FibLattices}{Increasing Fibonacci pairs in a golden angle lattice as \
the rise is reduced}\\r\\n{1.0}\\r\\n\\r\\nThe Standard Picture models have \
the divergence as an outcome, not an input. So under the Standard Picture, \
this observation explains why, if we see some Fibonacci structure, we see a \
lot, not why we see it in the first place. \
\\r\\n\\r\\n\\r\\n\\r\\n\\\\section{Touching-circle and hexagonal \
lattices}\\r\\n\\\\label{sec:hexdef}\\r\\nEquipped with the ability to find \
the shortest vectors in a lattice we can now classify lattice types, as in \
Figure~\\\\ref{fig:Txb0417LatticeTypes}.\\r\\n\\\\mmafig{Txb0417LatticeTypes}{\
Different types of lattice. \\\\gp{2,5}: a lattice with principal vector \
$\\\\pvec{2}$ and second principal $\\\\pvec{5}$;  \\\\gp{2=5,3}: a \
touching-circle lattice with a tie for the two shortest vectors, which in \
this case are non-opposed; \\\\gp{2=5,7} a touching-circle lattice which is \
opposed; and \\\\gp{2=5=7}, a hexagonal \
lattice.}{1.0}\\r\\n\\r\\n\\\\begin{definition}\\r\\n\\tA hexagonal lattice \
is a lattice where the first three parastichy vectors are all the same \
length. \\r\\n\\\\end{definition}\\r\\n\\\\begin{jExercise}\\\\label{ex:\
hexhex}\\r\\n\\tShow that every hexagonal lattice is \
hexagonal.\\r\\n\\\\end{jExercise}\\r\\n\\\\begin{jAnswer}{ex:hexhex}\\r\\n\\\
tIf the angle between any two parastichy vectors was not 60$^\\\\circ$, then \
the third of the vectors, which must be their sum or difference, would not be \
the third side of an equilateral triangle and would not also have the same \
length.\\r\\n\\\\end{jAnswer}\\r\\nLess fundamental, but sometimes of use to \
identify, are square lattices:\\r\\n\\\\begin{definition}\\r\\n\\tAn square \
lattice has the first and second parastichy vectors the same length and at \
right angles. \\r\\n\\\\end{definition}\\r\\nSquare and hexagonal lattices \
are special cases of van Iterson \
lattices:\\r\\n\\\\begin{definition}\\r\\n\\tA van Iterson, or touching \
circle, lattice, is one in which the first and second parastichy vectors have \
the same length.\\r\\n\\\\end{definition}\\r\\n\\r\\nThe van Iterson \
connection will appear in the next chapter; the reason for the name `touching \
circle' is that disks of diameter equal to the first principal parastichy \
vector can be placed at each point of a van Iterson lattice without \
overlapping, and will touch at a point halfway along that vector. \
\\r\\n\\r\\n\\r\\nFigure~\\\\ref{fig:Txb0418LowOrder} shows a number of \
touching circle lattices, especially showing examples of square and hexagonal \
lattices. \\r\\n\\\\mmafig{Txb0418LowOrder}{Some touching circle lattices, \
labelled by the principal vectors. Red lines correspond to the shortest \
vectors in the lattice, including ties, and blue lines to one of the \
second-shortest vectors after ties. \\r\\n\\tRedrawn from van \
Iterson~\\\\autocite{vanitersonjrMathematischeUndMikroscopischAnatomische1907}\
. }{1}\\r\\n%\\r\\nIn a square lattice the first two parastichy vectors \
$\\\\pvec{m}$ and $\\\\pvec{n}$ have the same length, and the third and \
fourth parastichies also share the length $\\\\sqrt{2}|\\\\pvec{m}|$; this is \
the boundary case when the third parastichy number changes between the sum \
and the difference of the first two. In a hexagonal lattice, the  first,  \
second and third principal  vectors all have the same length, and can be \
written as $\\\\pvec{m}$, $\\\\pvec{n}$, and $\\\\pvec{m+n}$ with $m<n$; this \
is the boundary case between changes of first and second principal parastichy \
numbers. \\r\\nBy considering these boundary cases, we will be able to  infer \
how principal parastichy numbers change as we cross the boundaries.  \
\\r\\n\\r\\n\\r\\n\\r\\n\\\\section{Relation to \\\\textit{Phyllotaxis: a \
systemic study}.}\\r\\nThe relationship between continued fractions and \
divergence angles was worked out in some detail by Bravais as early as \
1837~\\\\cite{bravaisEssaiDispositionFeuilles1837}. Bravais also developed \
versions of Theorem~\\\\ref{thm:glattice}, and especially the integer \
condition $| m v - n u|=1$ \\\\cite{bravaisSystemsFormedPoints1949}.\\r\\n\\r\
\\n \\r\\nUseful contributions to the analysis of cylindrical lattices then \
came from many writers, most relevantly a series of papers in the 1970s by \
Adler. Details of these and many further references can be conveniently found \
in Jean's 1994 book \\\\textit{Phyllotaxis: a systemic study in plant \
morphogenesis}~\\\\cite{jeanPhyllotaxisSystemicStudy1994}.\\r\\nThis section \
notes a few of the differences between Jean's book and the current one and \
can be skipped by most readers.\\r\\nJean's book included an invaluable \
mathematical synthesis, predominantly but not exclusively of Adler's work, \
but perhaps as a consequence contains a handful of mathematical \
inconsistencies. It is a tribute to the centrality of Jean's textbook to the \
field that it is still worth untangling them; and while in general the \
problems are ones that do not apply to large-Fibonacci-number lattices, the \
viewpoint of the next chapter requires a robust foundation for simpler \
lattices too. \\r\\n\\r\\nAlthough I have preserved Jean's name for what is \
here Theorem~\\\\ref{thm:fundamentalcorresponding} as the `fundamental \
theorem of phyllotaxis', it is instead Turing's theorem, \
Theorem~\\\\ref{thm:Turing}, which is more fundamental from the bifurcation \
theory viewpoint of this book. This is because Turing's theorem allows \
patterns to be interpreted as the outcome of a dynamic, and modellable, \
biological process, while the `fundamental' theorem assumes the very \
existence of the emergent lattice which we are attempting to explain. \
\\r\\n\\r\\nOne notational difference from Jean is in the idea of the \
generating pair which Jean makes much of use of under the name of the \
`visible pair'. Jean gives a number of useful theorems about generating \
pairs: his A4.1 on p306, for example,  is in close correspondence with our \
Theorem~\\\\ref{thm:glattice}. These theorems are correct and consistent for \
most phyllotactic lattices but in my interpretation they fail in some \
edge-cases  alluded to in Exercise~\\\\ref{ex:ftpfail}. Specifically, they \
fail with the spiral lattices we introduced in \
Section~\\\\ref{sec:spiral}.\\r\\n %\\r\\nAs a counter-example to Jean's A4.2 \
(p307 of~\\\\cite{jeanPhyllotaxisSystemicStudy1994}), consider its statement \
for the particular case  $m=1$ and $n=2$. It becomes `the parastichy pair \
(1,2) is visible and opposed iff there exist unique integers $u$ and $v$ such \
that $0\\\\leq u<1$, $0\\\\leq v<2$, $|v-2u=1|$ and such that the divergence \
$d<\\\\jhalf$ lies at or is between $u$ and $v/2$'. Solving the constraints \
unambiguously gives $u=0$ and $v=1$, and gives a generating interval of \
$[0,1/2]$.  However the pair $\\\\pvec{1}$ and $\\\\pvec{2}$ are only \
generating on the interval $d\\\\in [1/4,1/2]$. \\r\\n For any $d<1/4$ it is \
not true, at least in the language of this book, to say as  \\r\\n Jean's \
A4.2 does that the parastichy pair  \\\\gp{1,2} is a generating pair (and \
also incorrectly, that the pair is opposed for all $0<d<\\\\jhalf$).  What \
has happened is that Adler's proof method actually leads to the pair \
\\\\gphat{1}{2}, ie the 1-parastichy vector and the 2-complementary vector, \
which \\\\textit{is} generating and opposed: see \
Figure~\\\\ref{fig:Txb0419JeanX}.\\r\\n \\\\mmafig{Txb0419JeanX}{A \
counter-example to Jean's Proposition \
A4.2~\\\\autocite{jeanPhyllotaxisSystemicStudy1994}, with $m=1$, $n=2$, \
$d=7/72$ and $h=0.1$; this counter-example holds for all $h$ and \
$0<d<\\\\jfrac{1}{4}$. A4.2 asserts that the 1-parastichy and the \
2-parastichy form what Jean calls a visible pair and we call a generating \
pair. For spiral lattices, in the sense of Section~\\\\ref{sec:spiral}, \
Jean's A4.2 fails because the 2-parastichy is not visible: it is the pair \
\\\\gphat{1}{2} which is the generating pair. }{1}\\r\\n\\r\\n\\r\\n\\r\\n\\r\
\\nAnother area where this text differs from Jean's synthesis is the \
\\\\emph{conspicuous pair} as a model of the most obvious spirals. \
Adler~\\\\cite{adlerModelContactPressure1974} defined a conspicuous visible \
opposed parastichy pair as identical to our principal parastichy pair (at \
least when opposed, and away from spiral lattices), and in \
1988~\\\\cite[p214]{jeanNumbertheoreticPropertiesTwodimensional1988} Jean \
followed this, but by 1994 he was differently defining the conspicuous pair \
as that closest to a right \
angle~\\\\cite[p18]{jeanPhyllotaxisSystemicStudy1994}.\\r\\n\\r\\nIn any case \
I prefer here to use the principal parastichy pair as the most natural model \
of `obvious'. \\r\\nThe concept of the principal parastichy pair, central to \
this book, was first made explicit by \
Turing~\\\\autocite{turingMorphogenTheoryPhyllotaxis2013} in unpublished \
material in the early 1950s: Theorems~\\\\ref{thm:third} \
and~\\\\ref{thm:Turing} are based on his ideas. Turing's algorithm was \
eventually published in the 1990s as described \
in~\\\\cite{turingMorphogenTheoryPhyllotaxis2013}.  With the aid of \
hindsight, the theorem I have called here Turing's Theorem is implicit in \
Bravais' nineteenth century work. \\r\\nThe independent Adler/Jean synthesis  \
makes use of `contractions' (eg A4.3 \
of~\\\\cite{jeanPhyllotaxisSystemicStudy1994}) which correspond to steps in \
the Turing-Euclid reduction, and implicitly uses reaching the principal  \
vectors as a stopping point.\\r\\n\\r\\nAdler was well aware of Turing's \
notes on phyllotaxis and cited them in his 1974 literature \
survey~\\\\cite{adlerModelContactPressure1974}. Adler's perspective was that \
the central mathematical problem was the relationship between the divergence \
and the set of possible generating pairs. It was from this perspective that \
he wrote that Turing had been `prevented' from using this `fundamental' \
concept because of Turing's focus on the principal parastichy pair, which is \
in fact more fundamental to the modern Standard Picture. For some reason, \
perhaps the very long delay in publishing Turing's notes, even this dismissal \
was removed from Jean's book, even though the notes had by then been \
published. As a consequence Jean's book contains no explicit equivalent of \
Turing's Theorem. \\r\\n\\r\\n \\r\\n \\\\section{Multijugate lattices}\\r\\n\
\\\\mmafig{Txb0420MultiJugate}{Left: A monojugate lattice with divergence \
$d=2/10$,  rise $h=1/10$, and $J=1$, which has principal parastichy numbers \
\\\\gp{1,4}. Right a bijugate lattice with $J=2$, divergence $d/J$, rise \
$h/J$,  whose principal parastichy numbers are \\\\gp{2,8}.}\\r\\n{1.0}\\r\\n \
The \\\\textit{jugacy} of a cylindrical lattice is the number of points in \
the lattice at each rise. The assumption at the beginning of this chapter \
that of nozero rise per node ensured that we  have so far only seen  \
monojugate lattices: those with a jugacy $J=1$. More generally, a multijugate \
lattice $\\\\mathcal{L}(d,h,J)$ can be defined as the set of points \\r\\n $ \
(kd+ l/J - [kd+ l/J],kh)$ with $ k\\\\in\\\\jZ$ and $l\\\\in  0,\\\\ldots,J$,\
\\r\\n and can be constructed by placing $J$ copies of the primary cylinder \
next to each other and then reducing the divergence by a factor of $J$ so the \
multijugate lattice is still on a cylinder of circumference 1: see \
Figure~\\\\ref{fig:Txb0420MultiJugate}. If we then also reduce the rise by a \
factor of $J$ we will produce a lattice in which the parastichy vectors have \
the same proportions  as in the original. Instead of numbering the points \
$0$, $1$, \\\\ldots, at each succesive rise, we can number them around the \
cylinder first and then increase with the rise. \\r\\n With this natural \
numbering of points in the multijugate lattice, the points numbered $0$ and \
$k$ in the monojugate lattice become the points $0$ and $kJ$, so the \
principal parastichy numbers of a the lattice $\\\\mathcal{L}(d/J,h/J,J)$ are \
$J$ times the principal parastichy numbers of $\\\\mathcal{L}(d,h,1)$. \\r\\n \
%\\r\\n \\r\\n% %\\r\\n% \\r\\n% If needed, the apparatus of hats and \
complementary vectors goes over to multijugate lattices, so that for instance \
the bijugate version of a \\\\gphat{1}{1} lattice is a \\\\gphat{2}{2} \
lattice as in Figure~\\\\ref{fig:Txb0421JugacyHat}. \\r\\n% \
\\\\mmafig{Txb0421JugacyHat}{The multijugate version of lattices with \
complementary vectors as principal vectors have the same property, although \
perhaps easier to visualise. Left: A monojugate lattice with divergence \
$d=0.245$,  rise $h=0.45$, and $J=1$, with  principal parastichy numbers are \
\\\\gphatnothat{1}{1}{0}. Right the corresponding bijugate lattice with  \
$J=2$, divergence $d/J$, rise $h/J$,  whose principal parastichy numbers are \
\\\\gphatnothat{2}{2}{0}}{1.0}\\r\\n \\\\section{Dropping the hats}\\r\\n \
Complementary vectors and the hat notation have done their job now in \
allowing precision in  the Theorems of this Chapter when applied to spiral \
lattices and we can drop them from now on, with the understanding that any \
future description of a \\\\gp{m,m} parastichy pair is referring to what this \
chapter called a \\\\gphat{m}{m} pair. In particular we can  without \
ambiguity now talk of the lattice with divergence $d=1/2$ as having a \
\\\\gp{1,1}  parastichy pair corresponding to the two lines from the origin \
to ${1/2,h}$ winding in opposite directions around the cylinder. \\r\\n\\r\\n\
\\\\section{Summary of parastichies}\\r\\nWe have classified parastichy pairs \
in lattices. Most simply we classified them  by whether they are opposed, \
that is wind in opposite directions. That simple classification is less \
useful than knowing whether they are generating, that is capable of \
describing the whole lattice, and we saw that a simple visual check for this \
was whether the triangle they defined contained any other lattice points. \
Each lattice has many generating pairs but typically only one of them is the \
shortest pair. \\r\\n\\r\\nWe called this shortest pair the principal \
parastichy pair and argued that this a good model for the spiral counts \
typically done when examining specimens. This principal parastichy pair \
depends on the rise: lattices with the same $d$ and different $h$ will have \
exactly the same generating pairs but which of those is the principal pair \
will vary with $h$. Crucially, we observed Turing's Theorem: geometrical \
constraints mean that the third principal parastichy number is always the sum \
or difference of the first two. \\r\\n\\r\\n\"\>"], "Output",
 CellLabel->"Out[85]=",ExpressionUUID->"a4a613a1-2b95-1249-900a-181bcd476718"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.930918886382618*^9, 3.930918928664263*^9}, {
  3.9309189659652576`*^9, 3.930919074262501*^9}},
 CellLabel->"In[18]:=",ExpressionUUID->"be1faea8-5f80-1243-96d7-3139847f3b23"]
},
WindowSize->{538.5, 646.875},
WindowMargins->{{Automatic, -4.125}, {Automatic, 0}},
FrontEndVersion->"14.2 for Microsoft Windows (64-bit) (December 26, 2024)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"473bde1f-56b0-314b-b222-16036ef714cc"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 1395, 35, 234, "Input",ExpressionUUID->"a7dfdb43-ede7-0442-8bc0-f49d2e6f0815",
 InitializationCell->True],
Cell[1956, 57, 812, 11, 28, "Input",ExpressionUUID->"5410ce48-bafc-4c4a-8d21-6a889068bb50"],
Cell[2771, 70, 2646, 58, 272, "Input",ExpressionUUID->"ea6b1b0e-09ce-9440-b08f-6c66a5cd9a09",
 InitializationCell->True],
Cell[5420, 130, 2532, 51, 424, "Input",ExpressionUUID->"15d23f4c-0e35-d44a-8b0e-305e897a350d",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[7977, 185, 958, 16, 47, "Input",ExpressionUUID->"b75608cc-9ea6-a144-86b7-9998912bf55c"],
Cell[8938, 203, 1215, 24, 197, "Print",ExpressionUUID->"ef973a9c-1f3b-4a4b-9daf-aff1087992ab"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10190, 232, 109, 1, 28, "Input",ExpressionUUID->"137aa27c-e0dd-3340-87e0-c09fdd2ce500"],
Cell[10302, 235, 186, 2, 32, "Output",ExpressionUUID->"c19fa74a-3cbb-414f-903f-f54809d769f4"]
}, Open  ]],
Cell[10503, 240, 1172, 25, 294, "Input",ExpressionUUID->"9c117197-2bc4-3048-a8be-0f66a2cf3cb0"],
Cell[11678, 267, 2464, 62, 367, "Input",ExpressionUUID->"acac33ec-85cd-6044-b5d5-ee6ce418cc9b",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[14167, 333, 202, 4, 44, "Input",ExpressionUUID->"42c6e748-0de8-0446-9fbc-c984096b48ea",
 InitializationCell->True],
Cell[14372, 339, 151, 2, 32, "Output",ExpressionUUID->"7b7c46bd-ed7b-b942-a4c0-a48640c5af75"]
}, Open  ]],
Cell[14538, 344, 1220, 30, 177, "Input",ExpressionUUID->"68f8f740-baa8-2c46-8d4b-2433493e1e21",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[15783, 378, 146, 3, 28, "Input",ExpressionUUID->"d9e32fa4-4847-d346-aed7-b9345534aafe"],
Cell[15932, 383, 479, 13, 57, "Print",ExpressionUUID->"94c3d89f-11c9-7c44-8d72-84dec75261d0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[16448, 401, 161, 3, 28, "Input",ExpressionUUID->"14ec110f-cc59-454c-87ba-72ceb998df67"],
Cell[16612, 406, 134, 3, 32, "Output",ExpressionUUID->"95fcba41-7459-0045-8f19-acc2da22c86d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[16783, 414, 154, 3, 28, "Input",ExpressionUUID->"c36aa74d-d80b-4e4b-9b15-0c01ec13e031"],
Cell[16940, 419, 121, 2, 51, "Output",ExpressionUUID->"75daf077-863b-6b46-945d-6c5a3a2986d2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[17098, 426, 408, 10, 66, "Input",ExpressionUUID->"4014a559-765a-624c-b5ef-c33d8f50b955"],
Cell[17509, 438, 4292, 58, 526, "Output",ExpressionUUID->"52da23db-de25-ed4b-a1e0-aa3bd4242203"]
}, Open  ]],
Cell[CellGroupData[{
Cell[21838, 501, 161, 3, 28, "Input",ExpressionUUID->"21d06605-d2d0-8346-a198-01f18e508201"],
Cell[22002, 506, 134, 3, 32, "Output",ExpressionUUID->"d4df949f-55b2-8040-8744-40631a2bce76"]
}, Open  ]],
Cell[CellGroupData[{
Cell[22173, 514, 217, 4, 28, "Input",ExpressionUUID->"2d9f3ce1-0e86-0441-bd2a-127c57e48d65"],
Cell[22393, 520, 88514, 1225, 24291, "Output",ExpressionUUID->"2bed8bf2-6bb3-c041-908b-4b6ea9bfb3a4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[110944, 1750, 111, 1, 28, "Input",ExpressionUUID->"d83b09fe-fc58-ac4a-83aa-df4ee7acb363"],
Cell[111058, 1753, 89339, 1236, 39399, "Output",ExpressionUUID->"a4a613a1-2b95-1249-900a-181bcd476718"]
}, Open  ]],
Cell[200412, 2992, 222, 3, 28, "Input",ExpressionUUID->"be1faea8-5f80-1243-96d7-3139847f3b23"]
}
]
*)

